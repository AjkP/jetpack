
if ( jpconcat.files['modules/after-the-deadline/atd-autoproofread.js'] ) {

var AtD_proofread_click_count=0;function AtD_submit_check(e){if(AtD_proofread_click_count>0){return;}
e.stopImmediatePropagation();e.preventDefault();if(typeof(tinyMCE)!=='undefined'&&tinyMCE.activeEditor&&!tinyMCE.activeEditor.isHidden()){tinyMCE.activeEditor.execCommand('mceWritingImprovementTool',AtD_submit_check_callback);}else{AtD_restore_if_proofreading();AtD_check(AtD_submit_check_callback);}}
function AtD_submit_check_callback(count){count=Number(count||0);AtD_unbind_proofreader_listeners();if(0===count||1<AtD_proofread_click_count){AtD_update_post();}else if(-1===count){alert(AtD.getLang('message_server_error','There was a problem communicating with the Proofreading service. Try again in one minute.'));AtD_update_post();}else{var original_post_status=jQuery('#original_post_status').val();var message;if(original_post_status==='publish'){message=AtD.getLang('dialog_confirm_post_publish','The proofreader has suggestions for this post. Are you sure you want to publish it?\n\nPress OK to publish your post, or Cancel to view the suggestions and edit your post.');}else{message=AtD.getLang('dialog_confirm_post_update','The proofreader has suggestions for this post. Are you sure you want to update it?\n\nPress OK to update your post, or Cancel to view the suggestions and edit your post.');}
if(confirm(message)){AtD_update_post();}else{AtD_bind_proofreader_listeners();AtD_kill_autoproofread();}
jQuery('#publish').removeClass('button-primary-disabled');jQuery('#ajax-loading').hide();}}
function AtD_kill_autoproofread(){jQuery('#publish').unbind('click.AtD_submit_check');}
function AtD_update_post(){if(typeof(tinyMCE)==='undefined'||!tinyMCE.activeEditor||tinyMCE.activeEditor.isHidden()){AtD_restore_if_proofreading();}
jQuery('#publish').unbind('click.AtD_submit_check').click();}
jQuery(document).ready(function($){var orig_status=$('#original_post_status').val();if(typeof AtD_check_when!=='undefined'&&$('#content').length&&((orig_status!=='publish'&&AtD_check_when.onpublish)||((orig_status==='publish'||orig_status==='schedule')&&AtD_check_when.onupdate))){$('#publish').bind('click.AtD_submit_check',AtD_submit_check);}});

} /* end modules/after-the-deadline/atd-autoproofread.js */

if ( jpconcat.files['modules/after-the-deadline/atd-nonvis-editor-plugin.js'] ) {

var AtD_qtbutton,autosave;function AtD_restore_text_area()
{AtD.remove('content');var content=jQuery('#content').html();if(navigator.appName==='Microsoft Internet Explorer'){content=content.replace(/<BR.*?class.*?atd_remove_me.*?>/gi,'\n');}
jQuery('#content').replaceWith(AtD.content_canvas);jQuery('#content').val(content.replace(/\&lt\;/g,'<').replace(/\&gt\;/g,'>').replace(/\&amp;/g,'&'));jQuery('#content').height(AtD.height);if(AtD_qtbutton){jQuery(AtD_qtbutton).val(AtD.getLang('button_proofread','proofread'));jQuery(AtD_qtbutton).css({'color':'#464646'});jQuery(AtD_qtbutton).siblings('input').andSelf().attr('disabled',false);}
if(AtD.autosave!==undefined){if(window.wp&&window.wp.autosave&&window.wp.autosave.server){if(window.wp.autosave.local){window.wp.autosave.local.resume();}
window.wp.autosave.server.resume();}else{autosave=AtD.autosave;}}}
if(typeof(QTags)!=='undefined'&&QTags.addButton){jQuery(document).ready(function(){QTags.addButton('AtD',AtD_l10n_r0ar.button_proofread,AtD_check);});}else{edButtons[edButtons.length]=new edButton('ed_AtD','AtD','','','');jQuery(document).ready(function($){$('#ed_AtD').replaceWith('<input type="button" id="ed_AtD" accesskey="" class="ed_button" onclick="AtD_check(this);" value="'+AtD_l10n_r0ar.button_proofread+'" />');});}
function AtD_restore_if_proofreading(){if(AtD_qtbutton&&jQuery(AtD_qtbutton).val()===AtD.getLang('button_edit_text','edit text')){AtD_restore_text_area();}}
function AtD_unbind_proofreader_listeners(){jQuery('#save-post, #post-preview, #publish, #edButtonPreview').unbind('focus',AtD_restore_if_proofreading);jQuery('#add_poll, #add_image, #add_video, #add_audio, #add_media').unbind('click',AtD_restore_if_proofreading);jQuery('#post').unbind('submit',AtD_restore_if_proofreading);}
function AtD_bind_proofreader_listeners(){jQuery('#save-post, #post-preview, #publish, #edButtonPreview').focus(AtD_restore_if_proofreading);jQuery('#add_poll, #add_image, #add_video, #add_audio, #add_media').click(AtD_restore_if_proofreading);jQuery('#post').submit(AtD_restore_if_proofreading);}
function AtD_check(button){var callback;if(jQuery.isFunction(button)){callback=button;if(!AtD_qtbutton){AtD_qtbutton=jQuery('#qt_content_AtD, #ed_AtD').get(0);}}else{if(!button.id){button=button[0];}
AtD_qtbutton=button;}
if(!jQuery('#content').size()){if('undefined'!==typeof callback){callback(0);}
AtD_restore_if_proofreading();return;}
if(jQuery(AtD_qtbutton).val()===AtD.getLang('button_edit_text','edit text')){AtD_restore_text_area();}else{if(!AtD.height){AtD.height=jQuery('#content').height();AtD_bind_proofreader_listeners();jQuery('#edButtonPreview').attr('onclick',null).click(function(){AtD_restore_if_proofreading();switchEditors.go('content','tinymce');});AtD.content_canvas=jQuery('#content');AtD.autosave=autosave;}
jQuery(AtD_qtbutton).css({'color':'red'}).val(AtD.getLang('button_edit_text','edit text')).attr('disabled',true);var text=jQuery('#content').val().replace(/\&/g,'&amp;').replace(/</g,'&lt;').replace(/\>/g,'&gt;');if(navigator.appName==='Microsoft Internet Explorer'){text=text.replace(/[\n\r\f]/gm,'<BR class="atd_remove_me">');var node=jQuery('<div class="input" id="content" style="height: 170px">'+text+'</div>');jQuery('#content').replaceWith(node);node.css({'overflow':'auto','background-color':'white','color':'black'});}else{jQuery('#content').replaceWith('<div class="input" id="content">'+text+'</div>');jQuery('#content').css({'overflow':'auto','background-color':'white','color':'black','white-space':'pre-wrap'});jQuery('#content').height(AtD.height);}
if(window.wp&&window.wp.autosave&&window.wp.autosave.server){if(window.wp.autosave.local){window.wp.autosave.local.suspend();}
window.wp.autosave.server.suspend();}else{autosave=function(){};}
jQuery(AtD_qtbutton).siblings('input').andSelf().attr('disabled',true);AtD.check('content',{success:function(errorCount){if(Number(errorCount)===0&&typeof callback!=='function'){alert(AtD.getLang('message_no_errors_found','No writing errors were found'));}
AtD_restore_if_proofreading();},ready:function(errorCount){jQuery(AtD_qtbutton).attr('disabled',false);if(typeof callback==='function'){callback(errorCount);}},error:function(){jQuery(AtD_qtbutton).attr('disabled',false);if(typeof callback==='function'){callback(-1);}else{alert(AtD.getLang('message_server_error','There was a problem communicating with the Proofreading service. Try again in one minute.'));}
AtD_restore_if_proofreading();},editSelection:function(element){var text=prompt(AtD.getLang('dialog_replace_selection','Replace selection with:'),element.text());if(text!=null){element.replaceWith(text);}},explain:function(url){var left=(screen.width / 2)-(480 / 2);var top=(screen.height / 2)-(380 / 2);window.open(url,'','width=480,height=380,toolbar=0,status=0,resizable=0,location=0,menuBar=0,left='+left+',top='+top).focus();},ignore:function(word){jQuery.ajax({type:'GET',url:AtD.rpc_ignore+encodeURI(word).replace(/&/g,'%26'),format:'raw',error:function(XHR,status,error){if(AtD.callback_f!==undefined&&AtD.callback_f.error!==undefined){AtD.callback_f.error(status+': '+error);}}});}});}}

} /* end modules/after-the-deadline/atd-nonvis-editor-plugin.js */

if ( jpconcat.files['modules/after-the-deadline/atd.core.js'] ) {

var EXPORTED_SYMBOLS=['AtDCore'];function AtDCore(){this.ignore_types=['Bias Language','Cliches','Complex Expression','Diacritical Marks','Double Negatives','Hidden Verbs','Jargon Language','Passive voice','Phrases to Avoid','Redundant Expression'];this.ignore_strings={};this.i18n={};}
AtDCore.prototype.getLang=function(key,defaultk){return(window.AtD_l10n_r0ar&&window.AtD_l10n_r0ar[key])||defaultk;};AtDCore.prototype.addI18n=function(obj){window.AtD_l10n_r0ar=obj;};AtDCore.prototype.setIgnoreStrings=function(string){var parent=this;this.map(string.split(/,\s*/g),function(string){parent.ignore_strings[string]=1;});};AtDCore.prototype.showTypes=function(string){var show_types=string.split(/,\s*/g);var types={};types['Double Negatives']=1;types['Hidden Verbs']=1;types['Passive voice']=1;types['Bias Language']=1;types['Cliches']=1;types['Complex Expression']=1;types['Diacritical Marks']=1;types['Jargon Language']=1;types['Phrases to Avoid']=1;types['Redundant Expression']=1;var ignore_types=[];this.map(show_types,function(string){types[string]=undefined;});this.map(this.ignore_types,function(string){if(types[string]!==undefined){ignore_types.push(string);}});this.ignore_types=ignore_types;};AtDCore.prototype.makeError=function(error_s,tokens,type,seps){var struct={};struct.type=type;struct.string=error_s;struct.tokens=tokens;if(new RegExp('\\b'+error_s+'\\b').test(error_s)){struct.regexp=new RegExp('(?!'+error_s+'<)\\b'+error_s.replace(/\s+/g,seps)+'\\b');}
else if(new RegExp(error_s+'\\b').test(error_s)){struct.regexp=new RegExp('(?!'+error_s+'<)'+error_s.replace(/\s+/g,seps)+'\\b');}
else if(new RegExp('\\b'+error_s).test(error_s)){struct.regexp=new RegExp('(?!'+error_s+'<)\\b'+error_s.replace(/\s+/g,seps));}
else{struct.regexp=new RegExp('(?!'+error_s+'<)'+error_s.replace(/\s+/g,seps));}
struct.used=false;return struct;};AtDCore.prototype.addToErrorStructure=function(errors,list,type,seps){var parent=this;this.map(list,function(error){var tokens=error['word'].split(/\s+/);var pre=error['pre'];var first=tokens[0];if(errors['__'+first]===undefined){errors['__'+first]={};errors['__'+first].pretoks={};errors['__'+first].defaults=[];}
if(pre===''){errors['__'+first].defaults.push(parent.makeError(error['word'],tokens,type,seps,pre));}else{if(errors['__'+first].pretoks['__'+pre]===undefined){errors['__'+first].pretoks['__'+pre]=[];}
errors['__'+first].pretoks['__'+pre].push(parent.makeError(error['word'],tokens,type,seps,pre));}});};AtDCore.prototype.buildErrorStructure=function(spellingList,enrichmentList,grammarList){var seps=this._getSeparators();var errors={};this.addToErrorStructure(errors,spellingList,'hiddenSpellError',seps);this.addToErrorStructure(errors,grammarList,'hiddenGrammarError',seps);this.addToErrorStructure(errors,enrichmentList,'hiddenSuggestion',seps);return errors;};AtDCore.prototype._getSeparators=function(){var re='',i;var str='"s!#$%&()*+,./:;<=>?@[\\]^_{|}';for(i=0;i<str.length;i++){re+='\\'+str.charAt(i);}
return'(?:(?:[\xa0'+re+'])|(?:\\-\\-))+';};AtDCore.prototype.processXML=function(responseXML){var types={};this.map(this.ignore_types,function(type){types[type]=1;});this.suggestions=[];var errors=responseXML.getElementsByTagName('error');var grammarErrors=[];var spellingErrors=[];var enrichment=[];for(var i=0;i<errors.length;i++){if(errors[i].getElementsByTagName('string').item(0).firstChild!==null){var errorString=errors[i].getElementsByTagName('string').item(0).firstChild.data;var errorType=errors[i].getElementsByTagName('type').item(0).firstChild.data;var errorDescription=errors[i].getElementsByTagName('description').item(0).firstChild.data;var errorContext;if(errors[i].getElementsByTagName('precontext').item(0).firstChild!==null){errorContext=errors[i].getElementsByTagName('precontext').item(0).firstChild.data;}else{errorContext='';}
if(this.ignore_strings[errorString]===undefined){var suggestion={};suggestion['description']=errorDescription;suggestion['suggestions']=[];suggestion['matcher']=new RegExp('^'+errorString.replace(/\s+/,this._getSeparators())+'$');suggestion['context']=errorContext;suggestion['string']=errorString;suggestion['type']=errorType;this.suggestions.push(suggestion);if(errors[i].getElementsByTagName('suggestions').item(0)!==null){var suggestions=errors[i].getElementsByTagName('suggestions').item(0).getElementsByTagName('option');for(var j=0;j<suggestions.length;j++){suggestion['suggestions'].push(suggestions[j].firstChild.data);}}
if(errors[i].getElementsByTagName('url').item(0)!==null){var errorUrl=errors[i].getElementsByTagName('url').item(0).firstChild.data;suggestion['moreinfo']=errorUrl+'&theme=tinymce';}
if(types[errorDescription]===undefined){if(errorType==='suggestion'){enrichment.push({word:errorString,pre:errorContext});}
if(errorType==='grammar'){grammarErrors.push({word:errorString,pre:errorContext});}}
if(errorType==='spelling'||errorDescription==='Homophone'){spellingErrors.push({word:errorString,pre:errorContext});}
if(errorDescription==='Cliches'){suggestion['description']='Clichés';}
if(errorDescription==='Spelling'){suggestion['description']=this.getLang('menu_title_spelling','Spelling');}
if(errorDescription==='Repeated Word'){suggestion['description']=this.getLang('menu_title_repeated_word','Repeated Word');}
if(errorDescription==='Did you mean...'){suggestion['description']=this.getLang('menu_title_confused_word','Did you mean...');}}}}
var errorStruct;var ecount=spellingErrors.length+grammarErrors.length+enrichment.length;if(ecount>0){errorStruct=this.buildErrorStructure(spellingErrors,enrichment,grammarErrors);}else{errorStruct=undefined;}
return{errors:errorStruct,count:ecount,suggestions:this.suggestions};};AtDCore.prototype.findSuggestion=function(element){var text=element.innerHTML;var context=(this.getAttrib(element,'pre')+'').replace(/[\\,!\\?\\."\s]/g,'');if(this.getAttrib(element,'pre')===undefined){alert(element.innerHTML);}
var errorDescription;var len=this.suggestions.length;for(var i=0;i<len;i++){if((context===''||context===this.suggestions[i]['context'])&&this.suggestions[i]['matcher'].test(text)){errorDescription=this.suggestions[i];break;}}
return errorDescription;};function TokenIterator(tokens){this.tokens=tokens;this.index=0;this.count=0;this.last=0;}
TokenIterator.prototype.next=function(){var current=this.tokens[this.index];this.count=this.last;this.last+=current.length+1;this.index++;if(current!==''){if(current[0]==='\''){current=current.substring(1,current.length);}
if(current[current.length-1]==='\''){current=current.substring(0,current.length-1);}}
return current;};TokenIterator.prototype.hasNext=function(){return this.index<this.tokens.length;};TokenIterator.prototype.hasNextN=function(n){return(this.index+n)<this.tokens.length;};TokenIterator.prototype.skip=function(m,n){this.index+=m;this.last+=n;if(this.index<this.tokens.length){this.count=this.last-this.tokens[this.index].length;}};TokenIterator.prototype.getCount=function(){return this.count;};TokenIterator.prototype.peek=function(n){var peepers=[];var end=this.index+n;for(var x=this.index;x<end;x++){peepers.push(this.tokens[x]);}
return peepers;};AtDCore.prototype.markMyWords=function(container_nodes,errors){var seps=new RegExp(this._getSeparators()),nl=[],ecount=0,parent=this,bogus=this._isTinyMCE?' data-mce-bogus="1"':'',emptySpan='<span class="mceItemHidden"'+bogus+'>&nbsp;</span>';this._walk(container_nodes,function(n){if(n.nodeType===3&&!parent.isMarkedNode(n)){nl.push(n);}});var iterator;this.map(nl,function(n){var v;if(n.nodeType===3){v=n.nodeValue;var tokens=n.nodeValue.split(seps);var previous='';var doReplaces=[];iterator=new TokenIterator(tokens);while(iterator.hasNext()){var token=iterator.next();var current=errors['__'+token];var defaults;if(current!==undefined&&current.pretoks!==undefined){defaults=current.defaults;current=current.pretoks['__'+previous];var done=false;var prev,curr;prev=v.substr(0,iterator.getCount());curr=v.substr(prev.length,v.length);var checkErrors=function(error){if(error!==undefined&&!error.used&&foundStrings['__'+error.string]===undefined&&error.regexp.test(curr)){foundStrings['__'+error.string]=1;doReplaces.push([error.regexp,'<span class="'+error.type+'" pre="'+previous+'"'+bogus+'>$&</span>']);error.used=true;done=true;}};var foundStrings={};if(current!==undefined){previous=previous+' ';parent.map(current,checkErrors);}
if(!done){previous='';parent.map(defaults,checkErrors);}}
previous=token;}
if(doReplaces.length>0){var newNode=n;for(var x=0;x<doReplaces.length;x++){var regexp=doReplaces[x][0],result=doReplaces[x][1];var bringTheHurt=function(node){if(node.nodeType===3){ecount++;if(parent.isIE()&&node.nodeValue.length>0&&node.nodeValue.substr(0,1)===' '){return parent.create(emptySpan+node.nodeValue.substr(1,node.nodeValue.length-1).replace(regexp,result),false);}else{return parent.create(node.nodeValue.replace(regexp,result),false);}}
else{var contents=parent.contents(node);for(var y=0;y<contents.length;y++){if(contents[y].nodeType===3&&regexp.test(contents[y].nodeValue)){var nnode;if(parent.isIE()&&contents[y].nodeValue.length>0&&contents[y].nodeValue.substr(0,1)===' '){nnode=parent.create(emptySpan+contents[y].nodeValue.substr(1,contents[y].nodeValue.length-1).replace(regexp,result),true);}else{nnode=parent.create(contents[y].nodeValue.replace(regexp,result),true);}
parent.replaceWith(contents[y],nnode);parent.removeParent(nnode);ecount++;return node;}}
return node;}};newNode=bringTheHurt(newNode);}
parent.replaceWith(n,newNode);}}});return ecount;};AtDCore.prototype._walk=function(elements,f){var i;for(i=0;i<elements.length;i++){f.call(f,elements[i]);this._walk(this.contents(elements[i]),f);}};AtDCore.prototype.removeWords=function(node,w){var count=0;var parent=this;this.map(this.findSpans(node).reverse(),function(n){if(n&&(parent.isMarkedNode(n)||parent.hasClass(n,'mceItemHidden')||parent.isEmptySpan(n))){if(n.innerHTML==='&nbsp;'){var nnode=document.createTextNode(' ');parent.replaceWith(n,nnode);}else if(!w||n.innerHTML===w){parent.removeParent(n);count++;}}});return count;};AtDCore.prototype.isEmptySpan=function(node){return(this.getAttrib(node,'class')===''&&this.getAttrib(node,'style')===''&&this.getAttrib(node,'id')===''&&!this.hasClass(node,'Apple-style-span')&&this.getAttrib(node,'mce_name')==='');};AtDCore.prototype.isMarkedNode=function(node){return(this.hasClass(node,'hiddenGrammarError')||this.hasClass(node,'hiddenSpellError')||this.hasClass(node,'hiddenSuggestion'));};AtDCore.prototype.applySuggestion=function(element,suggestion){if(suggestion==='(omit)'){this.remove(element);}
else{var node=this.create(suggestion);this.replaceWith(element,node);this.removeParent(node);}};AtDCore.prototype.hasErrorMessage=function(xmlr){return(xmlr!==undefined&&xmlr.getElementsByTagName('message').item(0)!==null);};AtDCore.prototype.getErrorMessage=function(xmlr){return xmlr.getElementsByTagName('message').item(0);};AtDCore.prototype.isIE=function(){return navigator.appName==='Microsoft Internet Explorer';};function atd_sprintf(format,values){var result=format;for(var x=0;x<values.length;x++){result=result.replace(new RegExp('%'+(x+1)+'\\$','g'),values[x]);}
return result;}

} /* end modules/after-the-deadline/atd.core.js */

if ( jpconcat.files['modules/after-the-deadline/jquery.atd.js'] ) {

var AtD={rpc:'',rpc_css:'http://www.polishmywriting.com/atd-jquery/server/proxycss.php?data=',rpc_css_lang:'en',api_key:'',i18n:{},listener:{}};AtD.getLang=function(key,defaultk){return(window.AtD_l10n_r0ar&&window.AtD_l10n_r0ar[key])||defaultk;};AtD.addI18n=function(obj){window.AtD_l10n_r0ar=obj;};AtD.setIgnoreStrings=function(string){AtD.core.setIgnoreStrings(string);};AtD.showTypes=function(string){AtD.core.showTypes(string);};AtD.checkCrossAJAX=function(container_id,callback_f){if(typeof AtD_proofread_click_count!=='undefined'){AtD_proofread_click_count++;}
AtD.callback_f=callback_f;AtD.remove(container_id);var container=jQuery('#'+container_id);var text=jQuery.trim(container.html());text=text.replace(/\&lt;/g,'<').replace(/\&gt;/g,'>').replace(/\&amp;/g,'&');text=encodeURIComponent(text.replace(/\%/g,'%25'));if((text.length>2000&&navigator.appName==='Microsoft Internet Explorer')||text.length>7800){if(callback_f!==undefined&&callback_f.error!==undefined){callback_f.error('Maximum text length for this browser exceeded');}
return;}
CSSHttpRequest.get(AtD.rpc_css+text+'&lang='+AtD.rpc_css_lang+'&nocache='+(new Date().getTime()),function(response){var xml;if(navigator.appName==='Microsoft Internet Explorer'){xml=new ActiveXObject('Microsoft.XMLDOM');xml.async=false;xml.loadXML(response);}else{xml=(new DOMParser()).parseFromString(response,'text/xml');}
if(AtD.core.hasErrorMessage(xml)){if(AtD.callback_f!==undefined&&AtD.callback_f.error!==undefined){AtD.callback_f.error(AtD.core.getErrorMessage(xml));}
return;}
AtD.container=container_id;var count=Number(AtD.processXML(container_id,xml));if(AtD.callback_f!==undefined&&AtD.callback_f.ready!==undefined){AtD.callback_f.ready(count);}
if(count===0&&AtD.callback_f!==undefined&&AtD.callback_f.success!==undefined){AtD.callback_f.success(count);}
AtD.counter=count;AtD.count=count;});};AtD.check=function(container_id,callback_f){if(typeof AtD_proofread_click_count!=='undefined'){AtD_proofread_click_count++;}
AtD.callback_f=callback_f;AtD.remove(container_id);var container=jQuery('#'+container_id);var text=jQuery.trim(container.html());text=text.replace(/\&lt;/g,'<').replace(/\&gt;/g,'>').replace(/\&amp;/g,'&');text=encodeURIComponent(text);jQuery.ajax({type:'POST',url:AtD.rpc+'/checkDocument',data:'key='+AtD.api_key+'&data='+text,format:'raw',dataType:(jQuery.browser.msie)?'text':'xml',error:function(XHR,status,error){if(AtD.callback_f!==undefined&&AtD.callback_f.error!==undefined){AtD.callback_f.error(status+': '+error);}},success:function(data){var xml;if(typeof data==='string'){xml=new ActiveXObject('Microsoft.XMLDOM');xml.async=false;xml.loadXML(data);}
else{xml=data;}
if(AtD.core.hasErrorMessage(xml)){if(AtD.callback_f!==undefined&&AtD.callback_f.error!==undefined){AtD.callback_f.error(AtD.core.getErrorMessage(xml));}
return;}
AtD.container=container_id;var count=Number(AtD.processXML(container_id,xml));if(AtD.callback_f!==undefined&&AtD.callback_f.ready!==undefined){AtD.callback_f.ready(count);}
if(count===0&&AtD.callback_f!==undefined&&AtD.callback_f.success!==undefined){AtD.callback_f.success(count);}
AtD.counter=count;AtD.count=count;}});};AtD.remove=function(container_id){AtD._removeWords(container_id,null);};AtD.clickListener=function(event){if(AtD.core.isMarkedNode(event.target)){AtD.suggest(event.target);}};AtD.processXML=function(container_id,responseXML){var results=AtD.core.processXML(responseXML);if(results.count>0){results.count=AtD.core.markMyWords(jQuery('#'+container_id).contents(),results.errors);}
jQuery('#'+container_id).unbind('click',AtD.clickListener);jQuery('#'+container_id).click(AtD.clickListener);return results.count;};AtD.useSuggestion=function(word){this.core.applySuggestion(AtD.errorElement,word);AtD.counter--;if(AtD.counter===0&&AtD.callback_f!==undefined&&AtD.callback_f.success!==undefined){AtD.callback_f.success(AtD.count);}};AtD.editSelection=function(){var parent=AtD.errorElement.parent();if(AtD.callback_f!==undefined&&AtD.callback_f.editSelection!==undefined){AtD.callback_f.editSelection(AtD.errorElement);}
if(AtD.errorElement.parent()!==parent){AtD.counter--;if(AtD.counter===0&&AtD.callback_f!==undefined&&AtD.callback_f.success!==undefined){AtD.callback_f.success(AtD.count);}}};AtD.ignoreSuggestion=function(){AtD.core.removeParent(AtD.errorElement);AtD.counter--;if(AtD.counter===0&&AtD.callback_f!==undefined&&AtD.callback_f.success!==undefined){AtD.callback_f.success(AtD.count);}};AtD.ignoreAll=function(container_id){var target=AtD.errorElement.text();var removed=AtD._removeWords(container_id,target);AtD.counter-=removed;if(AtD.counter===0&&AtD.callback_f!==undefined&&AtD.callback_f.success!==undefined){AtD.callback_f.success(AtD.count);}
if(AtD.callback_f!==undefined&&AtD.callback_f.ignore!==undefined){AtD.callback_f.ignore(target);AtD.core.setIgnoreStrings(target);}};AtD.explainError=function(){if(AtD.callback_f!==undefined&&AtD.callback_f.explain!==undefined){AtD.callback_f.explain(AtD.explainURL);}};AtD.suggest=function(element){var suggest;if(jQuery('#suggestmenu').length===0){suggest=jQuery('<div id="suggestmenu"></div>');suggest.prependTo('body');}else{suggest=jQuery('#suggestmenu');suggest.hide();}
var errorDescription=AtD.core.findSuggestion(element);AtD.errorElement=jQuery(element);suggest.empty();if(errorDescription===undefined){suggest.append('<strong>'+AtD.getLang('menu_title_no_suggestions','No suggestions')+'</strong>');}else if(errorDescription['suggestions'].length===0){suggest.append('<strong>'+errorDescription['description']+'</strong>');}else{suggest.append('<strong>'+errorDescription['description']+'</strong>');for(var i=0;i<errorDescription['suggestions'].length;i++){(function(sugg){suggest.append('<a href="javascript:AtD.useSuggestion(\''+sugg.replace(/'/,'\\\'')+'\')">'+sugg+'</a>');})(errorDescription['suggestions'][i]);}}
if(AtD.callback_f!==undefined&&AtD.callback_f.explain!==undefined&&errorDescription['moreinfo']!==undefined){suggest.append('<a href="javascript:AtD.explainError()" class="spell_sep_top">'+AtD.getLang('menu_option_explain','Explain...')+'</a>');AtD.explainURL=errorDescription['moreinfo'];}
suggest.append('<a href="javascript:AtD.ignoreSuggestion()" class="spell_sep_top">'+AtD.getLang('menu_option_ignore_once','Ignore suggestion')+'</a>');if(AtD.callback_f!==undefined&&AtD.callback_f.editSelection!==undefined){if(AtD.callback_f!==undefined&&AtD.callback_f.ignore!==undefined){suggest.append('<a href="javascript:AtD.ignoreAll(\''+AtD.container+'\')">'+AtD.getLang('menu_option_ignore_always','Ignore always')+'</a>');}else{suggest.append('<a href="javascript:AtD.ignoreAll(\''+AtD.container+'\')">'+AtD.getLang('menu_option_ignore_all','Ignore all')+'</a>');}
suggest.append('<a href="javascript:AtD.editSelection(\''+AtD.container+'\')" class="spell_sep_bottom spell_sep_top">'+AtD.getLang('menu_option_edit_selection','Edit Selection...')+'</a>');}
else{if(AtD.callback_f!==undefined&&AtD.callback_f.ignore!==undefined){suggest.append('<a href="javascript:AtD.ignoreAll(\''+AtD.container+'\')" class="spell_sep_bottom">'+AtD.getLang('menu_option_ignore_always','Ignore always')+'</a>');}else{suggest.append('<a href="javascript:AtD.ignoreAll(\''+AtD.container+'\')" class="spell_sep_bottom">'+AtD.getLang('menu_option_ignore_all','Ignore all')+'</a>');}}
var pos=jQuery(element).offset();var width=jQuery(element).width();if(width>100){width=50;}
jQuery(suggest).css({left:(pos.left+width)+'px',top:pos.top+'px'});jQuery(suggest).fadeIn(200);AtD.suggestShow=true;setTimeout(function(){jQuery('body').bind('click',function(){if(!AtD.suggestShow){jQuery('#suggestmenu').fadeOut(200);}});},1);setTimeout(function(){AtD.suggestShow=false;},2);};AtD._removeWords=function(container_id,w){return this.core.removeWords(jQuery('#'+container_id),w);};AtD.initCoreModule=function(){var core=new AtDCore();core.hasClass=function(node,className){return jQuery(node).hasClass(className);};core.map=jQuery.map;core.contents=function(node){return jQuery(node).contents();};core.replaceWith=function(old_node,new_node){return jQuery(old_node).replaceWith(new_node);};core.findSpans=function(parent){return jQuery.makeArray(parent.find('span'));};core.create=function(string){string=string.replace(/\&/g,'&amp;');string=string.replace(/</g,'&lt;').replace(/\>/g,'&gt;');var matches=string.match(/\&lt;span class="hidden\w+?" pre="[^"]*"\&gt;.*?\&lt;\/span\&gt;/g);var x;if(matches){for(x=0;x<matches.length;x++){string=string.replace(matches[x],matches[x].replace(/\&lt;/gi,'<').replace(/\&gt;/gi,'>'));}}
if(core.isIE()){matches=string.match(/\&lt;span class="mceItemHidden"\&gt;\&amp;nbsp;\&lt;\/span&gt;/g,string);if(matches){for(x=0;x<matches.length;x++){string=string.replace(matches[x],matches[x].replace(/\&lt;/gi,'<').replace(/\&gt;/gi,'>').replace(/\&amp;/gi,'&'));}}}
var node=jQuery('<span class="mceItemHidden"></span>');node.html(string);return node;};core.remove=function(node){return jQuery(node).remove();};core.removeParent=function(node){if(jQuery(node).unwrap){return jQuery(node).contents().unwrap();}else{return jQuery(node).replaceWith(jQuery(node).html());}};core.getAttrib=function(node,name){return jQuery(node).attr(name);};return core;};AtD.core=AtD.initCoreModule();

} /* end modules/after-the-deadline/jquery.atd.js */

if ( jpconcat.files['modules/after-the-deadline/tinymce/editor_plugin.js'] ) {

(function()
{var each=tinymce.each,DOM=tinymce.DOM,core;function getLang(key,defaultStr){return(window.AtD_l10n_r0ar&&window.AtD_l10n_r0ar[key])||defaultStr;}
tinymce.create('tinymce.plugins.AfterTheDeadlinePlugin',{getInfo:function()
{return{longname:'After The Deadline',author:'Raphael Mudge',authorurl:'http://blog.afterthedeadline.com',infourl:'http://www.afterthedeadline.com',version:tinymce.majorVersion+'.'+tinymce.minorVersion};},initAtDCore:function(editor)
{var core=new AtDCore();core.map=each;core.getAttrib=function(node,key)
{return editor.dom.getAttrib(node,key);};core.findSpans=function(parent)
{if(!parent){return editor.dom.select('span');}else{return editor.dom.select('span',parent);}};core.hasClass=function(node,className)
{return editor.dom.hasClass(node,className);};core.contents=function(node)
{return node.childNodes;};core.replaceWith=function(old_node,new_node)
{return editor.dom.replace(new_node,old_node);};core.create=function(node_html)
{return editor.dom.create('span',{'class':'mceItemHidden'},node_html);};core.removeParent=function(node)
{editor.dom.remove(node,1);return node;};core.remove=function(node)
{editor.dom.remove(node);};core.setIgnoreStrings(editor.getParam('atd_ignore_strings',[]).join(','));core.showTypes(editor.getParam('atd_show_types',''));return core;},init:function(ed,url)
{if(typeof(AtDCore)==='undefined'){return;}
var plugin=this;var editor=ed;this.url=url;this.editor=ed;core=ed.core=this.initAtDCore(editor,plugin);var ignore=tinymce.util.Cookie.getHash('atd_ignore');if(!ignore){ignore={};}
editor.addCommand('mceWritingImprovementTool',function(callback)
{if(typeof AtD_proofread_click_count!=='undefined'){AtD_proofread_click_count++;}
plugin.editor.setProgressState(1);plugin._removeWords();plugin.sendRequest('checkDocument',ed.getContent({format:'raw'}),function(data,request)
{plugin.editor.setProgressState(0);if(request.status!==200||request.responseText.substr(1,4)==='html'||!request.responseXML)
{ed.windowManager.alert(getLang('message_server_error','There was a problem communicating with the Proofreading service. Try again in one minute.'),callback?function(){callback(0);}:function(){});return;}
if(request.responseXML.getElementsByTagName('message').item(0)!=null)
{ed.windowManager.alert(request.responseXML.getElementsByTagName('message').item(0).firstChild.data,callback?function(){callback(0);}:function(){});return;}
var results=core.processXML(request.responseXML);var ecount=0;if(results.count>0)
{ecount=plugin.markMyWords(results.errors);ed.suggestions=results.suggestions;}
if(ecount===0&&(!callback||callback===undefined)){ed.windowManager.alert(getLang('message_no_errors_found','No writing errors were found.'));}else if(callback){callback(ecount);}});});editor.onInit.add(function()
{if(editor.settings.content_css!==false)
{editor.dom.loadCSS(editor.getParam('atd_css_url',url+'/css/content.css'));}});editor.onClick.add(plugin._showMenu,plugin);editor.onContextMenu.add(plugin._showMenu,plugin);editor.onPreProcess.add(function(sender,object)
{var dom=sender.dom;each(dom.select('span',object.node).reverse(),function(n)
{if(n&&(dom.hasClass(n,'hiddenGrammarError')||dom.hasClass(n,'hiddenSpellError')||dom.hasClass(n,'hiddenSuggestion')||dom.hasClass(n,'mceItemHidden')||(!dom.getAttrib(n,'class')&&!dom.getAttrib(n,'style')&&!dom.getAttrib(n,'id')&&!dom.hasClass(n,'Apple-style-span')&&!dom.getAttrib(n,'mce_name'))))
{dom.remove(n,1);}});});editor.onBeforeExecCommand.add(function(editor,command)
{if(command==='mceCodeEditor')
{plugin._removeWords();}
else if(command==='mceFullScreen')
{plugin._done();}});ed.addButton('AtD',{title:getLang('button_proofread_tooltip','Proofread Writing'),image:ed.getParam('atd_button_url',url+'/atdbuttontr.gif'),cmd:'mceWritingImprovementTool'});},_removeWords:function(w)
{var ed=this.editor,dom=ed.dom,se=ed.selection,b=se.getBookmark();ed.core.removeWords(undefined,w);dom.setHTML(dom.getRoot(),dom.getRoot().innerHTML);se.moveToBookmark(b);},markMyWords:function(errors)
{var ed=this.editor;var se=ed.selection,b=se.getBookmark();var ecount=ed.core.markMyWords(ed.core.contents(this.editor.getBody()),errors);se.moveToBookmark(b);return ecount;},_showMenu:function(ed,e)
{var t=this;ed=t.editor;var m=t._menu,p1,dom=ed.dom,vp=dom.getViewPort(ed.getWin());if(!m)
{p1=DOM.getPos(ed.getContentAreaContainer());m=ed.controlManager.createDropMenu('spellcheckermenu',{offset_x:p1.x,offset_y:p1.y,'class':'mceNoIcons'});t._menu=m;}
if(ed.core.isMarkedNode(e.target))
{m.removeAll();var errorDescription=ed.core.findSuggestion(e.target);if(!errorDescription)
{m.add({title:getLang('menu_title_no_suggestions','No suggestions'),'class':'mceMenuItemTitle'}).setDisabled(1);}
else if(errorDescription['suggestions'].length===0)
{m.add({title:errorDescription['description'],'class':'mceMenuItemTitle'}).setDisabled(1);}
else
{m.add({title:errorDescription['description'],'class':'mceMenuItemTitle'}).setDisabled(1);for(var i=0;i<errorDescription['suggestions'].length;i++)
{(function(sugg)
{m.add({title:sugg,onclick:function()
{ed.core.applySuggestion(e.target,sugg);t._checkDone();}});})(errorDescription['suggestions'][i]);}
m.addSeparator();}
if(errorDescription&&errorDescription['moreinfo'])
{(function(url)
{m.add({title:getLang('menu_option_explain','Explain...'),onclick:function()
{ed.windowManager.open({url:url,width:480,height:380,inline:true},{theme_url:this.url});}});})(errorDescription['moreinfo']);m.addSeparator();}
m.add({title:getLang('menu_option_ignore_once','Ignore suggestion'),onclick:function()
{dom.remove(e.target,1);t._checkDone();}});if(String(this.editor.getParam('atd_ignore_enable','false'))==='true')
{m.add({title:getLang('menu_option_ignore_always','Ignore always'),onclick:function()
{var url=t.editor.getParam('atd_ignore_rpc_url','{backend}');if(url==='{backend}')
{var ignore=tinymce.util.Cookie.getHash('atd_ignore');if(!ignore){ignore={};}
ignore[e.target.innerHTML]=1;tinymce.util.Cookie.setHash('atd_ignore',ignore,new Date((new Date().getTime())+157680000000));}
else
{var id=t.editor.getParam('atd_rpc_id','12345678');tinymce.util.XHR.send({url:url+encodeURI(e.target.innerHTML).replace(/&/g,'%26')+'&key='+id,content_type:'text/xml',async:true,type:'GET',success:function()
{},error:function(type,req,o)
{alert('Ignore preference save failed\n'+type+'\n'+req.status+'\nAt: '+o.url);}});t.editor.core.setIgnoreStrings(e.target.innerHTML);}
t._removeWords(e.target.innerHTML);t._checkDone();}});}
else
{m.add({title:getLang('menu_option_ignore_all','Ignore all'),onclick:function()
{t._removeWords(e.target.innerHTML);t._checkDone();}});}
ed.selection.select(e.target);p1=dom.getPos(e.target);m.showMenu(p1.x,p1.y+e.target.offsetHeight-vp.y);return tinymce.dom.Event.cancel(e);}
else
{m.hideMenu();}},_checkDone:function()
{var t=this,ed=t.editor,dom=ed.dom,o;each(dom.select('span'),function(n)
{if(n&&dom.hasClass(n,'mceItemHidden'))
{o=true;return false;}});if(!o)
{t._done();}},_done:function()
{var plugin=this;plugin._removeWords();if(plugin._menu)
{plugin._menu.hideMenu();}
plugin.editor.nodeChanged();},sendRequest:function(file,data,success)
{var id=this.editor.getParam('atd_rpc_id','12345678');var url=this.editor.getParam('atd_rpc_url','{backend}');var plugin=this;if(url==='{backend}'||id==='12345678')
{this.editor.setProgressState(0);alert('Please specify: atd_rpc_url and atd_rpc_id');return;}
tinymce.util.XHR.send({url:url+'/'+file,content_type:'text/xml',type:'POST',data:'data='+encodeURI(data).replace(/&/g,'%26')+'&key='+id,async:true,success:success,error:function(type,req,o)
{plugin.editor.setProgressState(0);alert(type+'\n'+req.status+'\nAt: '+o.url);}});}});tinymce.PluginManager.add('AtD',tinymce.plugins.AfterTheDeadlinePlugin);})();

} /* end modules/after-the-deadline/tinymce/editor_plugin.js */

if ( jpconcat.files['modules/after-the-deadline/tinymce/plugin.js'] ) {

tinymce.PluginManager.add('AtD',function(editor){var suggestionsMenu,started,atdCore,dom,each=tinymce.each;function initAtDCore(){atdCore=new window.AtDCore();atdCore.map=each;atdCore._isTinyMCE=true;atdCore.getAttrib=function(node,key){return dom.getAttrib(node,key);};atdCore.findSpans=function(parent){if(parent===undefined){return dom.select('span');}else{return dom.select('span',parent);}};atdCore.hasClass=function(node,className){return dom.hasClass(node,className);};atdCore.contents=function(node){return node.childNodes;};atdCore.replaceWith=function(old_node,new_node){return dom.replace(new_node,old_node);};atdCore.create=function(node_html){return dom.create('span',{'class':'mceItemHidden','data-mce-bogus':1},node_html);};atdCore.removeParent=function(node){dom.remove(node,true);return node;};atdCore.remove=function(node){dom.remove(node);};atdCore.setIgnoreStrings(editor.getParam('atd_ignore_strings',[]).join(','));atdCore.showTypes(editor.getParam('atd_show_types',''));}
function getLang(key,defaultStr){return(window.AtD_l10n_r0ar&&window.AtD_l10n_r0ar[key])||defaultStr;}
function isMarkedNode(node){return(node.className&&/\bhidden(GrammarError|SpellError|Suggestion)\b/.test(node.className));}
function markMyWords(errors){return atdCore.markMyWords(atdCore.contents(editor.getBody()),errors);}
function checkIfFinished(){if(!editor.dom.select('span.hiddenSpellError, span.hiddenGrammarError, span.hiddenSuggestion').length){if(suggestionsMenu){suggestionsMenu.hideMenu();}
finish();}}
function ignoreWord(target,word,all){var dom=editor.dom;if(all){each(editor.dom.select('span.hiddenSpellError, span.hiddenGrammarError, span.hiddenSuggestion'),function(node){var text=node.innerText||node.textContent;if(text===word){dom.remove(node,true);}});}else{dom.remove(target,true);}
checkIfFinished();}
function finish(){var node,dom=editor.dom,regex=new RegExp('mceItemHidden|hidden(((Grammar|Spell)Error)|Suggestion)'),nodes=dom.select('span'),i=nodes.length;while(i--){node=nodes[i];if(node.className&&regex.test(node.className)){dom.remove(node,true);}}
editor.setContent(editor.getContent({format:'raw'}),{format:'raw'});started=false;editor.nodeChanged();editor.fire('SpellcheckEnd');}
function sendRequest(file,data,success){var id=editor.getParam('atd_rpc_id','12345678'),url=editor.getParam('atd_rpc_url','{backend}');if(url==='{backend}'||id==='12345678'){window.alert('Please specify: atd_rpc_url and atd_rpc_id');return;}
editor.setProgressState(true);tinymce.util.XHR.send({url:url+'/'+file,content_type:'text/xml',type:'POST',data:'data='+encodeURI(data).replace(/&/g,'%26')+'&key='+id,success:success,error:function(type,req,o){editor.setProgressState();window.alert(type+'\n'+req.status+'\nAt: '+o.url);}});}
function storeIgnoredStrings(){}
function setAlwaysIgnore(text){var url=editor.getParam('atd_ignore_rpc_url');if(!url||url==='{backend}'){storeIgnoredStrings(text);}else{tinymce.util.XHR.send({url:url+encodeURIComponent(text)+'&key='+editor.getParam('atd_rpc_id','12345678'),content_type:'text/xml',type:'GET',error:function(){storeIgnoredStrings(text);}});}
atdCore.setIgnoreStrings(text);}
function showSuggestions(target){var pos,root,targetPos,items=[],text=target.innerText||target.textContent,errorDescription=atdCore.findSuggestion(target);if(!errorDescription){items.push({text:getLang('menu_title_no_suggestions','No suggestions'),classes:'atd-menu-title',disabled:true});}else{items.push({text:errorDescription.description,classes:'atd-menu-title',disabled:true});if(errorDescription.suggestions.length){items.push({text:'-'});each(errorDescription.suggestions,function(suggestion){items.push({text:suggestion,onclick:function(){atdCore.applySuggestion(target,suggestion);checkIfFinished();}});});}}
if(errorDescription&&errorDescription.moreinfo){items.push({text:'-'});items.push({text:getLang('menu_option_explain','Explain...'),onclick:function(){editor.windowManager.open({title:getLang('menu_option_explain','Explain...'),url:errorDescription.moreinfo,width:480,height:380,inline:true});}});}
items.push.apply(items,[{text:'-'},{text:getLang('menu_option_ignore_once','Ignore suggestion'),onclick:function(){ignoreWord(target,text);}}]);if(editor.getParam('atd_ignore_enable')){items.push({text:getLang('menu_option_ignore_always','Ignore always'),onclick:function(){setAlwaysIgnore(text);ignoreWord(target,text,true);}});}else{items.push({text:getLang('menu_option_ignore_all','Ignore all'),onclick:function(){ignoreWord(target,text,true);}});}
suggestionsMenu=new tinymce.ui.Menu({items:items,context:'contextmenu',onautohide:function(event){if(isMarkedNode(event.target)){event.preventDefault();}},onhide:function(){suggestionsMenu.remove();suggestionsMenu=null;}});suggestionsMenu.renderTo(document.body);pos=tinymce.DOM.getPos(editor.getContentAreaContainer());targetPos=editor.dom.getPos(target);root=editor.dom.getRoot();if(root.nodeName==='BODY'){targetPos.x-=root.ownerDocument.documentElement.scrollLeft||root.scrollLeft;targetPos.y-=root.ownerDocument.documentElement.scrollTop||root.scrollTop;}else{targetPos.x-=root.scrollLeft;targetPos.y-=root.scrollTop;}
pos.x+=targetPos.x;pos.y+=targetPos.y;suggestionsMenu.moveTo(pos.x,pos.y+target.offsetHeight);}
editor.on('init',function(){if(typeof window.AtDCore==='undefined'){return;}
dom=editor.dom;initAtDCore();editor.addCommand('mceWritingImprovementTool',function(callback){var results,errorCount=0;if(typeof callback!=='function'){callback=function(){};}
if(typeof window.AtD_proofread_click_count!=='undefined'){window.AtD_proofread_click_count++;}
if(started){finish();return;}
sendRequest('checkDocument',editor.getContent({format:'raw'}),function(data,request){editor.setProgressState();if(request.status!==200||request.responseText.substr(1,4)==='html'||!request.responseXML){editor.windowManager.alert(getLang('message_server_error','There was a problem communicating with the Proofreading service. Try again in one minute.'),callback(0));return;}
if(request.responseXML.getElementsByTagName('message').item(0)!==null){editor.windowManager.alert(request.responseXML.getElementsByTagName('message').item(0).firstChild.data,callback(0));return;}
results=atdCore.processXML(request.responseXML);if(results.count>0){errorCount=markMyWords(results.errors);}
if(!errorCount){editor.windowManager.alert(getLang('message_no_errors_found','No writing errors were found.'));}else{started=true;editor.fire('SpellcheckStart');}
callback(errorCount);});});if(editor.settings.content_css!==false){dom.addStyle('.hiddenSpellError{border-bottom:2px solid red;cursor:default;}'+'.hiddenGrammarError{border-bottom:2px solid green;cursor:default;}'+'.hiddenSuggestion{border-bottom:2px solid blue;cursor:default;}');}
tinymce.DOM.addStyle('div.mce-floatpanel{z-index:150100 !important;}');editor.on('click',function(event){if(isMarkedNode(event.target)){event.preventDefault();editor.selection.select(event.target);showSuggestions(event.target);}});});editor.addMenuItem('spellchecker',{text:getLang('button_proofread_tooltip','Proofread Writing'),context:'tools',cmd:'mceWritingImprovementTool',onPostRender:function(){var self=this;editor.on('SpellcheckStart SpellcheckEnd',function(){self.active(started);});}});editor.addButton('spellchecker',{tooltip:getLang('button_proofread_tooltip','Proofread Writing'),cmd:'mceWritingImprovementTool',onPostRender:function(){var self=this;editor.on('SpellcheckStart SpellcheckEnd',function(){self.active(started);});}});editor.on('remove',function(){if(suggestionsMenu){suggestionsMenu.remove();suggestionsMenu=null;}});});

} /* end modules/after-the-deadline/tinymce/plugin.js */

if ( jpconcat.files['modules/carousel/jetpack-carousel.js'] ) {

jQuery(document).ready(function($){var overlay,comments,gallery,container,nextButton,previousButton,info,transitionBegin,caption,resizeTimeout,photo_info,close_hint,commentInterval,lastSelectedSlide,screenPadding=110,originalOverflow=$('body').css('overflow'),originalHOverflow=$('html').css('overflow'),proportion=85,last_known_location_hash='',imageMeta,titleAndDescription,commentForm,leftColWrapper;if(window.innerWidth<=760){screenPadding=Math.round((window.innerWidth / 760)*110);if(screenPadding<40&&(('ontouchstart'in window)||window.DocumentTouch&&document instanceof DocumentTouch)){screenPadding=0;}}
var keyListener=function(e){switch(e.which){case 38:e.preventDefault();container.scrollTop(container.scrollTop()-100);break;case 40:e.preventDefault();container.scrollTop(container.scrollTop()+100);break;case 39:e.preventDefault();gallery.jp_carousel('clearCommentTextAreaValue');gallery.jp_carousel('next');break;case 37:case 8:e.preventDefault();gallery.jp_carousel('clearCommentTextAreaValue');gallery.jp_carousel('previous');break;case 27:e.preventDefault();gallery.jp_carousel('clearCommentTextAreaValue');container.jp_carousel('close');break;default:break;}};var resizeListener=function(){clearTimeout(resizeTimeout);resizeTimeout=setTimeout(function(){gallery.jp_carousel('slides').jp_carousel('fitSlide',true);gallery.jp_carousel('updateSlidePositions',true);gallery.jp_carousel('fitMeta',true);},200);};var prepareGallery=function(){if(!overlay){overlay=$('<div></div>').addClass('jp-carousel-overlay').css({'position':'absolute','top':0,'right':0,'bottom':0,'left':0});var buttons='<a class="jp-carousel-commentlink" href="#">'+jetpackCarouselStrings.comment+'</a>';if(1===Number(jetpackCarouselStrings.is_logged_in)){}
buttons=$('<div class="jp-carousel-buttons">'+buttons+'</div>');caption=$('<h2></h2>');photo_info=$('<div class="jp-carousel-photo-info"></div>').append(caption);imageMeta=$('<div></div>').addClass('jp-carousel-image-meta').css({'float':'right','margin-top':'20px','width':'250px'});imageMeta.append(buttons).append('<ul class=\'jp-carousel-image-exif\' style=\'display:none;\'></ul>').append('<a class=\'jp-carousel-image-download\' style=\'display:none;\'></a>').append('<div class=\'jp-carousel-image-map\' style=\'display:none;\'></div>');titleAndDescription=$('<div></div>').addClass('jp-carousel-titleanddesc').css({'width':'100%','margin-top':imageMeta.css('margin-top')});var commentFormMarkup='<div id="jp-carousel-comment-form-container">';if(jetpackCarouselStrings.local_comments_commenting_as&&jetpackCarouselStrings.local_comments_commenting_as.length){if(1!==Number(jetpackCarouselStrings.is_logged_in)&&1===Number(jetpackCarouselStrings.comment_registration)){commentFormMarkup+='<div id="jp-carousel-comment-form-commenting-as">'+jetpackCarouselStrings.local_comments_commenting_as+'</div>';}else{commentFormMarkup+='<form id="jp-carousel-comment-form">';commentFormMarkup+='<textarea name="comment" class="jp-carousel-comment-form-field jp-carousel-comment-form-textarea" id="jp-carousel-comment-form-comment-field" placeholder="'+jetpackCarouselStrings.write_comment+'"></textarea>';commentFormMarkup+='<div id="jp-carousel-comment-form-submit-and-info-wrapper">';commentFormMarkup+='<div id="jp-carousel-comment-form-commenting-as">'+jetpackCarouselStrings.local_comments_commenting_as+'</div>';commentFormMarkup+='<input type="submit" name="submit" class="jp-carousel-comment-form-button" id="jp-carousel-comment-form-button-submit" value="'+jetpackCarouselStrings.post_comment+'" />';commentFormMarkup+='<span id="jp-carousel-comment-form-spinner">&nbsp;</span>';commentFormMarkup+='<div id="jp-carousel-comment-post-results"></div>';commentFormMarkup+='</div>';commentFormMarkup+='</form>';}}
commentFormMarkup+='</div>';commentForm=$(commentFormMarkup).css({'width':'100%','margin-top':'20px','color':'#999'});comments=$('<div></div>').addClass('jp-carousel-comments').css({'width':'100%','bottom':'10px','margin-top':'20px'});var commentsLoading=$('<div id="jp-carousel-comments-loading"><span>'+jetpackCarouselStrings.loading_comments+'</span></div>').css({'width':'100%','bottom':'10px','margin-top':'20px'});var leftWidth=($(window).width()-(screenPadding*2))-(imageMeta.width()+40);leftWidth+='px';leftColWrapper=$('<div></div>').addClass('jp-carousel-left-column-wrapper').css({'width':Math.floor(leftWidth)}).append(titleAndDescription).append(commentForm).append(comments).append(commentsLoading);var fadeaway=$('<div></div>').addClass('jp-carousel-fadeaway');info=$('<div></div>').addClass('jp-carousel-info').css({'top':Math.floor(($(window).height()/ 100)*proportion),'left':screenPadding,'right':screenPadding}).append(photo_info).append(imageMeta);if(window.innerWidth<=760){photo_info.remove().insertAfter(titleAndDescription);info.prepend(leftColWrapper);}
else{info.append(leftColWrapper);}
var targetBottomPos=($(window).height()-parseInt(info.css('top'),10))+'px';nextButton=$('<div><span></span></div>').addClass('jp-carousel-next-button').css({'right':'15px'});previousButton=$('<div><span></span></div>').addClass('jp-carousel-previous-button').css({'left':0});nextButton.add(previousButton).css({'position':'fixed','top':'40px','bottom':targetBottomPos,'width':screenPadding});gallery=$('<div></div>').addClass('jp-carousel').css({'position':'absolute','top':0,'bottom':targetBottomPos,'left':0,'right':0});close_hint=$('<div class="jp-carousel-close-hint"><span>&times;</span></div>').css({position:'fixed'});container=$('<div></div>').addClass('jp-carousel-wrap').addClass('jp-carousel-transitions');if('white'===jetpackCarouselStrings.background_color){container.addClass('jp-carousel-light');}
container.css({'position':'fixed','top':0,'right':0,'bottom':0,'left':0,'z-index':2147483647,'overflow-x':'hidden','overflow-y':'auto','direction':'ltr'}).hide().append(overlay).append(gallery).append(fadeaway).append(info).append(nextButton).append(previousButton).append(close_hint).appendTo($('body')).click(function(e){var target=$(e.target),wrap=target.parents('div.jp-carousel-wrap'),data=wrap.data('carousel-extra'),slide=wrap.find('div.selected'),attachment_id=slide.data('attachment-id');data=data||[];if(target.is(gallery)||target.parents().add(target).is(close_hint)){container.jp_carousel('close');}else if(target.hasClass('jp-carousel-commentlink')){e.preventDefault();e.stopPropagation();$(window).unbind('keydown',keyListener);container.animate({scrollTop:parseInt(info.position()['top'],10)},'fast');$('#jp-carousel-comment-form-submit-and-info-wrapper').slideDown('fast');$('#jp-carousel-comment-form-comment-field').focus();}else if(target.hasClass('jp-carousel-comment-login')){var url=jetpackCarouselStrings.login_url+'%23jp-carousel-'+attachment_id;window.location.href=url;}else if(target.parents('#jp-carousel-comment-form-container').length){var textarea=$('#jp-carousel-comment-form-comment-field').blur(function(){$(window).bind('keydown',keyListener);}).focus(function(){$(window).unbind('keydown',keyListener);});var emailField=$('#jp-carousel-comment-form-email-field').blur(function(){$(window).bind('keydown',keyListener);}).focus(function(){$(window).unbind('keydown',keyListener);});var authorField=$('#jp-carousel-comment-form-author-field').blur(function(){$(window).bind('keydown',keyListener);}).focus(function(){$(window).unbind('keydown',keyListener);});var urlField=$('#jp-carousel-comment-form-url-field').blur(function(){$(window).bind('keydown',keyListener);}).focus(function(){$(window).unbind('keydown',keyListener);});if(textarea&&textarea.attr('id')===target.attr('id')){$(window).unbind('keydown',keyListener);$('#jp-carousel-comment-form-submit-and-info-wrapper').slideDown('fast');}else if(target.is('input[type="submit"]')){e.preventDefault();e.stopPropagation();$('#jp-carousel-comment-form-spinner').spin('small','white');var ajaxData={action:'post_attachment_comment',nonce:jetpackCarouselStrings.nonce,blog_id:data['blog_id'],id:attachment_id,comment:textarea.val()};if(!ajaxData['comment'].length){gallery.jp_carousel('postCommentError',{'field':'jp-carousel-comment-form-comment-field','error':jetpackCarouselStrings.no_comment_text});return;}
if(1!==Number(jetpackCarouselStrings.is_logged_in)){ajaxData['email']=emailField.val();ajaxData['author']=authorField.val();ajaxData['url']=urlField.val();if(1===Number(jetpackCarouselStrings.require_name_email)){if(!ajaxData['email'].length||!ajaxData['email'].match('@')){gallery.jp_carousel('postCommentError',{'field':'jp-carousel-comment-form-email-field','error':jetpackCarouselStrings.no_comment_email});return;}else if(!ajaxData['author'].length){gallery.jp_carousel('postCommentError',{'field':'jp-carousel-comment-form-author-field','error':jetpackCarouselStrings.no_comment_author});return;}}}
$.ajax({type:'POST',url:jetpackCarouselStrings.ajaxurl,data:ajaxData,dataType:'json',success:function(response){if('approved'===response.comment_status){$('#jp-carousel-comment-post-results').slideUp('fast').html('<span class="jp-carousel-comment-post-success">'+jetpackCarouselStrings.comment_approved+'</span>').slideDown('fast');}else if('unapproved'===response.comment_status){$('#jp-carousel-comment-post-results').slideUp('fast').html('<span class="jp-carousel-comment-post-success">'+jetpackCarouselStrings.comment_unapproved+'</span>').slideDown('fast');}else{$('#jp-carousel-comment-post-results').slideUp('fast').html('<span class="jp-carousel-comment-post-error">'+jetpackCarouselStrings.comment_post_error+'</span>').slideDown('fast');}
gallery.jp_carousel('clearCommentTextAreaValue');gallery.jp_carousel('getComments',{attachment_id:attachment_id,offset:0,clear:true});$('#jp-carousel-comment-form-button-submit').val(jetpackCarouselStrings.post_comment);$('#jp-carousel-comment-form-spinner').spin(false);},error:function(){gallery.jp_carousel('postCommentError',{'field':'jp-carousel-comment-form-comment-field','error':jetpackCarouselStrings.comment_post_error});return;}});}}else if(!target.parents('.jp-carousel-info').length){container.jp_carousel('next');}}).bind('jp_carousel.afterOpen',function(){$(window).bind('keydown',keyListener);$(window).bind('resize',resizeListener);gallery.opened=true;resizeListener();}).bind('jp_carousel.beforeClose',function(){var scroll=$(window).scrollTop();$(window).unbind('keydown',keyListener);$(window).unbind('resize',resizeListener);$(window).scrollTop(scroll);}).bind('jp_carousel.afterClose',function(){if(history.pushState){history.pushState('',document.title,window.location.pathname+window.location.search);}else{last_known_location_hash='';window.location.hash='';}
gallery.opened=false;}).on('transitionend.jp-carousel ','.jp-carousel-slide',function(e){if('transform'===e.originalEvent.propertyName){var transitionMultiplier=((Date.now()-transitionBegin)/ 1000)/ e.originalEvent.elapsedTime;container.off('transitionend.jp-carousel');if(transitionMultiplier>=2){$('.jp-carousel-transitions').removeClass('jp-carousel-transitions');}}});$('.jp-carousel-wrap').touchwipe({wipeLeft:function(e){e.preventDefault();gallery.jp_carousel('next');},wipeRight:function(e){e.preventDefault();gallery.jp_carousel('previous');},preventDefaultEvents:false});$('.jetpack-likes-widget-unloaded').each(function(){jetpackLikesWidgetQueue.push(this.id);});nextButton.add(previousButton).click(function(e){e.preventDefault();e.stopPropagation();if(nextButton.is(this)){gallery.jp_carousel('next');}else{gallery.jp_carousel('previous');}});}};var methods={testForData:function(gallery){gallery=$(gallery);return!(!gallery.length||!gallery.data('carousel-extra'));},testIfOpened:function(){return!!('undefined'!==typeof(gallery)&&'undefined'!==typeof(gallery.opened)&&gallery.opened);},openOrSelectSlide:function(index){if(!$(this).jp_carousel('testIfOpened')){$(this).jp_carousel('open',{start_index:index});}else{gallery.jp_carousel('selectSlideAtIndex',index);}},open:function(options){var settings={'items_selector':'.gallery-item [data-attachment-id], .tiled-gallery-item [data-attachment-id]','start_index':0},data=$(this).data('carousel-extra');if(!data){return;}
prepareGallery(data);if(gallery.jp_carousel('testIfOpened')){return;}
originalOverflow=$('body').css('overflow');$('body').css('overflow','hidden');originalHOverflow=$('html').css('overflow');$('html').css('overflow','hidden');jQuery('.slim-likes-widget').find('iframe').css('display','inline-block').css('width','60px');container.data('carousel-extra',data);return this.each(function(){var $this=$(this);if(options){$.extend(settings,options);}
if(-1===settings.start_index){settings.start_index=0;}
container.trigger('jp_carousel.beforeOpen').fadeIn('fast',function(){container.trigger('jp_carousel.afterOpen');gallery.jp_carousel('initSlides',$this.find(settings.items_selector),settings.start_index).jp_carousel('selectSlideAtIndex',settings.start_index);});gallery.html('');});},selectSlideAtIndex:function(index){var slides=this.jp_carousel('slides'),selected=slides.eq(index);if(0===selected.length){selected=slides.eq(0);}
gallery.jp_carousel('selectSlide',selected,false);return this;},close:function(){$('body').css('overflow',originalOverflow);$('html').css('overflow',originalHOverflow);return container.trigger('jp_carousel.beforeClose').fadeOut('fast',function(){container.trigger('jp_carousel.afterClose');});},next:function(){var slide=gallery.jp_carousel('nextSlide');container.animate({scrollTop:0},'fast');if(slide){this.jp_carousel('selectSlide',slide);}},previous:function(){var slide=gallery.jp_carousel('prevSlide');container.animate({scrollTop:0},'fast');if(slide){this.jp_carousel('selectSlide',slide);}},resetButtons:function(current){if(current.data('liked')){$('.jp-carousel-buttons a.jp-carousel-like').addClass('liked').text(jetpackCarouselStrings.unlike);}else{$('.jp-carousel-buttons a.jp-carousel-like').removeClass('liked').text(jetpackCarouselStrings.like);}},selectedSlide:function(){return this.find('.selected');},setSlidePosition:function(x){transitionBegin=Date.now();return this.css({'-webkit-transform':'translate3d('+x+'px,0,0)','-moz-transform':'translate3d('+x+'px,0,0)','-ms-transform':'translate('+x+'px,0)','-o-transform':'translate('+x+'px,0)','transform':'translate3d('+x+'px,0,0)'});},updateSlidePositions:function(animate){var current=this.jp_carousel('selectedSlide'),galleryWidth=gallery.width(),currentWidth=current.width(),previous=gallery.jp_carousel('prevSlide'),next=gallery.jp_carousel('nextSlide'),previousPrevious=previous.prev(),nextNext=next.next(),left=Math.floor((galleryWidth-currentWidth)*0.5);current.jp_carousel('setSlidePosition',left).show();gallery.jp_carousel('fitInfo',animate);var direction=lastSelectedSlide.is(current.prevAll())?1:-1;if(1===direction){if(!nextNext.is(previous)){nextNext.jp_carousel('setSlidePosition',galleryWidth+next.width()).show();}
if(!previousPrevious.is(next)){previousPrevious.jp_carousel('setSlidePosition',-previousPrevious.width()-currentWidth).show();}}else{if(!nextNext.is(previous)){nextNext.jp_carousel('setSlidePosition',galleryWidth+currentWidth).show();}}
previous.jp_carousel('setSlidePosition',Math.floor(-previous.width()+(screenPadding*0.75))).show();next.jp_carousel('setSlidePosition',Math.ceil(galleryWidth-(screenPadding*0.75))).show();},selectSlide:function(slide,animate){lastSelectedSlide=this.find('.selected').removeClass('selected');var slides=gallery.jp_carousel('slides').css({'position':'fixed'}),current=$(slide).addClass('selected').css({'position':'relative'}),attachmentId=current.data('attachment-id'),previous=gallery.jp_carousel('prevSlide'),next=gallery.jp_carousel('nextSlide'),previousPrevious=previous.prev(),nextNext=next.next(),animated,captionHtml;gallery.jp_carousel('loadFullImage',current);caption.hide();if(next.length===0&&slides.length<=2){$('.jp-carousel-next-button').hide();}else{$('.jp-carousel-next-button').show();}
if(previous.length===0&&slides.length<=2){$('.jp-carousel-previous-button').hide();}else{$('.jp-carousel-previous-button').show();}
animated=current.add(previous).add(previousPrevious).add(next).add(nextNext).jp_carousel('loadSlide');slides.not(animated).hide();gallery.jp_carousel('updateSlidePositions',animate);gallery.jp_carousel('resetButtons',current);container.trigger('jp_carousel.selectSlide',[current]);gallery.jp_carousel('getTitleDesc',{title:current.data('title'),desc:current.data('desc')});gallery.jp_carousel('loadLikes',attachmentId);gallery.jp_carousel('updateLikesWidgetVisibility',attachmentId);if(next.length>0){gallery.jp_carousel('loadLikes',next.data('attachment-id'));}
if(previous.length>0){gallery.jp_carousel('loadLikes',previous.data('attachment-id'));}
var imageMeta=current.data('image-meta');gallery.jp_carousel('updateExif',imageMeta);gallery.jp_carousel('updateFullSizeLink',current);gallery.jp_carousel('updateMap',imageMeta);gallery.jp_carousel('testCommentsOpened',current.data('comments-opened'));gallery.jp_carousel('getComments',{'attachment_id':attachmentId,'offset':0,'clear':true});$('#jp-carousel-comment-post-results').slideUp();if(current.data('caption')){captionHtml=$('<div />').text(current.data('caption')).html();if(captionHtml===$('<div />').text(current.data('title')).html()){$('.jp-carousel-titleanddesc-title').fadeOut('fast').empty();}
if(captionHtml===$('<div />').text(current.data('desc')).html()){$('.jp-carousel-titleanddesc-desc').fadeOut('fast').empty();}
caption.html(current.data('caption')).fadeIn('slow');}else{caption.fadeOut('fast').empty();}
$(next).add(previous).each(function(){gallery.jp_carousel('loadFullImage',$(this));});window.location.hash=last_known_location_hash='#jp-carousel-'+attachmentId;},slides:function(){return this.find('.jp-carousel-slide');},slideDimensions:function(){return{width:$(window).width()-(screenPadding*2),height:Math.floor($(window).height()/ 100*proportion-60)};},loadSlide:function(){return this.each(function(){var slide=$(this);slide.find('img').one('load',function(){slide.jp_carousel('fitSlide',false);});});},bestFit:function(){var max=gallery.jp_carousel('slideDimensions'),orig=this.jp_carousel('originalDimensions'),orig_ratio=orig.width / orig.height,w_ratio=1,h_ratio=1,width,height;if(orig.width>max.width){w_ratio=max.width / orig.width;}
if(orig.height>max.height){h_ratio=max.height / orig.height;}
if(w_ratio<h_ratio){width=max.width;height=Math.floor(width / orig_ratio);}else if(h_ratio<w_ratio){height=max.height;width=Math.floor(height*orig_ratio);}else{width=orig.width;height=orig.height;}
return{width:width,height:height};},fitInfo:function(){var current=this.jp_carousel('selectedSlide'),size=current.jp_carousel('bestFit');photo_info.css({'left':Math.floor((info.width()-size.width)*0.5),'width':Math.floor(size.width)});return this;},fitMeta:function(animated){var newInfoTop={top:Math.floor($(window).height()/ 100*proportion+5)+'px'};var newLeftWidth={width:(info.width()-(imageMeta.width()+80))+'px'};if(animated){info.animate(newInfoTop);leftColWrapper.animate(newLeftWidth);}else{info.animate(newInfoTop);leftColWrapper.css(newLeftWidth);}},fitSlide:function(){return this.each(function(){var $this=$(this),dimensions=$this.jp_carousel('bestFit'),method='css',max=gallery.jp_carousel('slideDimensions');dimensions.left=0;dimensions.top=Math.floor((max.height-dimensions.height)*0.5)+40;$this[method](dimensions);});},texturize:function(text){text=''+text;text=text.replace(/'/g,'&#8217;').replace(/&#039;/g,'&#8217;').replace(/[\u2019]/g,'&#8217;');text=text.replace(/"/g,'&#8221;').replace(/&#034;/g,'&#8221;').replace(/&quot;/g,'&#8221;').replace(/[\u201D]/g,'&#8221;');text=text.replace(/([\w]+)=&#[\d]+;(.+?)&#[\d]+;/g,'$1="$2"');return $.trim(text);},initSlides:function(items,start_index){if(items.length<2){$('.jp-carousel-next-button, .jp-carousel-previous-button').hide();}else{$('.jp-carousel-next-button, .jp-carousel-previous-button').show();}
items.each(function(){var src_item=$(this),orig_size=src_item.data('orig-size')||'',max=gallery.jp_carousel('slideDimensions'),parts=orig_size.split(','),medium_file=src_item.data('medium-file')||'',large_file=src_item.data('large-file')||'',src;orig_size={width:parseInt(parts[0],10),height:parseInt(parts[1],10)};src=src_item.data('orig-file');src=gallery.jp_carousel('selectBestImageSize',{orig_file:src,orig_width:orig_size.width,orig_height:orig_size.height,max_width:max.width,max_height:max.height,medium_file:medium_file,large_file:large_file});$(this).data('gallery-src',src);});if(0!==start_index){$('<img/>')[0].src=$(items[start_index]).data('gallery-src');}
var useInPageThumbnails=items.first().closest('.tiled-gallery.type-rectangular').length>0;items.each(function(i){var src_item=$(this),attachment_id=src_item.data('attachment-id')||0,comments_opened=src_item.data('comments-opened')||0,image_meta=src_item.data('image-meta')||{},orig_size=src_item.data('orig-size')||'',thumb_size={width:src_item[0].naturalWidth,height:src_item[0].naturalHeight},title=src_item.data('image-title')||'',description=src_item.data('image-description')||'',caption=src_item.parents('dl').find('dd.gallery-caption').html()||'',src=src_item.data('gallery-src')||'',medium_file=src_item.data('medium-file')||'',large_file=src_item.data('large-file')||'',orig_file=src_item.data('orig-file')||'';var tiledCaption=src_item.parents('div.tiled-gallery-item').find('div.tiled-gallery-caption').html();if(tiledCaption){caption=tiledCaption;}
if(attachment_id&&orig_size.length){title=gallery.jp_carousel('texturize',title);description=gallery.jp_carousel('texturize',description);caption=gallery.jp_carousel('texturize',caption);var image=$('<img/>').attr('src','data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7').css('width','100%').css('height','100%');var slide=$('<div class="jp-carousel-slide"></div>').hide().css({'left':i<start_index?-1000:gallery.width()}).append(image).appendTo(gallery).data('src',src).data('title',title).data('desc',description).data('caption',caption).data('attachment-id',attachment_id).data('permalink',src_item.parents('a').attr('href')).data('orig-size',orig_size).data('comments-opened',comments_opened).data('image-meta',image_meta).data('medium-file',medium_file).data('large-file',large_file).data('orig-file',orig_file).data('thumb-size',thumb_size);if(useInPageThumbnails){slide.data('preview-image',src_item.attr('src')).css({'background-image':'url("'+src_item.attr('src')+'")','background-size':'100% 100%','background-position':'center center'});}
slide.jp_carousel('fitSlide',false);}});return this;},selectBestImageSize:function(args){if('object'!==typeof args){args={};}
if('undefined'===typeof args.orig_file){return'';}
if('undefined'===typeof args.orig_width||'undefined'===typeof args.max_width){return args.orig_file;}
if('undefined'===typeof args.medium_file||'undefined'===typeof args.large_file){return args.orig_file;}
var medium_size=args.medium_file.replace(/-([\d]+x[\d]+)\..+$/,'$1'),medium_size_parts=(medium_size!==args.medium_file)?medium_size.split('x'):[args.orig_width,0],medium_width=parseInt(medium_size_parts[0],10),medium_height=parseInt(medium_size_parts[1],10),large_size=args.large_file.replace(/-([\d]+x[\d]+)\..+$/,'$1'),large_size_parts=(large_size!==args.large_file)?large_size.split('x'):[args.orig_width,0],large_width=parseInt(large_size_parts[0],10),large_height=parseInt(large_size_parts[1],10);if('undefined'!==typeof window.devicePixelRatio&&window.devicePixelRatio>1){args.max_width=args.max_width*window.devicePixelRatio;args.max_height=args.max_height*window.devicePixelRatio;}
if(large_width>=args.max_width||large_height>=args.max_height){return args.large_file;}
if(medium_width>=args.max_width||medium_height>=args.max_height){return args.medium_file;}
return args.orig_file;},originalDimensions:function(){var splitted=$(this).data('orig-size').split(',');return{width:parseInt(splitted[0],10),height:parseInt(splitted[1],10)};},format:function(args){if('object'!==typeof args){args={};}
if(!args.text||'undefined'===typeof args.text){return;}
if(!args.replacements||'undefined'===typeof args.replacements){return args.text;}
return args.text.replace(/{(\d+)}/g,function(match,number){return typeof args.replacements[number]!=='undefined'?args.replacements[number]:match;});},shutterSpeed:function(d){if(d>=1){return Math.round(d)+'s';}
var df=1,top=1,bot=1;var limit=1e3;while(df!==d&&limit-->0){if(df<d){top+=1;}else{bot+=1;top=parseInt(d*bot,10);}
df=top / bot;}
if(top>1){bot=Math.round(bot / top);top=1;}
if(bot<=1){return'1s';}
return top+'/'+bot+'s';},parseTitleDesc:function(value){if(!value.match(' ')&&value.match('_')){return'';}
$(['CIMG','DSC_','DSCF','DSCN','DUW','GEDC','IMG','JD','MGP','PICT','Imagen','Foto','DSC','Scan','SANY','SAM','Screen Shot [0-9]+']).each(function(key,val){var regex=new RegExp('^'+val);if(regex.test(value)){value='';return;}});return value;},getTitleDesc:function(data){var title='',desc='',markup='',target;target=$('div.jp-carousel-titleanddesc','div.jp-carousel-wrap');target.hide();title=gallery.jp_carousel('parseTitleDesc',data.title)||'';desc=gallery.jp_carousel('parseTitleDesc',data.desc)||'';if(title.length||desc.length){if($('<div />').text(title).html()===$('<div />').text(desc).html()){title='';}
markup=(title.length)?'<div class="jp-carousel-titleanddesc-title">'+title+'</div>':'';markup+=(desc.length)?'<div class="jp-carousel-titleanddesc-desc">'+desc+'</div>':'';target.html(markup).fadeIn('slow');}
$('div#jp-carousel-comment-form-container').css('margin-top','20px');$('div#jp-carousel-comments-loading').css('margin-top','20px');},updateLikesWidgetVisibility:function(attachmentId){if('undefined'===typeof jetpackLikesWidgetQueue){return;}
$('.jp-carousel-buttons .jetpack-likes-widget-wrapper').css('display','none').each(function(){var widgetWrapper=$(this);if(widgetWrapper.attr('data-attachment-id')==attachmentId){widgetWrapper.css('display','inline-block');return false;}});},loadLikes:function(attachmentId){var dataCarouselExtra=$('.jp-carousel-wrap').data('carousel-extra');var blogId=dataCarouselExtra.likes_blog_id;if($('#like-post-wrapper-'+blogId+'-'+attachmentId).length===0){var protocol='http';var originDomain='http://wordpress.com';if(dataCarouselExtra.permalink.length){protocol=dataCarouselExtra.permalink.split(':')[0];if((protocol!=='http')&&(protocol!=='https')){protocol='http';}
var parts=dataCarouselExtra.permalink.split('/');if(parts.length>=2){originDomain=protocol+'://'+parts[2];}}
var dataSource=protocol+'://widgets.wp.com/likes/#blog_id='+encodeURIComponent(blogId)+'&post_id='+encodeURIComponent(attachmentId)+'&slim=1&origin='+encodeURIComponent(originDomain);if('en'!==jetpackCarouselStrings.lang){dataSource+='&lang='+encodeURIComponent(jetpackCarouselStrings.lang);}
var likesWidget=$('<iframe class=\'post-likes-widget jetpack-likes-widget jetpack-resizeable\'></iframe>').attr('name','like-post-frame-'+blogId+'-'+attachmentId).attr('src',dataSource).css('display','inline-block');var likesWidgetWrapper=$('<div/>').addClass('jetpack-likes-widget-wrapper jetpack-likes-widget-unloaded slim-likes-widget').attr('id','like-post-wrapper-'+blogId+'-'+attachmentId).attr('data-src',dataSource).attr('data-name','like-post-frame-'+blogId+'-'+attachmentId).attr('data-attachment-id',attachmentId).css('display','none').css('vertical-align','middle').append(likesWidget).append('<div class=\'post-likes-widget-placeholder\'></div>');$('.jp-carousel-buttons').append(likesWidgetWrapper);}},updateExif:function(meta){if(!meta||1!==Number(jetpackCarouselStrings.display_exif)){return false;}
var $ul=$('<ul class=\'jp-carousel-image-exif\'></ul>');$.each(meta,function(key,val){if(0===parseFloat(val)||!val.length||-1===$.inArray(key,['camera','aperture','shutter_speed','focal_length'])){return;}
switch(key){case'focal_length':val=val+'mm';break;case'shutter_speed':val=gallery.jp_carousel('shutterSpeed',val);break;case'aperture':val='f/'+val;break;}
$ul.append('<li><h5>'+jetpackCarouselStrings[key]+'</h5>'+val+'</li>');});$('div.jp-carousel-image-meta ul.jp-carousel-image-exif').replaceWith($ul);},updateFullSizeLink:function(current){if(!current||!current.data){return false;}
var original=current.data('orig-file').replace(/\?.+$/,''),origSize=current.data('orig-size').split(','),permalink=$('<a>'+gallery.jp_carousel('format',{'text':jetpackCarouselStrings.download_original,'replacements':origSize})+'</a>').addClass('jp-carousel-image-download').attr('href',original).attr('target','_blank');$('div.jp-carousel-image-meta a.jp-carousel-image-download').replaceWith(permalink);},updateMap:function(meta){if(!meta.latitude||!meta.longitude||1!==Number(jetpackCarouselStrings.display_geo)){return;}
var latitude=meta.latitude,longitude=meta.longitude,$metabox=$('div.jp-carousel-image-meta','div.jp-carousel-wrap'),$mapbox=$('<div></div>'),style='&scale=2&style=feature:all|element:all|invert_lightness:true|hue:0x0077FF|saturation:-50|lightness:-5|gamma:0.91';$mapbox.addClass('jp-carousel-image-map').html('<img width="154" height="154" src="https://maps.googleapis.com/maps/api/staticmap?       center='+latitude+','+longitude+'&       zoom=8&       size=154x154&       sensor=false&       markers=size:medium%7Ccolor:blue%7C'+latitude+','+longitude+style+'" class="gmap-main" />             <div class="gmap-topright"><div class="imgclip"><img width="175" height="154" src="https://maps.googleapis.com/maps/api/staticmap?       center='+latitude+','+longitude+'&       zoom=3&       size=175x154&       sensor=false&       markers=size:small%7Ccolor:blue%7C'+latitude+','+longitude+style+'"c /></div></div>             ').prependTo($metabox);},testCommentsOpened:function(opened){if(1===parseInt(opened,10)){$('.jp-carousel-buttons').fadeIn('fast');commentForm.fadeIn('fast');}else{$('.jp-carousel-buttons').fadeOut('fast');commentForm.fadeOut('fast');}},getComments:function(args){clearInterval(commentInterval);if('object'!==typeof args){return;}
if('undefined'===typeof args.attachment_id||!args.attachment_id){return;}
if(!args.offset||'undefined'===typeof args.offset||args.offset<1){args.offset=0;}
var comments=$('.jp-carousel-comments'),commentsLoading=$('#jp-carousel-comments-loading').show();if(args.clear){comments.hide().empty();}
$.ajax({type:'GET',url:jetpackCarouselStrings.ajaxurl,dataType:'json',data:{action:'get_attachment_comments',nonce:jetpackCarouselStrings.nonce,id:args.attachment_id,offset:args.offset},success:function(data){if(args.clear){comments.fadeOut('fast').empty();}
$(data).each(function(){var comment=$('<div></div>').addClass('jp-carousel-comment').attr('id','jp-carousel-comment-'+this['id']).html('<div class="comment-gravatar">'+
this['gravatar_markup']+'</div>'+'<div class="comment-author">'+
this['author_markup']+'</div>'+'<div class="comment-date">'+
this['date_gmt']+'</div>'+'<div class="comment-content">'+
this['content']+'</div>');comments.append(comment);clearInterval(commentInterval);commentInterval=setInterval(function(){if(($('.jp-carousel-overlay').height()-150)<$('.jp-carousel-wrap').scrollTop()+$(window).height()){gallery.jp_carousel('getComments',{attachment_id:args.attachment_id,offset:args.offset+10,clear:false});clearInterval(commentInterval);}},300);});var current=$('.jp-carousel div.selected');if(current&&current.data&&current.data('attachment-id')!=args.attachment_id){comments.fadeOut('fast');comments.empty();return;}
$('.jp-carousel-overlay').height($(window).height()+titleAndDescription.height()+commentForm.height()+((comments.height()>0)?comments.height():imageMeta.height())+200);comments.show();commentsLoading.hide();},error:function(xhr,status,error){console.log('Comment get fail...',xhr,status,error);comments.fadeIn('fast');commentsLoading.fadeOut('fast');}});},postCommentError:function(args){if('object'!==typeof args){args={};}
if(!args.field||'undefined'===typeof args.field||!args.error||'undefined'===typeof args.error){return;}
$('#jp-carousel-comment-post-results').slideUp('fast').html('<span class="jp-carousel-comment-post-error">'+args.error+'</span>').slideDown('fast');$('#jp-carousel-comment-form-spinner').spin(false);},setCommentIframeSrc:function(attachment_id){var iframe=$('#jp-carousel-comment-iframe');if(iframe&&iframe.length){iframe.attr('src',iframe.attr('src').replace(/(postid=)\d+/,'$1'+attachment_id));iframe.attr('src',iframe.attr('src').replace(/(%23.+)?$/,'%23jp-carousel-'+attachment_id));}},clearCommentTextAreaValue:function(){var commentTextArea=$('#jp-carousel-comment-form-comment-field');if(commentTextArea){commentTextArea.val('');}},nextSlide:function(){var slides=this.jp_carousel('slides');var selected=this.jp_carousel('selectedSlide');if(selected.length===0||(slides.length>2&&selected.is(slides.last()))){return slides.first();}
return selected.next();},prevSlide:function(){var slides=this.jp_carousel('slides');var selected=this.jp_carousel('selectedSlide');if(selected.length===0||(slides.length>2&&selected.is(slides.first()))){return slides.last();}
return selected.prev();},loadFullImage:function(slide){var image=slide.find('img:first');if(!image.data('loaded')){image.on('load.jetpack',function(){image.off('load.jetpack');$(this).closest('.jp-carousel-slide').css('background-image','');});if(!slide.data('preview-image')||(slide.data('thumb-size')&&slide.width()>slide.data('thumb-size').width)){image.attr('src',image.closest('.jp-carousel-slide').data('src'));}else{image.attr('src',slide.data('preview-image'));}
image.data('loaded',1);}}};$.fn.jp_carousel=function(method){if(methods[method]){return methods[method].apply(this,Array.prototype.slice.call(arguments,1));}else if(typeof method==='object'||!method){return methods.open.apply(this,arguments);}else{$.error('Method '+method+' does not exist on jQuery.jp_carousel');}};$(document.body).on('click','div.gallery,div.tiled-gallery',function(e){if(!$(this).jp_carousel('testForData',e.currentTarget)){return;}
if($(e.target).parent().hasClass('gallery-caption')){return;}
e.preventDefault();$(this).jp_carousel('open',{start_index:$(this).find('.gallery-item, .tiled-gallery-item').index($(e.target).parents('.gallery-item, .tiled-gallery-item'))});});$(window).on('hashchange',function(){if(!window.location.hash||!window.location.hash.match(/jp-carousel-(\d+)/)){return;}
if(window.location.hash===last_known_location_hash){return;}
last_known_location_hash=window.location.hash;var gallery=$('div.gallery, div.tiled-gallery'),index=-1,n=window.location.hash.match(/jp-carousel-(\d+)/);if(!$(this).jp_carousel('testForData',gallery)){return;}
n=parseInt(n[1],10);gallery.find('img').each(function(num,el){if(n&&Number($(el).data('attachment-id'))===n){index=num;return false;}});if(index!==-1){gallery.jp_carousel('openOrSelectSlide',index);}});if(window.location.hash){$(window).trigger('hashchange');}});(function($){$.fn.touchwipe=function(settings){var config={min_move_x:20,min_move_y:20,wipeLeft:function(){},wipeRight:function(){},wipeUp:function(){},wipeDown:function(){},preventDefaultEvents:true};if(settings){$.extend(config,settings);}
this.each(function(){var startX;var startY;var isMoving=false;function cancelTouch(){this.removeEventListener('touchmove',onTouchMove);startX=null;isMoving=false;}
function onTouchMove(e){if(config.preventDefaultEvents){e.preventDefault();}
if(isMoving){var x=e.touches[0].pageX;var y=e.touches[0].pageY;var dx=startX-x;var dy=startY-y;if(Math.abs(dx)>=config.min_move_x){cancelTouch();if(dx>0){config.wipeLeft(e);}else{config.wipeRight(e);}}
else if(Math.abs(dy)>=config.min_move_y){cancelTouch();if(dy>0){config.wipeDown(e);}else{config.wipeUp(e);}}}}
function onTouchStart(e)
{if(e.touches.length===1){startX=e.touches[0].pageX;startY=e.touches[0].pageY;isMoving=true;this.addEventListener('touchmove',onTouchMove,false);}}
if('ontouchstart'in document.documentElement){this.addEventListener('touchstart',onTouchStart,false);}});return this;};})(jQuery);

} /* end modules/carousel/jetpack-carousel.js */

if ( jpconcat.files['modules/contact-form/js/grunion-frontend.js'] ) {

jQuery(function($){$('.contact-form input[type="date"]').datepicker({dateFormat:'yy-mm-dd'});});

} /* end modules/contact-form/js/grunion-frontend.js */

if ( jpconcat.files['modules/contact-form/js/grunion.js'] ) {

if(!window.FB){window.FB={};}
GrunionFB_i18n=jQuery.extend({nameLabel:'Name',emailLabel:'Email',urlLabel:'Website',commentLabel:'Comment',newLabel:'New Field',optionsLabel:'Options',optionLabel:'Option',firstOptionLabel:'First option',problemGeneratingForm:'Oops, there was a problem generating your form.  You\'ll likely need to try again.',moveInstructions:'Drag up or down\nto re-arrange',moveLabel:'move',editLabel:'edit',savedMessage:'Saved successfully',requiredLabel:'(required)',exitConfirmMessage:'Are you sure you want to exit the form editor without saving?  Any changes you have made will be lost.'},GrunionFB_i18n);GrunionFB_i18n.moveInstructions=GrunionFB_i18n.moveInstructions.replace('\n','<br />');FB.span=jQuery('<span>');FB.esc_html=function(string){return FB.span.text(string).html();};FB.esc_attr=function(string){string=FB.esc_html(string);return string.replace('"','&quot;').replace('\'','&#039;');};FB.ContactForm=(function(){var fbForm={'action':'grunion_shortcode','_ajax_nonce':ajax_nonce_shortcode,'to':'','subject':'','fields':{}};var defaultFields={'name':{'label':GrunionFB_i18n.nameLabel,'type':'name','required':true,'options':[],'order':'1'},'email':{'label':GrunionFB_i18n.emailLabel,'type':'email','required':true,'options':[],'order':'2'},'url':{'label':GrunionFB_i18n.urlLabel,'type':'url','required':false,'options':[],'order':'3'},'comment':{'label':GrunionFB_i18n.commentLabel,'type':'textarea','required':true,'options':[],'order':'4'}};var debug=false;var grunionNewCount=0;var maxNewFields=5;var optionsCache={};var optionsCount=0;var shortcode;function addField(){try{grunionNewCount++;if(grunionNewCount<=maxNewFields){jQuery('#fb-extra-fields').append('<div id="fb-new-field'+grunionNewCount+'" fieldid="'+grunionNewCount+'" class="fb-new-fields"><div class="fb-fields"><div id="'+grunionNewCount+'" class="fb-remove"></div><label fieldid="'+grunionNewCount+'" for="fb-field'+grunionNewCount+'"><span class="label-text">'+GrunionFB_i18n.newLabel+'</span> </label><input type="text" id="fb-field'+grunionNewCount+'" disabled="disabled" /></div></div>');fbForm.fields[grunionNewCount]={'label':GrunionFB_i18n.newLabel,'type':'text','required':false,'options':[],'order':'5'};if(grunionNewCount===maxNewFields){jQuery('#fb-new-field').hide();}
optionsCount=0;optionsCache={};jQuery('#fb-new-options').html('<label for="fb-option0">'+GrunionFB_i18n.optionsLabel+'</label><input type="text" id="fb-option0" optionid="0" value="'+GrunionFB_i18n.firstOptionLabel+'" class="fb-options" />');jQuery('#fb-options').hide();jQuery('#fb-new-label').val(GrunionFB_i18n.newLabel);jQuery('#fb-new-type').val('text');jQuery('#fb-field-id').val(grunionNewCount);setTimeout(function(){jQuery('#fb-new-label').focus().select();},100);}else{jQuery('#fb-new-field').hide();}}catch(e){if(debug){console.log('addField(): '+e);}}}
function addOption(){try{optionsCount=jQuery('#fb-new-options .fb-options').length;var thisId=jQuery('#fb-field-id').val();var thisType=jQuery('#fb-new-type').val();if(thisType==='radio'){jQuery('#fb-new-options').append('<div id="fb-option-box-'+optionsCount+'" class="fb-new-fields"><span optionid="'+optionsCount+'" class="fb-remove-option"></span><label></label><input type="text" id="fb-option'+optionsCount+'" optionid="'+optionsCount+'" value="'+GrunionFB_i18n.optionLabel+'" class="fb-options" /><div>');jQuery('#fb-new-field'+thisId+' .fb-fields').append('<div id="fb-radio-'+thisId+'-'+optionsCount+'"><input type="radio" disabled="disabled" id="fb-field'+thisId+'" name="radio-'+thisId+'" /><span>'+GrunionFB_i18n.optionLabel+'</span><div class="clear"></div></div>');}else{jQuery('#fb-new-options').append('<div id="fb-option-box-'+optionsCount+'" class="fb-new-fields"><span optionid="'+optionsCount+'" class="fb-remove-option"></span><label></label><input type="text" id="fb-option'+optionsCount+'" optionid="'+optionsCount+'" value="" class="fb-options" /><div>');jQuery('#fb-field'+thisId).append('<option id="fb-'+thisId+'-'+optionsCount+'" value="'+thisId+'-'+optionsCount+'"></option>');}
fbForm.fields[thisId].options[optionsCount]='';jQuery('#fb-option'+optionsCount).focus().select();}catch(e){if(debug){console.log('addOption(): '+e);}}}
function buildPreview(){try{if(fbForm.to){jQuery('#fb-field-my-email').val(fbForm.to);}
if(fbForm.subject){jQuery('#fb-field-subject').val(fbForm.subject);}
jQuery.each(fbForm.fields,function(index,value){jQuery('#fb-extra-fields').before('<div class="fb-new-fields ui-state-default" fieldid="'+index+'" id="fb-new-field'+index+'"><div class="fb-fields"></div></div>');jQuery('#fb-field-id').val(index);optionsCache[index]={};optionsCache[index].options=[];if(value.type==='radio'||value.type==='select'){jQuery.each(value.options,function(i,value){optionsCache[index].options[i]=value;});}
updateType(value.type,value.label,value.required);});}catch(e){if(debug){console.log('buildPreview(): '+e);}}}
function customOptions(id,thisType){try{var thisOptions='';for(var i=0;i<optionsCache[id].options.length;i++){if(optionsCache[id].options[i]!==undefined){if(thisType==='radio'){thisOptions=thisOptions+'<div id="fb-radio-'+id+'-'+i+'"><input type="radio" id="fb-field'+id+'" name="radio-'+id+'" /><span>'+FB.esc_html(optionsCache[id].options[i])+'</span><div class="clear"></div></div>';}else{thisOptions=thisOptions+'<option id="fb-'+id+'-'+i+'" value="'+id+'-'+i+'">'+FB.esc_html(optionsCache[id].options[i])+'</option>';}}}
return thisOptions;}catch(e){if(debug){console.log('customOptions(): '+e);}}}
function deleteField(that){try{grunionNewCount--;var thisId=that.attr('id');delete fbForm.fields[thisId];jQuery('#'+thisId).parent().parent().remove();if(grunionNewCount<=maxNewFields){jQuery('#fb-new-field').show();}}catch(e){if(debug){console.log('deleteField(): '+e);}}}
function editField(that){try{scroll(0,0);setTimeout(function(){jQuery('#fb-new-label').focus().select();},100);var thisId=that.parent().attr('fieldid');loadFieldEditor(thisId);}catch(e){if(debug){console.log('editField(): '+e);}}}
function grabShortcode(){try{jQuery.post(ajaxurl,fbForm,function(response){shortcode=response;});}catch(e){alert(GrunionFB_i18n.problemGeneratingForm);if(debug){console.log('grabShortcode(): '+e);}}}
function hideDesc(){jQuery('#fb-desc').hide();jQuery('#fb-add-field').show();}
function hidePopup(){try{jQuery('#TB_imageOff',window.parent.document).unbind('click');jQuery('#TB_closeWindowButton',window.parent.document).unbind('click');jQuery('#TB_window',window.parent.document).fadeOut('fast');jQuery('#TB_window,#TB_overlay,#TB_HideSelect',window.parent.document).trigger('unload').unbind().remove();jQuery('#TB_load',window.parent.document).remove();if(typeof window.parent.document.body.style.maxHeight==='undefined'){jQuery('body','html',window.parent.document).css({height:'auto',width:'auto'});jQuery('html',window.parent.document).css('overflow','');}
window.parent.document.onkeydown='';window.parent.document.onkeyup='';return false;}catch(e){if(debug){console.log('hidePopup(): '+e);}}}
function hideShowEditLink(whichType,that){try{if(whichType==='show'){if(jQuery('.fb-edit-field').is(':visible')){jQuery('.fb-edit-field').remove();}
that.find('label').prepend('<span class="right fb-edit-field" style="font-weight: normal;"><a href="" class="fb-reorder"><div style="display: none;">'+GrunionFB_i18n.moveInstructions+'</div>'+GrunionFB_i18n.moveLabel+'</a>&nbsp;&nbsp;<span style="color: #C7D8DE;">|</span>&nbsp;&nbsp;<a href="" class="fb-edit">'+GrunionFB_i18n.editLabel+'</a></span>');}else{jQuery('.fb-edit-field').remove();}}catch(e){if(debug){console.log('hideShowEditLink(): '+e);}}}
function loadFieldEditor(id){try{var thisType=fbForm.fields[id].type;jQuery('#fb-options').hide();jQuery('#fb-field-id').val(id);jQuery('#fb-new-label').val(fbForm.fields[id].label);jQuery('#fb-new-type').val(fbForm.fields[id].type);if(fbForm.fields[id].required){jQuery('#fb-new-required').prop('checked',true);}else{jQuery('#fb-new-required').prop('checked',false);}
if(thisType==='select'||thisType==='radio'){var thisOptions=fbForm.fields[id].options;jQuery('#fb-options').show();jQuery('#fb-new-options').html('');for(var i=0;i<thisOptions.length;i++){if(thisOptions[i]!==undefined){if(thisType==='radio'){jQuery('#fb-new-options').append('<div id="fb-option-box-'+i+'" class="fb-new-fields"><span optionid="'+i+'" class="fb-remove-option"></span><label></label><input type="text" id="fb-option'+i+'" optionid="'+i+'" value="'+FB.esc_attr(fbForm.fields[id].options[i])+'" class="fb-options" /><div>');}else{jQuery('#fb-new-options').append('<div id="fb-option-box-'+i+'" class="fb-new-fields"><span optionid="'+i+'" class="fb-remove-option"></span><label></label><input type="text" id="fb-option'+i+'" optionid="'+i+'" value="'+FB.esc_attr(fbForm.fields[id].options[i])+'" class="fb-options" /><div>');}}}}
hideDesc();}catch(e){if(debug){console.log('loadFieldEditor(): '+e);}}}
function parseShortcode(data){try{fbForm.fields={};if(!data){fbForm.fields=defaultFields;}else{jQuery.each(data.fields,function(index,value){if(1===parseInt(value.required,10)){value.required='true';}
fbForm.fields[index]=value;});fbForm.to=data.to;fbForm.subject=data.subject;}}catch(e){if(debug){console.log('parseShortcode(): '+e);}}}
function removeOption(optionId){try{var thisId=jQuery('#fb-field-id').val();var thisVal=jQuery('#fb-option'+optionId).val();var thisType=jQuery('#fb-new-type').val();jQuery('#fb-option-box-'+optionId).remove();if(thisType==='radio'){jQuery('#fb-radio-'+thisId+'-'+optionId).remove();}else{jQuery('#fb-'+thisId+'-'+optionId).remove();}
var idx=fbForm.fields[thisId].options.indexOf(thisVal);if(idx!==-1){fbForm.fields[thisId].options.splice(idx,1);}}catch(e){if(debug){console.log('removeOption(): '+e);}}}
function removeOptions(){try{var thisId=jQuery('#fb-field-id').val();jQuery('#fb-options').hide();if(optionsCache[thisId]===undefined){optionsCache[thisId]={};}
optionsCache[thisId].options=fbForm.fields[thisId].options;fbForm.fields[thisId].options=[];}catch(e){if(debug){console.log('removeOptions(): '+e);}}}
function sendShortcodeToEditor(){try{jQuery('div#sortable div.fb-new-fields').each(function(index){var thisId=jQuery(this).attr('fieldid');fbForm.fields[thisId].order=index;});jQuery.post(ajaxurl,fbForm,function(response){var isVisual=jQuery('#edButtonPreview',window.parent.document).hasClass('active');if(!isVisual){isVisual=jQuery('#wp-content-wrap',window.parent.document).hasClass('tmce-active');}
var win=window.dialogArguments||opener||parent||top;var currentCode;if(isVisual){currentCode=win.tinyMCE.activeEditor.getContent();}else{currentCode=jQuery('#editorcontainer textarea',window.parent.document).val();if(typeof currentCode!=='string'){currentCode=jQuery('.wp-editor-area',window.parent.document).val();}}
var regexp=new RegExp('\\[contact-form\\b.*?\\/?\\](?:[\\s\\S]+?\\[\\/contact-form\\])?');response=response.replace(/\n/g,' ');if(currentCode.match(regexp)){if(isVisual){win.tinyMCE.activeEditor.execCommand('mceSetContent',false,currentCode.replace(regexp,response));}else{jQuery('#content',window.parent.document).val(currentCode.replace(regexp,response));}}else{try{win.send_to_editor(response);}catch(e){if(isVisual){win.tinyMCE.activeEditor.execCommand('mceInsertContent',false,response);}else{jQuery('#content',window.parent.document).val(currentCode+response);}}}
hidePopup();});}catch(e){if(debug){console.log('sendShortcodeToEditor(): '+e);}}}
function showDesc(){jQuery('#fb-desc').show();jQuery('#fb-add-field').hide();}
function showAndHideMessage(message){try{var newMessage=(!message)?GrunionFB_i18n.savedMessage:message;jQuery('#fb-success').text(newMessage);jQuery('#fb-success').slideDown('fast');setTimeout(function(){jQuery('#fb-success').slideUp('fast');},2500);}catch(e){if(debug){console.log('showAndHideMessage(): '+e);}}}
function switchTabs(whichType){try{if(whichType==='preview'){jQuery('#tab-preview a').addClass('current');jQuery('#tab-settings a').removeClass('current');jQuery('#fb-preview-form, #fb-desc').show();jQuery('#fb-email-settings, #fb-email-desc').hide();}else{jQuery('#tab-preview a').removeClass('current');jQuery('#tab-settings a').addClass('current');jQuery('#fb-preview-form, #fb-desc, #fb-add-field').hide();jQuery('#fb-email-settings, #fb-email-desc').show();jQuery('#fb-field-my-email').focus().select();}}catch(e){if(debug){console.log('switchTabs(): '+e);}}}
function updateLabel(){try{var thisId=jQuery('#fb-field-id').val();var thisLabel=jQuery('#fb-new-label').val();if(thisLabel.length===0){jQuery('#fb-new-field'+thisId+' label .label-text').text(GrunionFB_i18n.newLabel);}else{jQuery('#fb-new-field'+thisId+' label .label-text').text(thisLabel);}
fbForm.fields[thisId].label=thisLabel;}catch(e){if(debug){console.log('updateLabel(): '+e);}}}
function updateMyEmail(){try{var thisEmail=jQuery('#fb-field-my-email').val();fbForm.to=thisEmail;}catch(e){if(debug){console.log('updateMyEmail(): '+e);}}}
function updateOption(that){try{var thisId=jQuery('#fb-field-id').val();var thisOptionid=that.attr('optionid');var thisOptionValue=that.val();var thisType=jQuery('#fb-new-type').val();if(thisType==='radio'){jQuery('#fb-radio-'+thisId+'-'+thisOptionid+' span').text(thisOptionValue);}else{jQuery('#fb-'+thisId+'-'+thisOptionid).text(thisOptionValue);}
fbForm.fields[thisId].options[thisOptionid]=thisOptionValue;}catch(e){if(debug){console.log('updateOption(): '+e);}}}
function updateRequired(){try{var thisId=jQuery('#fb-field-id').val();var thisChecked=jQuery('#fb-new-required').is(':checked');if(thisChecked){fbForm.fields[thisId].required=true;jQuery('#fb-new-field'+thisId+' label').append('<span class="label-required">'+GrunionFB_i18n.requiredLabel+'</span>');}else{fbForm.fields[thisId].required=false;jQuery('#fb-new-field'+thisId+' label .label-required').remove();}}catch(e){if(debug){console.log('updateRequired(): '+e);}}}
function updateSubject(){try{var thisSubject=jQuery('#fb-field-subject').val();fbForm.subject=thisSubject;}catch(e){if(debug){console.log('updateSubject(): '+e);}}}
function updateType(thisType,thisLabelText,thisRequired){try{var thisId=jQuery('#fb-field-id').val();if(!thisType){thisType=jQuery('#fb-new-type').val();}
if(!thisLabelText){thisLabelText=jQuery('#fb-new-field'+thisId+' .label-text').text();}
var isRequired=(thisRequired)?'<span class="label-required">'+GrunionFB_i18n.requiredLabel+'</span>':'';var thisLabel='<label fieldid="'+thisId+'" for="fb-field'+thisId+'"><span class="label-text">'+FB.esc_html(thisLabelText)+'</span>'+isRequired+'</label>';var thisRadio='<input type="radio" name="radio-'+thisId+'" id="fb-field'+thisId+' "disabled="disabled" />';var thisRadioLabel='<label fieldid="'+thisId+'" for="fb-field'+thisId+'" class="fb-radio-label"><span class="label-text">'+FB.esc_html(thisLabelText)+'</span>'+isRequired+'</label>';var thisRadioRemove='<div class="fb-remove fb-remove-small" id="'+thisId+'"></div>';var thisRemove='<div class="fb-remove" id="'+thisId+'"></div>';var thisCheckbox='<input type="checkbox" id="fb-field'+thisId+'" "disabled="disabled" />';var thisText='<input type="text" id="fb-field'+thisId+'" "disabled="disabled" />';var thisTextarea='<textarea id="fb-field'+thisId+'" "disabled="disabled"></textarea>';var thisClear='<div class="clear"></div>';var thisSelect='<select id="fb-field'+thisId+'" fieldid="'+thisId+'"><option id="fb-'+thisId+'-'+optionsCount+'" value="'+thisId+'-'+optionsCount+'">'+GrunionFB_i18n.firstOptionLabel+'</option></select>';switch(thisType){case'checkbox':removeOptions();jQuery('#fb-new-field'+thisId+' .fb-fields').html(thisRadioRemove+thisCheckbox+thisRadioLabel+thisClear);break;case'email':removeOptions();jQuery('#fb-new-field'+thisId+' .fb-fields').html(thisRemove+thisLabel+thisText);break;case'name':removeOptions();jQuery('#fb-new-field'+thisId+' .fb-fields').html(thisRemove+thisLabel+thisText);break;case'radio':jQuery('#fb-new-field'+thisId+' .fb-fields').html(thisLabel+thisRadioRemove+'<div fieldid="'+thisId+'" id="fb-custom-radio'+thisId+'"></div>');if(optionsCache[thisId]!==undefined&&optionsCache[thisId].options.length!==0){fbForm.fields[thisId].options=optionsCache[thisId].options;jQuery('#fb-custom-radio'+thisId).append(customOptions(thisId,thisType));}else{jQuery('#fb-new-options').html('<label for="fb-option0">'+GrunionFB_i18n.optionsLabel+'</label><input type="text" id="fb-option0" optionid="0" value="'+GrunionFB_i18n.firstOptionLabel+'" class="fb-options" />');jQuery('#fb-custom-radio'+thisId).append('<div id="fb-radio-'+thisId+'-0">'+thisRadio+'<span>'+GrunionFB_i18n.firstOptionLabel+'</span>'+thisClear+'</div>');fbForm.fields[thisId].options[optionsCount]=GrunionFB_i18n.firstOptionLabel;}
jQuery('#fb-options').show();setTimeout(function(){jQuery('#fb-option0').focus().select();},100);break;case'select':jQuery('#fb-new-field'+thisId+' .fb-fields').html(thisRemove+thisLabel+thisSelect);if(optionsCache[thisId]!==undefined&&optionsCache[thisId].options.length!==0){fbForm.fields[thisId].options=optionsCache[thisId].options;jQuery('#fb-field'+thisId).html(customOptions(thisId,thisType));}else{jQuery('#fb-new-options').html('<label for="fb-option0">'+GrunionFB_i18n.optionsLabel+'</label><input type="text" id="fb-option0" optionid="0" value="'+GrunionFB_i18n.firstOptionLabel+'" class="fb-options" />');fbForm.fields[thisId].options[optionsCount]=GrunionFB_i18n.firstOptionLabel;}
jQuery('#fb-options').show();setTimeout(function(){jQuery('#fb-option0').focus().select();},100);break;case'text':removeOptions();jQuery('#fb-new-field'+thisId+' .fb-fields').html(thisRemove+thisLabel+thisText);break;case'textarea':removeOptions();jQuery('#fb-new-field'+thisId+' .fb-fields').html(thisRemove+thisLabel+thisTextarea);break;case'url':removeOptions();jQuery('#fb-new-field'+thisId+' .fb-fields').html(thisRemove+thisLabel+thisText);break;}
fbForm.fields[thisId].type=thisType;}catch(e){if(debug){console.log('updateType(): '+e);}}}
return{resizePop:function(){try{var totalWidth=jQuery('body',window.parent.document).width();var totalHeight=jQuery('body',window.parent.document).height();var isIE6=typeof document.body.style.maxHeight==='undefined';jQuery('#TB_window, #TB_iframeContent',window.parent.document).css('width','768px');jQuery('#TB_window',window.parent.document).css({left:(totalWidth-768)/2+'px',top:'23px',position:'absolute',marginLeft:'0'});if(!isIE6){jQuery('#TB_window, #TB_iframeContent',window.parent.document).css('height',(totalHeight-73)+'px');}}catch(e){if(debug){console.log('resizePop(): '+e);}}},init:function(){window.parent.scroll(0,0);var contentSource;if(jQuery('#edButtonPreview',window.parent.document).hasClass('active')||jQuery('#wp-content-wrap',window.parent.document).hasClass('tmce-active')){var win=window.dialogArguments||opener||parent||top;contentSource=win.tinyMCE.activeEditor.getContent();}else{contentSource=jQuery('#content',window.parent.document).val();}
var data={action:'grunion_shortcode_to_json','_ajax_nonce':ajax_nonce_json,post_id:postId,content:contentSource};var $doc=jQuery(document);jQuery.post(ajaxurl,data,function(response){parseShortcode(jQuery.parseJSON(response));buildPreview();});jQuery('.fb-add-field').click(function(){addField();hideDesc();return false;});jQuery('#fb-new-label').keyup(function(){updateLabel();});jQuery('#fb-new-type').change(function(){updateType();});jQuery('#fb-new-required').click(function(){updateRequired();});$doc.on('click','.fb-remove',function(){showDesc();deleteField(jQuery(this));grabShortcode();});jQuery('#fb-preview').submit(function(){sendShortcodeToEditor();return false;});jQuery('#TB_overlay, #TB_closeWindowButton',window.parent.document).mousedown(function(){if(confirm(GrunionFB_i18n.exitConfirmMessage)){hidePopup();}});$doc.on('click','#fb-another-option',function(){addOption();});$doc.on('keyup','.fb-options',function(){updateOption(jQuery(this));});$doc.on('click','.fb-remove-option',function(){removeOption(jQuery(this).attr('optionid'));});jQuery('#tab-preview a').click(function(){switchTabs('preview');return false;});jQuery('#fb-prev-form').click(function(){switchTabs('preview');showAndHideMessage(GrunionFB_i18n.savedMessage);return false;});jQuery('#tab-settings a').click(function(){switchTabs();return false;});jQuery('#fb-field-my-email').blur(function(){updateMyEmail();});jQuery('#fb-field-subject').blur(function(){updateSubject();});$doc.on('mouseenter','.fb-form-case .fb-new-fields',function(){hideShowEditLink('show',jQuery(this));});$doc.on('mouseleave','.fb-form-case .fb-new-fields',function(){hideShowEditLink('hide');return false;});$doc.on('click','.fb-edit-field',function(){editField(jQuery(this));return false;});$doc.on('click','.fb-edit-field .fb-reorder',function(){return false;});$doc.on('click','#fb-save-field',function(){showDesc();showAndHideMessage();return false;});jQuery('#fb-feedback').click(function(){var thisHref=jQuery(this).attr('href');window.parent.location=thisHref;return false;});jQuery('#sortable').sortable({axis:'y',handle:'.fb-reorder',revert:true,start:function(){jQuery('.fb-edit-field').hide();}});jQuery('#draggable').draggable({axis:'y',handle:'.fb-reorder',connectToSortable:'#sortable',helper:'clone',revert:'invalid'});}};})();

} /* end modules/contact-form/js/grunion.js */

if ( jpconcat.files['modules/custom-css/custom-css/js/codemirror.min.js'] ) {

window.CodeMirror=function(){"use strict";function x(a,c){if(!(this instanceof x))return new x(a,c);this.options=c=c||{};for(var d in _c)!c.hasOwnProperty(d)&&_c.hasOwnProperty(d)&&(c[d]=_c[d]);J(c);var e="string"==typeof c.value?0:c.value.first,f=this.display=y(a,e);f.wrapper.CodeMirror=this,G(this),c.autofocus&&!p&&Nb(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,focused:!1,suppressEdits:!1,pasteIncoming:!1,draggingText:!1,highlight:new Xe},E(this),c.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap");var g=c.value;"string"==typeof g&&(g=new ge(c.value,c.mode)),Fb(this,ke)(this,g),b&&setTimeout(ff(Mb,this,!0),20),Pb(this);var h;try{h=document.activeElement==f.input}catch(i){}h||c.autofocus&&!p?setTimeout(ff(mc,this),20):nc(this),Fb(this,function(){for(var a in $c)$c.propertyIsEnumerable(a)&&$c[a](this,c[a],bd);for(var b=0;b<fd.length;++b)fd[b](this)})()}function y(a,b){var d={},e=d.input=lf("textarea",null,null,"position: absolute; padding: 0; width: 1px; height: 1em; outline: none; font-size: 4px;");return f?e.style.width="1000px":e.setAttribute("wrap","off"),o&&(e.style.border="1px solid black"),e.setAttribute("autocorrect","off"),e.setAttribute("autocapitalize","off"),e.setAttribute("spellcheck","false"),d.inputDiv=lf("div",[e],null,"overflow: hidden; position: relative; width: 3px; height: 0px;"),d.scrollbarH=lf("div",[lf("div",null,null,"height: 1px")],"CodeMirror-hscrollbar"),d.scrollbarV=lf("div",[lf("div",null,null,"width: 1px")],"CodeMirror-vscrollbar"),d.scrollbarFiller=lf("div",null,"CodeMirror-scrollbar-filler"),d.gutterFiller=lf("div",null,"CodeMirror-gutter-filler"),d.lineDiv=lf("div",null,"CodeMirror-code"),d.selectionDiv=lf("div",null,null,"position: relative; z-index: 1"),d.cursor=lf("div","\xa0","CodeMirror-cursor"),d.otherCursor=lf("div","\xa0","CodeMirror-cursor CodeMirror-secondarycursor"),d.measure=lf("div",null,"CodeMirror-measure"),d.lineSpace=lf("div",[d.measure,d.selectionDiv,d.lineDiv,d.cursor,d.otherCursor],null,"position: relative; outline: none"),d.mover=lf("div",[lf("div",[d.lineSpace],"CodeMirror-lines")],null,"position: relative"),d.sizer=lf("div",[d.mover],"CodeMirror-sizer"),d.heightForcer=lf("div",null,null,"position: absolute; height: "+Ve+"px; width: 1px;"),d.gutters=lf("div",null,"CodeMirror-gutters"),d.lineGutter=null,d.scroller=lf("div",[d.sizer,d.heightForcer,d.gutters],"CodeMirror-scroll"),d.scroller.setAttribute("tabIndex","-1"),d.wrapper=lf("div",[d.inputDiv,d.scrollbarH,d.scrollbarV,d.scrollbarFiller,d.gutterFiller,d.scroller],"CodeMirror"),c&&(d.gutters.style.zIndex=-1,d.scroller.style.paddingRight=0),a.appendChild?a.appendChild(d.wrapper):a(d.wrapper),o&&(e.style.width="0px"),f||(d.scroller.draggable=!0),k?(d.inputDiv.style.height="1px",d.inputDiv.style.position="absolute"):c&&(d.scrollbarH.style.minWidth=d.scrollbarV.style.minWidth="18px"),d.viewOffset=d.lastSizeC=0,d.showingFrom=d.showingTo=b,d.lineNumWidth=d.lineNumInnerWidth=d.lineNumChars=null,d.prevInput="",d.alignWidgets=!1,d.pollingFast=!1,d.poll=new Xe,d.cachedCharWidth=d.cachedTextHeight=null,d.measureLineCache=[],d.measureLineCachePos=0,d.inaccurateSelection=!1,d.maxLine=null,d.maxLineLength=0,d.maxLineChanged=!1,d.wheelDX=d.wheelDY=d.wheelStartX=d.wheelStartY=null,d}function z(a){a.doc.mode=x.getMode(a.options,a.doc.modeOption),a.doc.iter(function(a){a.stateAfter&&(a.stateAfter=null),a.styles&&(a.styles=null)}),a.doc.frontier=a.doc.first,bb(a,100),a.state.modeGen++,a.curOp&&Ib(a)}function A(a){a.options.lineWrapping?(a.display.wrapper.className+=" CodeMirror-wrap",a.display.sizer.style.minWidth=""):(a.display.wrapper.className=a.display.wrapper.className.replace(" CodeMirror-wrap",""),I(a)),C(a),Ib(a),pb(a),setTimeout(function(){K(a)},100)}function B(a){var b=Ab(a.display),c=a.options.lineWrapping,d=c&&Math.max(5,a.display.scroller.clientWidth/Bb(a.display)-3);return function(e){return Gd(a.doc,e)?0:c?(Math.ceil(e.text.length/d)||1)*b:b}}function C(a){var b=a.doc,c=B(a);b.iter(function(a){var b=c(a);b!=a.height&&oe(a,b)})}function D(a){var b=kd[a.options.keyMap],c=b.style;a.display.wrapper.className=a.display.wrapper.className.replace(/\s*cm-keymap-\S+/g,"")+(c?" cm-keymap-"+c:""),a.state.disableInput=b.disableInput}function E(a){a.display.wrapper.className=a.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+a.options.theme.replace(/(^|\s)\s*/g," cm-s-"),pb(a)}function F(a){G(a),Ib(a),setTimeout(function(){M(a)},20)}function G(a){var b=a.display.gutters,c=a.options.gutters;mf(b);for(var d=0;d<c.length;++d){var e=c[d],f=b.appendChild(lf("div",null,"CodeMirror-gutter "+e));"CodeMirror-linenumbers"==e&&(a.display.lineGutter=f,f.style.width=(a.display.lineNumWidth||1)+"px")}b.style.display=d?"":"none"}function H(a,b){if(0==b.height)return 0;for(var d,c=b.text.length,e=b;d=Dd(e);){var f=d.find();e=le(a,f.from.line),c+=f.from.ch-f.to.ch}for(e=b;d=Ed(e);){var f=d.find();c-=e.text.length-f.from.ch,e=le(a,f.to.line),c+=e.text.length-f.to.ch}return c}function I(a){var b=a.display,c=a.doc;b.maxLine=le(c,c.first),b.maxLineLength=H(c,b.maxLine),b.maxLineChanged=!0,c.iter(function(a){var d=H(c,a);d>b.maxLineLength&&(b.maxLineLength=d,b.maxLine=a)})}function J(a){var b=bf(a.gutters,"CodeMirror-linenumbers");-1==b&&a.lineNumbers?a.gutters=a.gutters.concat(["CodeMirror-linenumbers"]):b>-1&&!a.lineNumbers&&(a.gutters=a.gutters.slice(0),a.gutters.splice(b,1))}function K(a){var b=a.display,c=a.doc.height,d=c+gb(b);b.sizer.style.minHeight=b.heightForcer.style.top=d+"px",b.gutters.style.height=Math.max(d,b.scroller.clientHeight-Ve)+"px";var e=Math.max(d,b.scroller.scrollHeight),f=b.scroller.scrollWidth>b.scroller.clientWidth+1,g=e>b.scroller.clientHeight+1;g?(b.scrollbarV.style.display="block",b.scrollbarV.style.bottom=f?tf(b.measure)+"px":"0",b.scrollbarV.firstChild.style.height=e-b.scroller.clientHeight+b.scrollbarV.clientHeight+"px"):(b.scrollbarV.style.display="",b.scrollbarV.firstChild.style.height="0"),f?(b.scrollbarH.style.display="block",b.scrollbarH.style.right=g?tf(b.measure)+"px":"0",b.scrollbarH.firstChild.style.width=b.scroller.scrollWidth-b.scroller.clientWidth+b.scrollbarH.clientWidth+"px"):(b.scrollbarH.style.display="",b.scrollbarH.firstChild.style.width="0"),f&&g?(b.scrollbarFiller.style.display="block",b.scrollbarFiller.style.height=b.scrollbarFiller.style.width=tf(b.measure)+"px"):b.scrollbarFiller.style.display="",f&&a.options.coverGutterNextToScrollbar&&a.options.fixedGutter?(b.gutterFiller.style.display="block",b.gutterFiller.style.height=tf(b.measure)+"px",b.gutterFiller.style.width=b.gutters.offsetWidth+"px"):b.gutterFiller.style.display="",l&&0===tf(b.measure)&&(b.scrollbarV.style.minWidth=b.scrollbarH.style.minHeight=m?"18px":"12px",b.scrollbarV.style.pointerEvents=b.scrollbarH.style.pointerEvents="none")}function L(a,b,c){var d=a.scroller.scrollTop,e=a.wrapper.clientHeight;"number"==typeof c?d=c:c&&(d=c.top,e=c.bottom-c.top),d=Math.floor(d-fb(a));var f=Math.ceil(d+e);return{from:qe(b,d),to:qe(b,f)}}function M(a){var b=a.display;if(b.alignWidgets||b.gutters.firstChild&&a.options.fixedGutter){for(var c=P(b)-b.scroller.scrollLeft+a.doc.scrollLeft,d=b.gutters.offsetWidth,e=c+"px",f=b.lineDiv.firstChild;f;f=f.nextSibling)if(f.alignable)for(var g=0,h=f.alignable;g<h.length;++g)h[g].style.left=e;a.options.fixedGutter&&(b.gutters.style.left=c+d+"px")}}function N(a){if(!a.options.lineNumbers)return!1;var b=a.doc,c=O(a.options,b.first+b.size-1),d=a.display;if(c.length!=d.lineNumChars){var e=d.measure.appendChild(lf("div",[lf("div",c)],"CodeMirror-linenumber CodeMirror-gutter-elt")),f=e.firstChild.offsetWidth,g=e.offsetWidth-f;return d.lineGutter.style.width="",d.lineNumInnerWidth=Math.max(f,d.lineGutter.offsetWidth-g),d.lineNumWidth=d.lineNumInnerWidth+g,d.lineNumChars=d.lineNumInnerWidth?c.length:-1,d.lineGutter.style.width=d.lineNumWidth+"px",!0}return!1}function O(a,b){return String(a.lineNumberFormatter(b+a.firstLineNumber))}function P(a){return pf(a.scroller).left-pf(a.sizer).left}function Q(a,b,c,d){for(var g,e=a.display.showingFrom,f=a.display.showingTo,h=L(a.display,a.doc,c),i=!0;;i=!1){var j=a.display.scroller.clientWidth;if(!R(a,b,h,d))break;if(g=!0,b=[],Z(a),K(a),i&&a.options.lineWrapping&&j!=a.display.scroller.clientWidth)d=!0;else if(d=!1,c&&(c=Math.min(a.display.scroller.scrollHeight-a.display.scroller.clientHeight,"number"==typeof c?c:c.top)),h=L(a.display,a.doc,c),h.from>=a.display.showingFrom&&h.to<=a.display.showingTo)break}return g&&(Qe(a,"update",a),(a.display.showingFrom!=e||a.display.showingTo!=f)&&Qe(a,"viewportChange",a,a.display.showingFrom,a.display.showingTo)),g}function R(a,b,c,d){var e=a.display,f=a.doc;if(!e.wrapper.clientWidth)return e.showingFrom=e.showingTo=f.first,e.viewOffset=0,void 0;if(!(!d&&0==b.length&&c.from>e.showingFrom&&c.to<e.showingTo)){N(a)&&(b=[{from:f.first,to:f.first+f.size}]);var g=e.sizer.style.marginLeft=e.gutters.offsetWidth+"px";e.scrollbarH.style.left=a.options.fixedGutter?g:"0";var h=1/0;if(a.options.lineNumbers)for(var i=0;i<b.length;++i)b[i].diff&&b[i].from<h&&(h=b[i].from);var j=f.first+f.size,k=Math.max(c.from-a.options.viewportMargin,f.first),l=Math.min(j,c.to+a.options.viewportMargin);if(e.showingFrom<k&&k-e.showingFrom<20&&(k=Math.max(f.first,e.showingFrom)),e.showingTo>l&&e.showingTo-l<20&&(l=Math.min(j,e.showingTo)),w)for(k=pe(Fd(f,le(f,k)));j>l&&Gd(f,le(f,l));)++l;var m=[{from:Math.max(e.showingFrom,f.first),to:Math.min(e.showingTo,j)}];if(m=m[0].from>=m[0].to?[]:U(m,b),w)for(var i=0;i<m.length;++i)for(var o,n=m[i];o=Ed(le(f,n.to-1));){var p=o.find().from.line;if(!(p>n.from)){m.splice(i--,1);break}n.to=p}for(var q=0,i=0;i<m.length;++i){var n=m[i];n.from<k&&(n.from=k),n.to>l&&(n.to=l),n.from>=n.to?m.splice(i--,1):q+=n.to-n.from}if(!d&&q==l-k&&k==e.showingFrom&&l==e.showingTo)return T(a),void 0;m.sort(function(a,b){return a.from-b.from});try{var r=document.activeElement}catch(s){}.7*(l-k)>q&&(e.lineDiv.style.display="none"),W(a,k,l,m,h),e.lineDiv.style.display="",r&&document.activeElement!=r&&r.offsetHeight&&r.focus();var t=k!=e.showingFrom||l!=e.showingTo||e.lastSizeC!=e.wrapper.clientHeight;return t&&(e.lastSizeC=e.wrapper.clientHeight,bb(a,400)),e.showingFrom=k,e.showingTo=l,S(a),T(a),!0}}function S(a){for(var f,b=a.display,d=b.lineDiv.offsetTop,e=b.lineDiv.firstChild;e;e=e.nextSibling)if(e.lineObj){if(c){var g=e.offsetTop+e.offsetHeight;f=g-d,d=g}else{var h=pf(e);f=h.bottom-h.top}var i=e.lineObj.height-f;if(2>f&&(f=Ab(b)),i>.001||-.001>i){oe(e.lineObj,f);var j=e.lineObj.widgets;if(j)for(var k=0;k<j.length;++k)j[k].height=j[k].node.offsetHeight}}}function T(a){var b=a.display.viewOffset=re(a,le(a.doc,a.display.showingFrom));a.display.mover.style.top=b+"px"}function U(a,b){for(var c=0,d=b.length||0;d>c;++c){for(var e=b[c],f=[],g=e.diff||0,h=0,i=a.length;i>h;++h){var j=a[h];e.to<=j.from&&e.diff?f.push({from:j.from+g,to:j.to+g}):e.to<=j.from||e.from>=j.to?f.push(j):(e.from>j.from&&f.push({from:j.from,to:e.from}),e.to<j.to&&f.push({from:e.to+g,to:j.to+g}))}a=f}return a}function V(a){for(var b=a.display,c={},d={},e=b.gutters.firstChild,f=0;e;e=e.nextSibling,++f)c[a.options.gutters[f]]=e.offsetLeft,d[a.options.gutters[f]]=e.offsetWidth;return{fixedPos:P(b),gutterTotalWidth:b.gutters.offsetWidth,gutterLeft:c,gutterWidth:d,wrapperWidth:b.wrapper.clientWidth}}function W(a,b,c,d,e){function l(b){var c=b.nextSibling;return f&&q&&a.display.currentWheelTarget==b?(b.style.display="none",b.lineObj=null):b.parentNode.removeChild(b),c}var g=V(a),h=a.display,i=a.options.lineNumbers;d.length||f&&a.display.currentWheelTarget||mf(h.lineDiv);var j=h.lineDiv,k=j.firstChild,m=d.shift(),n=b;for(a.doc.iter(b,c,function(b){if(m&&m.to==n&&(m=d.shift()),Gd(a.doc,b)){if(0!=b.height&&oe(b,0),b.widgets&&k&&k.previousSibling)for(var c=0;c<b.widgets.length;++c){var f=b.widgets[c];if(f.showIfHidden){var h=k.previousSibling;if(/pre/i.test(h.nodeName)){var o=lf("div",null,null,"position: relative");h.parentNode.replaceChild(o,h),o.appendChild(h),h=o}var p=h.appendChild(lf("div",[f.node],"CodeMirror-linewidget"));f.handleMouseEvents||(p.ignoreEvents=!0),Y(f,p,h,g)}}}else if(m&&m.from<=n&&m.to>n){for(;k.lineObj!=b;)k=l(k);i&&n>=e&&k.lineNumber&&of(k.lineNumber,O(a.options,n)),k=k.nextSibling}else{if(b.widgets)for(var s,q=0,r=k;r&&20>q;++q,r=r.nextSibling)if(r.lineObj==b&&/div/i.test(r.nodeName)){s=r;break}var t=X(a,b,n,g,s);if(t!=s)j.insertBefore(t,k);else{for(;k!=s;)k=l(k);k=k.nextSibling}t.lineObj=b}++n});k;)k=l(k)}function X(a,b,d,e,f){var k,g=Xd(a,b),h=g.pre,i=b.gutterMarkers,j=a.display,l=g.bgClass?g.bgClass+" "+(b.bgClass||""):b.bgClass;if(!(a.options.lineNumbers||i||l||b.wrapClass||b.widgets))return h;if(f){f.alignable=null;for(var q,m=!0,n=0,o=null,p=f.firstChild;p;p=q)if(q=p.nextSibling,/\bCodeMirror-linewidget\b/.test(p.className)){for(var r=0;r<b.widgets.length;++r){var s=b.widgets[r];if(s.node==p.firstChild){s.above||o||(o=p),Y(s,p,f,e),++n;break}}if(r==b.widgets.length){m=!1;break}}else f.removeChild(p);f.insertBefore(h,o),m&&n==b.widgets.length&&(k=f,f.className=b.wrapClass||"")}if(k||(k=lf("div",null,b.wrapClass,"position: relative"),k.appendChild(h)),l&&k.insertBefore(lf("div",null,l+" CodeMirror-linebackground"),k.firstChild),a.options.lineNumbers||i){var t=k.insertBefore(lf("div",null,null,"position: absolute; left: "+(a.options.fixedGutter?e.fixedPos:-e.gutterTotalWidth)+"px"),k.firstChild);if(a.options.fixedGutter&&(k.alignable||(k.alignable=[])).push(t),!a.options.lineNumbers||i&&i["CodeMirror-linenumbers"]||(k.lineNumber=t.appendChild(lf("div",O(a.options,d),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+e.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+j.lineNumInnerWidth+"px"))),i)for(var u=0;u<a.options.gutters.length;++u){var v=a.options.gutters[u],w=i.hasOwnProperty(v)&&i[v];w&&t.appendChild(lf("div",[w],"CodeMirror-gutter-elt","left: "+e.gutterLeft[v]+"px; width: "+e.gutterWidth[v]+"px"))}}if(c&&(k.style.zIndex=2),b.widgets&&k!=f)for(var r=0,x=b.widgets;r<x.length;++r){var s=x[r],y=lf("div",[s.node],"CodeMirror-linewidget");s.handleMouseEvents||(y.ignoreEvents=!0),Y(s,y,k,e),s.above?k.insertBefore(y,a.options.lineNumbers&&0!=b.height?t:h):k.appendChild(y),Qe(s,"redraw")}return k}function Y(a,b,c,d){if(a.noHScroll){(c.alignable||(c.alignable=[])).push(b);var e=d.wrapperWidth;b.style.left=d.fixedPos+"px",a.coverGutter||(e-=d.gutterTotalWidth,b.style.paddingLeft=d.gutterTotalWidth+"px"),b.style.width=e+"px"}a.coverGutter&&(b.style.zIndex=5,b.style.position="relative",a.noHScroll||(b.style.marginLeft=-d.gutterTotalWidth+"px"))}function Z(a){var b=a.display,c=Cc(a.doc.sel.from,a.doc.sel.to);if(c||a.options.showCursorWhenSelecting?$(a):b.cursor.style.display=b.otherCursor.style.display="none",c?b.selectionDiv.style.display="none":_(a),a.options.moveInputWithCursor){var d=vb(a,a.doc.sel.head,"div"),e=pf(b.wrapper),f=pf(b.lineDiv);b.inputDiv.style.top=Math.max(0,Math.min(b.wrapper.clientHeight-10,d.top+f.top-e.top))+"px",b.inputDiv.style.left=Math.max(0,Math.min(b.wrapper.clientWidth-10,d.left+f.left-e.left))+"px"}}function $(a){var b=a.display,c=vb(a,a.doc.sel.head,"div");b.cursor.style.left=c.left+"px",b.cursor.style.top=c.top+"px",b.cursor.style.height=Math.max(0,c.bottom-c.top)*a.options.cursorHeight+"px",b.cursor.style.display="",c.other?(b.otherCursor.style.display="",b.otherCursor.style.left=c.other.left+"px",b.otherCursor.style.top=c.other.top+"px",b.otherCursor.style.height=.85*(c.other.bottom-c.other.top)+"px"):b.otherCursor.style.display="none"}function _(a){function h(a,b,c,d){0>b&&(b=0),e.appendChild(lf("div",null,"CodeMirror-selected","position: absolute; left: "+a+"px; top: "+b+"px; width: "+(null==c?f-a:c)+"px; height: "+(d-b)+"px"))}function i(b,d,e){function m(c,d){return ub(a,Bc(b,c),"div",i,d)}var k,l,i=le(c,b),j=i.text.length;return Af(se(i),d||0,null==e?j:e,function(a,b,c){var n,o,p,i=m(a,"left");if(a==b)n=i,o=p=i.left;else{if(n=m(b-1,"right"),"rtl"==c){var q=i;i=n,n=q}o=i.left,p=n.right}null==d&&0==a&&(o=g),n.top-i.top>3&&(h(o,i.top,null,i.bottom),o=g,i.bottom<n.top&&h(o,i.bottom,null,n.top)),null==e&&b==j&&(p=f),(!k||i.top<k.top||i.top==k.top&&i.left<k.left)&&(k=i),(!l||n.bottom>l.bottom||n.bottom==l.bottom&&n.right>l.right)&&(l=n),g+1>o&&(o=g),h(o,n.top,p-o,n.bottom)}),{start:k,end:l}}var b=a.display,c=a.doc,d=a.doc.sel,e=document.createDocumentFragment(),f=b.lineSpace.offsetWidth,g=hb(a.display);if(d.from.line==d.to.line)i(d.from.line,d.from.ch,d.to.ch);else{var j=le(c,d.from.line),k=le(c,d.to.line),l=Fd(c,j)==Fd(c,k),m=i(d.from.line,d.from.ch,l?j.text.length:null).end,n=i(d.to.line,l?0:null,d.to.ch).start;l&&(m.top<n.top-2?(h(m.right,m.top,null,m.bottom),h(g,n.top,n.left,n.bottom)):h(m.right,m.top,n.left-m.right,m.bottom)),m.bottom<n.top&&h(g,m.bottom,null,n.top)}nf(b.selectionDiv,e),b.selectionDiv.style.display=""}function ab(a){if(a.state.focused){var b=a.display;clearInterval(b.blinker);var c=!0;b.cursor.style.visibility=b.otherCursor.style.visibility="",a.options.cursorBlinkRate>0&&(b.blinker=setInterval(function(){b.cursor.style.visibility=b.otherCursor.style.visibility=(c=!c)?"":"hidden"},a.options.cursorBlinkRate))}}function bb(a,b){a.doc.mode.startState&&a.doc.frontier<a.display.showingTo&&a.state.highlight.set(b,ff(cb,a))}function cb(a){var b=a.doc;if(b.frontier<b.first&&(b.frontier=b.first),!(b.frontier>=a.display.showingTo)){var f,c=+new Date+a.options.workTime,d=hd(b.mode,eb(a,b.frontier)),e=[];b.iter(b.frontier,Math.min(b.first+b.size,a.display.showingTo+500),function(g){if(b.frontier>=a.display.showingFrom){var h=g.styles;g.styles=Sd(a,g,d);for(var i=!h||h.length!=g.styles.length,j=0;!i&&j<h.length;++j)i=h[j]!=g.styles[j];i&&(f&&f.end==b.frontier?f.end++:e.push(f={start:b.frontier,end:b.frontier+1})),g.stateAfter=hd(b.mode,d)}else Ud(a,g,d),g.stateAfter=0==b.frontier%5?hd(b.mode,d):null;return++b.frontier,+new Date>c?(bb(a,a.options.workDelay),!0):void 0}),e.length&&Fb(a,function(){for(var a=0;a<e.length;++a)Ib(this,e[a].start,e[a].end)})()}}function db(a,b,c){for(var d,e,f=a.doc,g=c?-1:b-(a.doc.mode.innerMode?1e3:100),h=b;h>g;--h){if(h<=f.first)return f.first;var i=le(f,h-1);if(i.stateAfter&&(!c||h<=f.frontier))return h;var j=Ye(i.text,null,a.options.tabSize);(null==e||d>j)&&(e=h-1,d=j)}return e}function eb(a,b,c){var d=a.doc,e=a.display;if(!d.mode.startState)return!0;var f=db(a,b,c),g=f>d.first&&le(d,f-1).stateAfter;return g=g?hd(d.mode,g):id(d.mode),d.iter(f,b,function(c){Ud(a,c,g);var h=f==b-1||0==f%5||f>=e.showingFrom&&f<e.showingTo;c.stateAfter=h?hd(d.mode,g):null,++f}),c&&(d.frontier=f),g}function fb(a){return a.lineSpace.offsetTop}function gb(a){return a.mover.offsetHeight-a.lineSpace.offsetHeight}function hb(a){var b=nf(a.measure,lf("pre",null,null,"text-align: left")).appendChild(lf("span","x"));return b.offsetLeft}function ib(a,b,c,d,e){var f=-1;if(d=d||lb(a,b),d.crude){var g=d.left+c*d.width;return{left:g,right:g+d.width,top:d.top,bottom:d.bottom}}for(var h=c;;h+=f){var i=d[h];if(i)break;0>f&&0==h&&(f=1)}return e=h>c?"left":c>h?"right":e,"left"==e&&i.leftSide?i=i.leftSide:"right"==e&&i.rightSide&&(i=i.rightSide),{left:c>h?i.right:i.left,right:h>c?i.left:i.right,top:i.top,bottom:i.bottom}}function jb(a,b){for(var c=a.display.measureLineCache,d=0;d<c.length;++d){var e=c[d];if(e.text==b.text&&e.markedSpans==b.markedSpans&&a.display.scroller.clientWidth==e.width&&e.classes==b.textClass+"|"+b.wrapClass)return e}}function kb(a,b){var c=jb(a,b);c&&(c.text=c.measure=c.markedSpans=null)}function lb(a,b){var c=jb(a,b);if(c)return c.measure;var d=mb(a,b),e=a.display.measureLineCache,f={text:b.text,width:a.display.scroller.clientWidth,markedSpans:b.markedSpans,measure:d,classes:b.textClass+"|"+b.wrapClass};return 16==e.length?e[++a.display.measureLineCachePos%16]=f:e.push(f),d}function mb(a,e){function t(a){var b=a.top-p.top,c=a.bottom-p.top;c>s&&(c=s),0>b&&(b=0);for(var d=q.length-2;d>=0;d-=2){var e=q[d],f=q[d+1];if(!(e>c||b>f)&&(b>=e&&f>=c||e>=b&&c>=f||Math.min(c,f)-Math.max(b,e)>=c-b>>1)){q[d]=Math.min(b,e),q[d+1]=Math.max(c,f);break}}return 0>d&&(d=q.length,q.push(b,c)),{left:a.left-p.left,right:a.right-p.left,top:d,bottom:null}}function u(a){a.bottom=q[a.top+1],a.top=q[a.top]}if(!a.options.lineWrapping&&e.text.length>=a.options.crudeMeasuringFrom)return nb(a,e);var f=a.display,g=ef(e.text.length),h=Xd(a,e,g,!0).pre;if(b&&!c&&!a.options.lineWrapping&&h.childNodes.length>100){for(var i=document.createDocumentFragment(),j=10,k=h.childNodes.length,l=0,m=Math.ceil(k/j);m>l;++l){for(var n=lf("div",null,null,"display: inline-block"),o=0;j>o&&k;++o)n.appendChild(h.firstChild),--k;i.appendChild(n)}h.appendChild(i)}nf(f.measure,h);var p=pf(f.lineDiv),q=[],r=ef(e.text.length),s=h.offsetHeight;d&&f.measure.first!=h&&nf(f.measure,h);for(var v,l=0;l<g.length;++l)if(v=g[l]){var w=v,x=null;if(/\bCodeMirror-widget\b/.test(v.className)&&v.getClientRects){1==v.firstChild.nodeType&&(w=v.firstChild);var y=w.getClientRects();y.length>1&&(x=r[l]=t(y[0]),x.rightSide=t(y[y.length-1]))}x||(x=r[l]=t(pf(w))),v.measureRight&&(x.right=pf(v.measureRight).left),v.leftSide&&(x.leftSide=t(pf(v.leftSide)))}mf(a.display.measure);for(var v,l=0;l<r.length;++l)(v=r[l])&&(u(v),v.leftSide&&u(v.leftSide),v.rightSide&&u(v.rightSide));return r}function nb(a,b){var c=new Od(b.text.slice(0,100),null);b.textClass&&(c.textClass=b.textClass);var d=mb(a,c),e=ib(a,c,0,d,"left"),f=ib(a,c,99,d,"right");return{crude:!0,top:e.top,left:e.left,bottom:e.bottom,width:(f.right-e.left)/100}}function ob(a,b){var c=!1;if(b.markedSpans)for(var d=0;d<b.markedSpans;++d){var e=b.markedSpans[d];!e.collapsed||null!=e.to&&e.to!=b.text.length||(c=!0)}var f=!c&&jb(a,b);if(f||b.text.length>=a.options.crudeMeasuringFrom)return ib(a,b,b.text.length,f&&f.measure,"right").right;var g=Xd(a,b,null,!0).pre,h=g.appendChild(vf(a.display.measure));return nf(a.display.measure,g),pf(h).right-pf(a.display.lineDiv).left}function pb(a){a.display.measureLineCache.length=a.display.measureLineCachePos=0,a.display.cachedCharWidth=a.display.cachedTextHeight=null,a.options.lineWrapping||(a.display.maxLineChanged=!0),a.display.lineNumChars=null}function qb(){return window.pageXOffset||(document.documentElement||document.body).scrollLeft}function rb(){return window.pageYOffset||(document.documentElement||document.body).scrollTop}function sb(a,b,c,d){if(b.widgets)for(var e=0;e<b.widgets.length;++e)if(b.widgets[e].above){var f=Md(b.widgets[e]);c.top+=f,c.bottom+=f}if("line"==d)return c;d||(d="local");var g=re(a,b);if("local"==d?g+=fb(a.display):g-=a.display.viewOffset,"page"==d||"window"==d){var h=pf(a.display.lineSpace);g+=h.top+("window"==d?0:rb());var i=h.left+("window"==d?0:qb());c.left+=i,c.right+=i}return c.top+=g,c.bottom+=g,c}function tb(a,b,c){if("div"==c)return b;var d=b.left,e=b.top;if("page"==c)d-=qb(),e-=rb();else if("local"==c||!c){var f=pf(a.display.sizer);d+=f.left,e+=f.top}var g=pf(a.display.lineSpace);return{left:d-g.left,top:e-g.top}}function ub(a,b,c,d,e){return d||(d=le(a.doc,b.line)),sb(a,d,ib(a,d,b.ch,null,e),c)}function vb(a,b,c,d,e){function f(b,f){var g=ib(a,d,b,e,f?"right":"left");return f?g.left=g.right:g.right=g.left,sb(a,d,g,c)}function g(a,b){var c=h[b],d=c.level%2;return a==Bf(c)&&b&&c.level<h[b-1].level?(c=h[--b],a=Cf(c)-(c.level%2?0:1),d=!0):a==Cf(c)&&b<h.length-1&&c.level<h[b+1].level&&(c=h[++b],a=Bf(c)-c.level%2,d=!1),d&&a==c.to&&a>c.from?f(a-1):f(a,d)}d=d||le(a.doc,b.line),e||(e=lb(a,d));var h=se(d),i=b.ch;if(!h)return f(i);var j=Jf(h,i),k=g(i,j);return null!=If&&(k.other=g(i,If)),k}function wb(a,b,c,d){var e=new Bc(a,b);return e.xRel=d,c&&(e.outside=!0),e}function xb(a,b,c){var d=a.doc;if(c+=a.display.viewOffset,0>c)return wb(d.first,0,!0,-1);var e=qe(d,c),f=d.first+d.size-1;if(e>f)return wb(d.first+d.size-1,le(d,f).text.length,!0,1);for(0>b&&(b=0);;){var g=le(d,e),h=yb(a,g,e,b,c),i=Ed(g),j=i&&i.find();if(!i||!(h.ch>j.from.ch||h.ch==j.from.ch&&h.xRel>0))return h;e=j.to.line}}function yb(a,b,c,d,e){function j(d){var e=vb(a,Bc(c,d),"line",b,i);return g=!0,f>e.bottom?e.left-h:f<e.top?e.left+h:(g=!1,e.left)}var f=e-re(a,b),g=!1,h=2*a.display.wrapper.clientWidth,i=lb(a,b),k=se(b),l=b.text.length,m=Df(b),n=Ef(b),o=j(m),p=g,q=j(n),r=g;if(d>q)return wb(c,n,r,1);for(;;){if(k?n==m||n==Lf(b,m,1):1>=n-m){for(var s=o>d||q-d>=d-o?m:n,t=d-(s==m?o:q);kf.test(b.text.charAt(s));)++s;var u=wb(c,s,s==m?p:r,0>t?-1:t?1:0);return u}var v=Math.ceil(l/2),w=m+v;if(k){w=m;for(var x=0;v>x;++x)w=Lf(b,w,1)}var y=j(w);y>d?(n=w,q=y,(r=g)&&(q+=1e3),l=v):(m=w,o=y,p=g,l-=v)}}function Ab(a){if(null!=a.cachedTextHeight)return a.cachedTextHeight;if(null==zb){zb=lf("pre");for(var b=0;49>b;++b)zb.appendChild(document.createTextNode("x")),zb.appendChild(lf("br"));zb.appendChild(document.createTextNode("x"))}nf(a.measure,zb);var c=zb.offsetHeight/50;return c>3&&(a.cachedTextHeight=c),mf(a.measure),c||1}function Bb(a){if(null!=a.cachedCharWidth)return a.cachedCharWidth;var b=lf("span","x"),c=lf("pre",[b]);nf(a.measure,c);var d=b.offsetWidth;return d>2&&(a.cachedCharWidth=d),d||10}function Db(a){a.curOp={changes:[],forceUpdate:!1,updateInput:null,userSelChange:null,textChanged:null,selectionChanged:!1,cursorActivity:!1,updateMaxLine:!1,updateScrollPos:!1,id:++Cb},Pe++||(Oe=[])}function Eb(a){var b=a.curOp,c=a.doc,d=a.display;if(a.curOp=null,b.updateMaxLine&&I(a),d.maxLineChanged&&!a.options.lineWrapping&&d.maxLine){var e=ob(a,d.maxLine);d.sizer.style.minWidth=Math.max(0,e+3+Ve)+"px",d.maxLineChanged=!1;var f=Math.max(0,d.sizer.offsetLeft+d.sizer.offsetWidth-d.scroller.clientWidth);f<c.scrollLeft&&!b.updateScrollPos&&ac(a,Math.min(d.scroller.scrollLeft,f),!0)}var g,h;if(b.updateScrollPos)g=b.updateScrollPos;else if(b.selectionChanged&&d.scroller.clientHeight){var i=vb(a,c.sel.head);g=Rc(a,i.left,i.top,i.left,i.bottom)}(b.changes.length||b.forceUpdate||g&&null!=g.scrollTop)&&(h=Q(a,b.changes,g&&g.scrollTop,b.forceUpdate),a.display.scroller.offsetHeight&&(a.doc.scrollTop=a.display.scroller.scrollTop)),!h&&b.selectionChanged&&Z(a),b.updateScrollPos?(d.scroller.scrollTop=d.scrollbarV.scrollTop=c.scrollTop=g.scrollTop,d.scroller.scrollLeft=d.scrollbarH.scrollLeft=c.scrollLeft=g.scrollLeft,M(a),b.scrollToPos&&Pc(a,Gc(a.doc,b.scrollToPos.from),Gc(a.doc,b.scrollToPos.to),b.scrollToPos.margin)):g&&Oc(a),b.selectionChanged&&ab(a),a.state.focused&&b.updateInput&&Mb(a,b.userSelChange);var j=b.maybeHiddenMarkers,k=b.maybeUnhiddenMarkers;if(j)for(var l=0;l<j.length;++l)j[l].lines.length||Ne(j[l],"hide");if(k)for(var l=0;l<k.length;++l)k[l].lines.length&&Ne(k[l],"unhide");var m;if(--Pe||(m=Oe,Oe=null),b.textChanged&&Ne(a,"change",a,b.textChanged),b.cursorActivity&&Ne(a,"cursorActivity",a),m)for(var l=0;l<m.length;++l)m[l]()}function Fb(a,b){return function(){var c=a||this,d=!c.curOp;d&&Db(c);try{var e=b.apply(c,arguments)}finally{d&&Eb(c)}return e}}function Gb(a){return function(){var c,b=this.cm&&!this.cm.curOp;b&&Db(this.cm);try{c=a.apply(this,arguments)}finally{b&&Eb(this.cm)}return c}}function Hb(a,b){var d,c=!a.curOp;c&&Db(a);try{d=b()}finally{c&&Eb(a)}return d}function Ib(a,b,c,d){null==b&&(b=a.doc.first),null==c&&(c=a.doc.first+a.doc.size),a.curOp.changes.push({from:b,to:c,diff:d})}function Jb(a){a.display.pollingFast||a.display.poll.set(a.options.pollInterval,function(){Lb(a),a.state.focused&&Jb(a)})}function Kb(a){function c(){var d=Lb(a);d||b?(a.display.pollingFast=!1,Jb(a)):(b=!0,a.display.poll.set(60,c))}var b=!1;a.display.pollingFast=!0,a.display.poll.set(20,c)}function Lb(a){var c=a.display.input,e=a.display.prevInput,f=a.doc,g=f.sel;if(!a.state.focused||xf(c)||Ob(a)||a.state.disableInput)return!1;a.state.pasteIncoming&&a.state.fakedLastChar&&(c.value=c.value.substring(0,c.value.length-1),a.state.fakedLastChar=!1);var h=c.value;if(h==e&&Cc(g.from,g.to))return!1;if(b&&!d&&a.display.inputHasSelection===h)return Mb(a,!0),!1;var i=!a.curOp;i&&Db(a),g.shift=!1;for(var j=0,k=Math.min(e.length,h.length);k>j&&e.charCodeAt(j)==h.charCodeAt(j);)++j;var l=g.from,m=g.to;j<e.length?l=Bc(l.line,l.ch-(e.length-j)):a.state.overwrite&&Cc(l,m)&&!a.state.pasteIncoming&&(m=Bc(m.line,Math.min(le(f,m.line).text.length,m.ch+(h.length-j))));var n=a.curOp.updateInput,o={from:l,to:m,text:wf(h.slice(j)),origin:a.state.pasteIncoming?"paste":"+input"};return uc(a.doc,o,"end"),a.curOp.updateInput=n,Qe(a,"inputRead",a,o),h.length>1e3||h.indexOf("\n")>-1?c.value=a.display.prevInput="":a.display.prevInput=h,i&&Eb(a),a.state.pasteIncoming=!1,!0}function Mb(a,c){var e,f,g=a.doc;if(Cc(g.sel.from,g.sel.to))c&&(a.display.prevInput=a.display.input.value="",b&&!d&&(a.display.inputHasSelection=null));else{a.display.prevInput="",e=yf&&(g.sel.to.line-g.sel.from.line>100||(f=a.getSelection()).length>1e3);var h=e?"-":f||a.getSelection();a.display.input.value=h,a.state.focused&&af(a.display.input),b&&!d&&(a.display.inputHasSelection=h)}a.display.inaccurateSelection=e}function Nb(a){"nocursor"==a.options.readOnly||p&&document.activeElement==a.display.input||a.display.input.focus()}function Ob(a){return a.options.readOnly||a.doc.cantEdit}function Pb(a){function e(){a.state.focused&&setTimeout(ff(Nb,a),0)}function h(){null==g&&(g=setTimeout(function(){g=null,c.cachedCharWidth=c.cachedTextHeight=sf=null,pb(a),Hb(a,ff(Ib,a))},100))}function i(){for(var a=c.wrapper.parentNode;a&&a!=document.body;a=a.parentNode);a?setTimeout(i,5e3):Me(window,"resize",h)}function j(b){Re(a,b)||a.options.onDragEvent&&a.options.onDragEvent(a,Ee(b))||Ie(b)}function l(){c.inaccurateSelection&&(c.prevInput="",c.inaccurateSelection=!1,c.input.value=a.getSelection(),af(c.input))}var c=a.display;Le(c.scroller,"mousedown",Fb(a,Ub)),b?Le(c.scroller,"dblclick",Fb(a,function(b){if(!Re(a,b)){var c=Rb(a,b);if(c&&!Xb(a,b)&&!Qb(a.display,b)){Fe(b);var d=Yc(le(a.doc,c.line).text,c);Jc(a.doc,d.from,d.to)}}})):Le(c.scroller,"dblclick",function(b){Re(a,b)||Fe(b)}),Le(c.lineSpace,"selectstart",function(a){Qb(c,a)||Fe(a)}),u||Le(c.scroller,"contextmenu",function(b){pc(a,b)}),Le(c.scroller,"scroll",function(){c.scroller.clientHeight&&(_b(a,c.scroller.scrollTop),ac(a,c.scroller.scrollLeft,!0),Ne(a,"scroll",a))}),Le(c.scrollbarV,"scroll",function(){c.scroller.clientHeight&&_b(a,c.scrollbarV.scrollTop)}),Le(c.scrollbarH,"scroll",function(){c.scroller.clientHeight&&ac(a,c.scrollbarH.scrollLeft)}),Le(c.scroller,"mousewheel",function(b){dc(a,b)}),Le(c.scroller,"DOMMouseScroll",function(b){dc(a,b)}),Le(c.scrollbarH,"mousedown",e),Le(c.scrollbarV,"mousedown",e),Le(c.wrapper,"scroll",function(){c.wrapper.scrollTop=c.wrapper.scrollLeft=0});var g;Le(window,"resize",h),setTimeout(i,5e3),Le(c.input,"keyup",Fb(a,function(b){Re(a,b)||a.options.onKeyEvent&&a.options.onKeyEvent(a,Ee(b))||16==b.keyCode&&(a.doc.sel.shift=!1)})),Le(c.input,"input",function(){b&&!d&&a.display.inputHasSelection&&(a.display.inputHasSelection=null),Kb(a)}),Le(c.input,"keydown",Fb(a,kc)),Le(c.input,"keypress",Fb(a,lc)),Le(c.input,"focus",ff(mc,a)),Le(c.input,"blur",ff(nc,a)),a.options.dragDrop&&(Le(c.scroller,"dragstart",function(b){$b(a,b)}),Le(c.scroller,"dragenter",j),Le(c.scroller,"dragover",j),Le(c.scroller,"drop",Fb(a,Zb))),Le(c.scroller,"paste",function(b){Qb(c,b)||(Nb(a),Kb(a))}),Le(c.input,"paste",function(){if(f&&!a.state.fakedLastChar&&!(new Date-a.state.lastMiddleDown<200)){var b=c.input.selectionStart,d=c.input.selectionEnd;c.input.value+="$",c.input.selectionStart=b,c.input.selectionEnd=d,a.state.fakedLastChar=!0}a.state.pasteIncoming=!0,Kb(a)}),Le(c.input,"cut",l),Le(c.input,"copy",l),k&&Le(c.sizer,"mouseup",function(){document.activeElement==c.input&&c.input.blur(),Nb(a)})}function Qb(a,b){for(var c=Je(b);c!=a.wrapper;c=c.parentNode)if(!c||c.ignoreEvents||c.parentNode==a.sizer&&c!=a.mover)return!0}function Rb(a,b,c){var d=a.display;if(!c){var e=Je(b);if(e==d.scrollbarH||e==d.scrollbarH.firstChild||e==d.scrollbarV||e==d.scrollbarV.firstChild||e==d.scrollbarFiller||e==d.gutterFiller)return null}var f,g,h=pf(d.lineSpace);try{f=b.clientX,g=b.clientY}catch(b){return null}return xb(a,f-h.left,g-h.top)}function Ub(a){function q(a){if(!Cc(p,a)){if(p=a,"single"==j)return Jc(c.doc,Gc(e,h),a),void 0;if(n=Gc(e,n),o=Gc(e,o),"double"==j){var b=Yc(le(e,a.line).text,a);Dc(a,n)?Jc(c.doc,b.from,o):Jc(c.doc,n,b.to)}else"triple"==j&&(Dc(a,n)?Jc(c.doc,o,Gc(e,Bc(a.line,0))):Jc(c.doc,n,Gc(e,Bc(a.line+1,0))))}}function t(a){var b=++s,f=Rb(c,a,!0);if(f)if(Cc(f,l)){var h=a.clientY<r.top?-20:a.clientY>r.bottom?20:0;h&&setTimeout(Fb(c,function(){s==b&&(d.scroller.scrollTop+=h,t(a))}),50)}else{c.state.focused||mc(c),l=f,q(f);var g=L(d,e);(f.line>=g.to||f.line<g.from)&&setTimeout(Fb(c,function(){s==b&&t(a)}),150)}}function v(a){s=1/0,Fe(a),Nb(c),Me(document,"mousemove",w),Me(document,"mouseup",x)}if(!Re(this,a)){var c=this,d=c.display,e=c.doc,g=e.sel;if(g.shift=a.shiftKey,Qb(d,a))return f||(d.scroller.draggable=!1,setTimeout(function(){d.scroller.draggable=!0},100)),void 0;if(!Xb(c,a)){var h=Rb(c,a);switch(Ke(a)){case 3:return u&&pc.call(c,c,a),void 0;case 2:return f&&(c.state.lastMiddleDown=+new Date),h&&Jc(c.doc,h),setTimeout(ff(Nb,c),20),Fe(a),void 0}if(!h)return Je(a)==d.scroller&&Fe(a),void 0;c.state.focused||mc(c);var i=+new Date,j="single";if(Tb&&Tb.time>i-400&&Cc(Tb.pos,h))j="triple",Fe(a),setTimeout(ff(Nb,c),20),Zc(c,h.line);else if(Sb&&Sb.time>i-400&&Cc(Sb.pos,h)){j="double",Tb={time:i,pos:h},Fe(a);var k=Yc(le(e,h.line).text,h);Jc(c.doc,k.from,k.to)}else Sb={time:i,pos:h};var l=h;if(c.options.dragDrop&&qf&&!Ob(c)&&!Cc(g.from,g.to)&&!Dc(h,g.from)&&!Dc(g.to,h)&&"single"==j){var m=Fb(c,function(b){f&&(d.scroller.draggable=!1),c.state.draggingText=!1,Me(document,"mouseup",m),Me(d.scroller,"drop",m),Math.abs(a.clientX-b.clientX)+Math.abs(a.clientY-b.clientY)<10&&(Fe(b),Jc(c.doc,h),Nb(c))});return f&&(d.scroller.draggable=!0),c.state.draggingText=m,d.scroller.dragDrop&&d.scroller.dragDrop(),Le(document,"mouseup",m),Le(d.scroller,"drop",m),void 0}Fe(a),"single"==j&&Jc(c.doc,Gc(e,h));var n=g.from,o=g.to,p=h,r=pf(d.wrapper),s=0,w=Fb(c,function(a){b||Ke(a)?t(a):v(a)}),x=Fb(c,v);Le(document,"mousemove",w),Le(document,"mouseup",x)}}}function Vb(a,b,c,d,e){try{var f=b.clientX,g=b.clientY}catch(b){return!1}if(f>=Math.floor(pf(a.display.gutters).right))return!1;d&&Fe(b);var h=a.display,i=pf(h.lineDiv);if(g>i.bottom||!Te(a,c))return He(b);g-=i.top-h.viewOffset;for(var j=0;j<a.options.gutters.length;++j){var k=h.gutters.childNodes[j];if(k&&pf(k).right>=f){var l=qe(a.doc,g),m=a.options.gutters[j];return e(a,c,a,l,m,b),He(b)}}}function Wb(a,b){return Te(a,"gutterContextMenu")?Vb(a,b,"gutterContextMenu",!1,Ne):!1}function Xb(a,b){return Vb(a,b,"gutterClick",!0,Qe)}function Zb(a){var c=this;if(!(Re(c,a)||Qb(c.display,a)||c.options.onDragEvent&&c.options.onDragEvent(c,Ee(a)))){Fe(a),b&&(Yb=+new Date);var d=Rb(c,a,!0),e=a.dataTransfer.files;if(d&&!Ob(c))if(e&&e.length&&window.FileReader&&window.File)for(var f=e.length,g=Array(f),h=0,i=function(a,b){var e=new FileReader;e.onload=function(){g[b]=e.result,++h==f&&(d=Gc(c.doc,d),uc(c.doc,{from:d,to:d,text:wf(g.join("\n")),origin:"paste"},"around"))},e.readAsText(a)},j=0;f>j;++j)i(e[j],j);else{if(c.state.draggingText&&!Dc(d,c.doc.sel.from)&&!Dc(c.doc.sel.to,d))return c.state.draggingText(a),setTimeout(ff(Nb,c),20),void 0;try{var g=a.dataTransfer.getData("Text");if(g){var k=c.doc.sel.from,l=c.doc.sel.to;Lc(c.doc,d,d),c.state.draggingText&&Ac(c.doc,"",k,l,"paste"),c.replaceSelection(g,null,"paste"),Nb(c),mc(c)}}catch(a){}}}}function $b(a,c){if(b&&(!a.state.draggingText||+new Date-Yb<100))return Ie(c),void 0;if(!Re(a,c)&&!Qb(a.display,c)){var d=a.getSelection();if(c.dataTransfer.setData("Text",d),c.dataTransfer.setDragImage&&!j){var e=lf("img",null,null,"position: fixed; left: 0; top: 0;");e.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",i&&(e.width=e.height=1,a.display.wrapper.appendChild(e),e._top=e.offsetTop),c.dataTransfer.setDragImage(e,0,0),i&&e.parentNode.removeChild(e)}}}function _b(b,c){Math.abs(b.doc.scrollTop-c)<2||(b.doc.scrollTop=c,a||Q(b,[],c),b.display.scroller.scrollTop!=c&&(b.display.scroller.scrollTop=c),b.display.scrollbarV.scrollTop!=c&&(b.display.scrollbarV.scrollTop=c),a&&Q(b,[]),bb(b,100))}function ac(a,b,c){(c?b==a.doc.scrollLeft:Math.abs(a.doc.scrollLeft-b)<2)||(b=Math.min(b,a.display.scroller.scrollWidth-a.display.scroller.clientWidth),a.doc.scrollLeft=b,M(a),a.display.scroller.scrollLeft!=b&&(a.display.scroller.scrollLeft=b),a.display.scrollbarH.scrollLeft!=b&&(a.display.scrollbarH.scrollLeft=b))}function dc(b,c){var d=c.wheelDeltaX,e=c.wheelDeltaY;null==d&&c.detail&&c.axis==c.HORIZONTAL_AXIS&&(d=c.detail),null==e&&c.detail&&c.axis==c.VERTICAL_AXIS?e=c.detail:null==e&&(e=c.wheelDelta);var g=b.display,h=g.scroller;if(d&&h.scrollWidth>h.clientWidth||e&&h.scrollHeight>h.clientHeight){if(e&&q&&f)for(var j=c.target;j!=h;j=j.parentNode)if(j.lineObj){b.display.currentWheelTarget=j;break}if(d&&!a&&!i&&null!=cc)return e&&_b(b,Math.max(0,Math.min(h.scrollTop+e*cc,h.scrollHeight-h.clientHeight))),ac(b,Math.max(0,Math.min(h.scrollLeft+d*cc,h.scrollWidth-h.clientWidth))),Fe(c),g.wheelStartX=null,void 0;if(e&&null!=cc){var k=e*cc,l=b.doc.scrollTop,m=l+g.wrapper.clientHeight;0>k?l=Math.max(0,l+k-50):m=Math.min(b.doc.height,m+k+50),Q(b,[],{top:l,bottom:m})}20>bc&&(null==g.wheelStartX?(g.wheelStartX=h.scrollLeft,g.wheelStartY=h.scrollTop,g.wheelDX=d,g.wheelDY=e,setTimeout(function(){if(null!=g.wheelStartX){var a=h.scrollLeft-g.wheelStartX,b=h.scrollTop-g.wheelStartY,c=b&&g.wheelDY&&b/g.wheelDY||a&&g.wheelDX&&a/g.wheelDX;g.wheelStartX=g.wheelStartY=null,c&&(cc=(cc*bc+c)/(bc+1),++bc)}},200)):(g.wheelDX+=d,g.wheelDY+=e))}}function ec(a,b,c){if("string"==typeof b&&(b=jd[b],!b))return!1;a.display.pollingFast&&Lb(a)&&(a.display.pollingFast=!1);var d=a.doc,e=d.sel.shift,f=!1;try{Ob(a)&&(a.state.suppressEdits=!0),c&&(d.sel.shift=!1),f=b(a)!=We}finally{d.sel.shift=e,a.state.suppressEdits=!1}return f}function fc(a){var b=a.state.keyMaps.slice(0);return a.options.extraKeys&&b.push(a.options.extraKeys),b.push(a.options.keyMap),b}function hc(a,b){var c=ld(a.options.keyMap),e=c.auto;clearTimeout(gc),e&&!nd(b)&&(gc=setTimeout(function(){ld(a.options.keyMap)==c&&(a.options.keyMap=e.call?e.call(null,a):e,D(a))},50));var f=od(b,!0),g=!1;if(!f)return!1;var h=fc(a);return g=b.shiftKey?md("Shift-"+f,h,function(b){return ec(a,b,!0)})||md(f,h,function(b){return("string"==typeof b?/^go[A-Z]/.test(b):b.motion)?ec(a,b):void 0}):md(f,h,function(b){return ec(a,b)}),g&&(Fe(b),ab(a),d&&(b.oldKeyCode=b.keyCode,b.keyCode=0),Qe(a,"keyHandled",a,f,b)),g}function ic(a,b,c){var d=md("'"+c+"'",fc(a),function(b){return ec(a,b,!0)});return d&&(Fe(b),ab(a),Qe(a,"keyHandled",a,"'"+c+"'",b)),d}function kc(a){var c=this;if(c.state.focused||mc(c),!(Re(c,a)||c.options.onKeyEvent&&c.options.onKeyEvent(c,Ee(a)))){b&&27==a.keyCode&&(a.returnValue=!1);var d=a.keyCode;c.doc.sel.shift=16==d||a.shiftKey;var e=hc(c,a);i&&(jc=e?d:null,!e&&88==d&&!yf&&(q?a.metaKey:a.ctrlKey)&&c.replaceSelection(""))}}function lc(a){var c=this;if(!(Re(c,a)||c.options.onKeyEvent&&c.options.onKeyEvent(c,Ee(a)))){var e=a.keyCode,f=a.charCode;if(i&&e==jc)return jc=null,Fe(a),void 0;if(!(i&&(!a.which||a.which<10)||k)||!hc(c,a)){var g=String.fromCharCode(null==f?e:f);this.options.electricChars&&this.doc.mode.electricChars&&this.options.smartIndent&&!Ob(this)&&this.doc.mode.electricChars.indexOf(g)>-1&&setTimeout(Fb(c,function(){Uc(c,c.doc.sel.to.line,"smart")}),75),ic(c,a,g)||(b&&!d&&(c.display.inputHasSelection=null),Kb(c))}}}function mc(a){"nocursor"!=a.options.readOnly&&(a.state.focused||(Ne(a,"focus",a),a.state.focused=!0,-1==a.display.wrapper.className.search(/\bCodeMirror-focused\b/)&&(a.display.wrapper.className+=" CodeMirror-focused"),a.curOp||(Mb(a,!0),f&&setTimeout(ff(Mb,a,!0),0))),Jb(a),ab(a))}function nc(a){a.state.focused&&(Ne(a,"blur",a),a.state.focused=!1,a.display.wrapper.className=a.display.wrapper.className.replace(" CodeMirror-focused","")),clearInterval(a.display.blinker),setTimeout(function(){a.state.focused||(a.doc.sel.shift=!1)},150)}function pc(a,c){function l(){if(null!=e.input.selectionStart){var a=e.input.value="\u200b"+(Cc(f.from,f.to)?"":e.input.value);e.prevInput="\u200b",e.input.selectionStart=1,e.input.selectionEnd=a.length}}function m(){if(e.inputDiv.style.position="relative",e.input.style.cssText=k,d&&(e.scrollbarV.scrollTop=e.scroller.scrollTop=h),Jb(a),null!=e.input.selectionStart){(!b||d)&&l(),clearTimeout(oc);var c=0,f=function(){" "==e.prevInput&&0==e.input.selectionStart?Fb(a,jd.selectAll)(a):c++<10?oc=setTimeout(f,500):Mb(a)};oc=setTimeout(f,200)}}if(!Re(a,c,"contextmenu")){var e=a.display,f=a.doc.sel;if(!Qb(e,c)&&!Wb(a,c)){var g=Rb(a,c),h=e.scroller.scrollTop;if(g&&!i){var j=a.options.resetSelectionOnContextMenu;j&&(Cc(f.from,f.to)||Dc(g,f.from)||!Dc(g,f.to))&&Fb(a,Lc)(a.doc,g,g);var k=e.input.style.cssText;if(e.inputDiv.style.position="absolute",e.input.style.cssText="position: fixed; width: 30px; height: 30px; top: "+(c.clientY-5)+"px; left: "+(c.clientX-5)+"px; z-index: 1000; background: white; outline: none;"+"border-width: 0; outline: none; overflow: hidden; opacity: .05; -ms-opacity: .05; filter: alpha(opacity=5);",Nb(a),Mb(a,!0),Cc(f.from,f.to)&&(e.input.value=e.prevInput=" "),b&&!d&&l(),u){Ie(c);var n=function(){Me(window,"mouseup",n),setTimeout(m,20)};Le(window,"mouseup",n)}else setTimeout(m,50)}}}}function rc(a,b,c){if(!Dc(b.from,c))return Gc(a,c);var d=b.text.length-1-(b.to.line-b.from.line);if(c.line>b.to.line+d){var e=c.line-d,f=a.first+a.size-1;return e>f?Bc(f,le(a,f).text.length):Hc(c,le(a,e).text.length)}if(c.line==b.to.line+d)return Hc(c,_e(b.text).length+(1==b.text.length?b.from.ch:0)+le(a,b.to.line).text.length-b.to.ch);var g=c.line-b.from.line;return Hc(c,b.text[g].length+(g?0:b.from.ch))}function sc(a,b,c){if(c&&"object"==typeof c)return{anchor:rc(a,b,c.anchor),head:rc(a,b,c.head)};if("start"==c)return{anchor:b.from,head:b.from};var d=qc(b);if("around"==c)return{anchor:b.from,head:d};if("end"==c)return{anchor:d,head:d};var e=function(a){if(Dc(a,b.from))return a;if(!Dc(b.to,a))return d;var c=a.line+b.text.length-(b.to.line-b.from.line)-1,e=a.ch;return a.line==b.to.line&&(e+=d.ch-b.to.ch),Bc(c,e)};return{anchor:e(a.sel.anchor),head:e(a.sel.head)}}function tc(a,b,c){var d={canceled:!1,from:b.from,to:b.to,text:b.text,origin:b.origin,cancel:function(){this.canceled=!0}};return c&&(d.update=function(b,c,d,e){b&&(this.from=Gc(a,b)),c&&(this.to=Gc(a,c)),d&&(this.text=d),void 0!==e&&(this.origin=e)}),Ne(a,"beforeChange",a,d),a.cm&&Ne(a.cm,"beforeChange",a.cm,d),d.canceled?null:{from:d.from,to:d.to,text:d.text,origin:d.origin}}function uc(a,b,c,d){if(a.cm){if(!a.cm.curOp)return Fb(a.cm,uc)(a,b,c,d);if(a.cm.state.suppressEdits)return}if(!(Te(a,"beforeChange")||a.cm&&Te(a.cm,"beforeChange"))||(b=tc(a,b,!0))){var e=v&&!d&&Bd(a,b.from,b.to);if(e){for(var f=e.length-1;f>=1;--f)vc(a,{from:e[f].from,to:e[f].to,text:[""]});e.length&&vc(a,{from:e[0].from,to:e[0].to,text:b.text},c)}else vc(a,b,c)}}function vc(a,b,c){if(1!=b.text.length||""!=b.text[0]||!Cc(b.from,b.to)){var d=sc(a,b,c);we(a,b,d,a.cm?a.cm.curOp.id:0/0),yc(a,b,d,zd(a,b));var e=[];je(a,function(a,c){c||-1!=bf(e,a.history)||(Ce(a.history,b),e.push(a.history)),yc(a,b,null,zd(a,b))})}}function wc(a,b){if(!a.cm||!a.cm.state.suppressEdits){var c=a.history,d=("undo"==b?c.done:c.undone).pop();if(d){var e={changes:[],anchorBefore:d.anchorAfter,headBefore:d.headAfter,anchorAfter:d.anchorBefore,headAfter:d.headBefore,generation:c.generation};("undo"==b?c.undone:c.done).push(e),c.generation=d.generation||++c.maxGeneration;for(var f=Te(a,"beforeChange")||a.cm&&Te(a.cm,"beforeChange"),g=d.changes.length-1;g>=0;--g){var h=d.changes[g];if(h.origin=b,f&&!tc(a,h,!1))return("undo"==b?c.done:c.undone).length=0,void 0;e.changes.push(ve(a,h));var i=g?sc(a,h,null):{anchor:d.anchorBefore,head:d.headBefore};yc(a,h,i,Ad(a,h));var j=[];je(a,function(a,b){b||-1!=bf(j,a.history)||(Ce(a.history,h),j.push(a.history)),yc(a,h,null,Ad(a,h))})}}}}function xc(a,b){function c(a){return Bc(a.line+b,a.ch)}a.first+=b,a.cm&&Ib(a.cm,a.first,a.first,b),a.sel.head=c(a.sel.head),a.sel.anchor=c(a.sel.anchor),a.sel.from=c(a.sel.from),a.sel.to=c(a.sel.to)}function yc(a,b,c,d){if(a.cm&&!a.cm.curOp)return Fb(a.cm,yc)(a,b,c,d);if(b.to.line<a.first)return xc(a,b.text.length-1-(b.to.line-b.from.line)),void 0;if(!(b.from.line>a.lastLine())){if(b.from.line<a.first){var e=b.text.length-1-(a.first-b.from.line);xc(a,e),b={from:Bc(a.first,0),to:Bc(b.to.line+e,b.to.ch),text:[_e(b.text)],origin:b.origin}}var f=a.lastLine();b.to.line>f&&(b={from:b.from,to:Bc(f,le(a,f).text.length),text:[b.text[0]],origin:b.origin}),b.removed=me(a,b.from,b.to),c||(c=sc(a,b,null)),a.cm?zc(a.cm,b,d,c):ce(a,b,d,c)}}function zc(a,b,c,d){var e=a.doc,f=a.display,g=b.from,h=b.to,i=!1,j=g.line;a.options.lineWrapping||(j=pe(Fd(e,le(e,g.line))),e.iter(j,h.line+1,function(a){return a==f.maxLine?(i=!0,!0):void 0})),Dc(e.sel.head,b.from)||Dc(b.to,e.sel.head)||(a.curOp.cursorActivity=!0),ce(e,b,c,d,B(a)),a.options.lineWrapping||(e.iter(j,g.line+b.text.length,function(a){var b=H(e,a);b>f.maxLineLength&&(f.maxLine=a,f.maxLineLength=b,f.maxLineChanged=!0,i=!1)}),i&&(a.curOp.updateMaxLine=!0)),e.frontier=Math.min(e.frontier,g.line),bb(a,400);var k=b.text.length-(h.line-g.line)-1;if(Ib(a,g.line,h.line+1,k),Te(a,"change")){var l={from:g,to:h,text:b.text,removed:b.removed,origin:b.origin};if(a.curOp.textChanged){for(var m=a.curOp.textChanged;m.next;m=m.next);m.next=l}else a.curOp.textChanged=l}}function Ac(a,b,c,d,e){if(d||(d=c),Dc(d,c)){var f=d;d=c,c=f}"string"==typeof b&&(b=wf(b)),uc(a,{from:c,to:d,text:b,origin:e},null)}function Bc(a,b){return this instanceof Bc?(this.line=a,this.ch=b,void 0):new Bc(a,b)}function Cc(a,b){return a.line==b.line&&a.ch==b.ch}function Dc(a,b){return a.line<b.line||a.line==b.line&&a.ch<b.ch}function Ec(a){return Bc(a.line,a.ch)}function Fc(a,b){return Math.max(a.first,Math.min(b,a.first+a.size-1))}function Gc(a,b){if(b.line<a.first)return Bc(a.first,0);var c=a.first+a.size-1;return b.line>c?Bc(c,le(a,c).text.length):Hc(b,le(a,b.line).text.length)}function Hc(a,b){var c=a.ch;return null==c||c>b?Bc(a.line,b):0>c?Bc(a.line,0):a}function Ic(a,b){return b>=a.first&&b<a.first+a.size}function Jc(a,b,c,d){if(a.sel.shift||a.sel.extend){var e=a.sel.anchor;if(c){var f=Dc(b,e);f!=Dc(c,e)?(e=b,b=c):f!=Dc(b,c)&&(b=c)}Lc(a,e,b,d)}else Lc(a,b,c||b,d);a.cm&&(a.cm.curOp.userSelChange=!0)}function Kc(a,b,c){var d={anchor:b,head:c};return Ne(a,"beforeSelectionChange",a,d),a.cm&&Ne(a.cm,"beforeSelectionChange",a.cm,d),d.anchor=Gc(a,d.anchor),d.head=Gc(a,d.head),d}function Lc(a,b,c,d,e){if(!e&&Te(a,"beforeSelectionChange")||a.cm&&Te(a.cm,"beforeSelectionChange")){var f=Kc(a,b,c);c=f.head,b=f.anchor}var g=a.sel;if(g.goalColumn=null,null==d&&(d=Dc(c,g.head)?-1:1),(e||!Cc(b,g.anchor))&&(b=Nc(a,b,d,"push"!=e)),(e||!Cc(c,g.head))&&(c=Nc(a,c,d,"push"!=e)),!Cc(g.anchor,b)||!Cc(g.head,c)){g.anchor=b,g.head=c;var h=Dc(c,b);g.from=h?c:b,g.to=h?b:c,a.cm&&(a.cm.curOp.updateInput=a.cm.curOp.selectionChanged=a.cm.curOp.cursorActivity=!0),Qe(a,"cursorActivity",a)}}function Mc(a){Lc(a.doc,a.doc.sel.from,a.doc.sel.to,null,"push")}function Nc(a,b,c,d){var e=!1,f=b,g=c||1;a.cantEdit=!1;a:for(;;){var h=le(a,f.line);if(h.markedSpans)for(var i=0;i<h.markedSpans.length;++i){var j=h.markedSpans[i],k=j.marker;if((null==j.from||(k.inclusiveLeft?j.from<=f.ch:j.from<f.ch))&&(null==j.to||(k.inclusiveRight?j.to>=f.ch:j.to>f.ch))){if(d&&(Ne(k,"beforeCursorEnter"),k.explicitlyCleared)){if(h.markedSpans){--i;continue}break}if(!k.atomic)continue;var l=k.find()[0>g?"from":"to"];if(Cc(l,f)&&(l.ch+=g,l.ch<0?l=l.line>a.first?Gc(a,Bc(l.line-1)):null:l.ch>h.text.length&&(l=l.line<a.first+a.size-1?Bc(l.line+1,0):null),!l)){if(e)return d?(a.cantEdit=!0,Bc(a.first,0)):Nc(a,b,c,!0);e=!0,l=b,g=-g}f=l;continue a}}return f}}function Oc(a){var b=Pc(a,a.doc.sel.head,null,a.options.cursorScrollMargin);if(a.state.focused){var c=a.display,d=pf(c.sizer),e=null;if(b.top+d.top<0?e=!0:b.bottom+d.top>(window.innerHeight||document.documentElement.clientHeight)&&(e=!1),null!=e&&!n){var f="none"==c.cursor.style.display;f&&(c.cursor.style.display="",c.cursor.style.left=b.left+"px",c.cursor.style.top=b.top-c.viewOffset+"px"),c.cursor.scrollIntoView(e),f&&(c.cursor.style.display="none")}}}function Pc(a,b,c,d){for(null==d&&(d=0);;){var e=!1,f=vb(a,b),g=c&&c!=b?vb(a,c):f,h=Rc(a,Math.min(f.left,g.left),Math.min(f.top,g.top)-d,Math.max(f.left,g.left),Math.max(f.bottom,g.bottom)+d),i=a.doc.scrollTop,j=a.doc.scrollLeft;if(null!=h.scrollTop&&(_b(a,h.scrollTop),Math.abs(a.doc.scrollTop-i)>1&&(e=!0)),null!=h.scrollLeft&&(ac(a,h.scrollLeft),Math.abs(a.doc.scrollLeft-j)>1&&(e=!0)),!e)return f}}function Qc(a,b,c,d,e){var f=Rc(a,b,c,d,e);null!=f.scrollTop&&_b(a,f.scrollTop),null!=f.scrollLeft&&ac(a,f.scrollLeft)}function Rc(a,b,c,d,e){var f=a.display,g=Ab(a.display);0>c&&(c=0);var h=f.scroller.clientHeight-Ve,i=f.scroller.scrollTop,j={},k=a.doc.height+gb(f),l=g>c,m=e>k-g;if(i>c)j.scrollTop=l?0:c;else if(e>i+h){var n=Math.min(c,(m?k:e)-h);n!=i&&(j.scrollTop=n)}var o=f.scroller.clientWidth-Ve,p=f.scroller.scrollLeft;b+=f.gutters.offsetWidth,d+=f.gutters.offsetWidth;var q=f.gutters.offsetWidth,r=q+10>b;return p+q>b||r?(r&&(b=0),j.scrollLeft=Math.max(0,b-10-q)):d>o+p-3&&(j.scrollLeft=d+10-o),j}function Sc(a,b,c){a.curOp.updateScrollPos={scrollLeft:null==b?a.doc.scrollLeft:b,scrollTop:null==c?a.doc.scrollTop:c}}function Tc(a,b,c){var d=a.curOp.updateScrollPos||(a.curOp.updateScrollPos={scrollLeft:a.doc.scrollLeft,scrollTop:a.doc.scrollTop}),e=a.display.scroller;d.scrollTop=Math.max(0,Math.min(e.scrollHeight-e.clientHeight,d.scrollTop+c)),d.scrollLeft=Math.max(0,Math.min(e.scrollWidth-e.clientWidth,d.scrollLeft+b))}function Uc(a,b,c,d){var e=a.doc;if(null==c&&(c="add"),"smart"==c)if(a.doc.mode.indent)var f=eb(a,b);else c="prev";var k,g=a.options.tabSize,h=le(e,b),i=Ye(h.text,null,g),j=h.text.match(/^\s*/)[0];if("smart"==c&&(k=a.doc.mode.indent(f,h.text.slice(j.length),h.text),k==We)){if(!d)return;c="prev"}"prev"==c?k=b>e.first?Ye(le(e,b-1).text,null,g):0:"add"==c?k=i+a.options.indentUnit:"subtract"==c?k=i-a.options.indentUnit:"number"==typeof c&&(k=i+c),k=Math.max(0,k);var l="",m=0;if(a.options.indentWithTabs)for(var n=Math.floor(k/g);n;--n)m+=g,l+=" ";k>m&&(l+=$e(k-m)),l!=j?Ac(a.doc,l,Bc(b,0),Bc(b,j.length),"+input"):e.sel.head.line==b&&e.sel.head.ch<j.length&&Lc(e,Bc(b,j.length),Bc(b,j.length),1),h.stateAfter=null}function Vc(a,b,c){var d=b,e=b,f=a.doc;return"number"==typeof b?e=le(f,Fc(f,b)):d=pe(b),null==d?null:c(e,d)?(Ib(a,d,d+1),e):null}function Wc(a,b,c,d,e){function k(){var b=f+c;return b<a.first||b>=a.first+a.size?j=!1:(f=b,i=le(a,b))}function l(a){var b=(e?Lf:Mf)(i,g,c,!0);if(null==b){if(a||!k())return j=!1;g=e?(0>c?Ef:Df)(i):0>c?i.text.length:0}else g=b;return!0}var f=b.line,g=b.ch,h=c,i=le(a,f),j=!0;if("char"==d)l();else if("column"==d)l(!0);else if("word"==d||"group"==d)for(var m=null,n="group"==d,o=!0;!(0>c)||l(!o);o=!1){var p=i.text.charAt(g)||"\n",q=hf(p)?"w":n?/\s/.test(p)?null:"p":null;if(m&&m!=q){0>c&&(c=1,l());break}if(q&&(m=q),c>0&&!l(!o))break}var r=Nc(a,Bc(f,g),h,!0);return j||(r.hitSide=!0),r}function Xc(a,b,c,d){var g,e=a.doc,f=b.left;if("page"==d){var h=Math.min(a.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight);g=b.top+c*(h-(0>c?1.5:.5)*Ab(a.display))}else"line"==d&&(g=c>0?b.bottom+3:b.top-3);for(;;){var i=xb(a,f,g);if(!i.outside)break;if(0>c?0>=g:g>=e.height){i.hitSide=!0;break}g+=5*c}return i}function Yc(a,b){var c=b.ch,d=b.ch;if(a){(b.xRel<0||d==a.length)&&c?--c:++d;for(var e=a.charAt(c),f=hf(e)?hf:/\s/.test(e)?function(a){return/\s/.test(a)}:function(a){return!/\s/.test(a)&&!hf(a)};c>0&&f(a.charAt(c-1));)--c;for(;d<a.length&&f(a.charAt(d));)++d}return{from:Bc(b.line,c),to:Bc(b.line,d)}}function Zc(a,b){Jc(a.doc,Bc(b,0),Gc(a.doc,Bc(b+1,0)))}function ad(a,b,c,d){x.defaults[a]=b,c&&($c[a]=d?function(a,b,d){d!=bd&&c(a,b,d)}:c)}function hd(a,b){if(b===!0)return b;if(a.copyState)return a.copyState(b);var c={};for(var d in b){var e=b[d];e instanceof Array&&(e=e.concat([])),c[d]=e}return c}function id(a,b,c){return a.startState?a.startState(b,c):!0}function ld(a){return"string"==typeof a?kd[a]:a}function md(a,b,c){function d(b){b=ld(b);var e=b[a];if(e===!1)return"stop";if(null!=e&&c(e))return!0;if(b.nofallthrough)return"stop";var f=b.fallthrough;if(null==f)return!1;if("[object Array]"!=Object.prototype.toString.call(f))return d(f);for(var g=0,h=f.length;h>g;++g){var i=d(f[g]);if(i)return i}return!1}for(var e=0;e<b.length;++e){var f=d(b[e]);if(f)return"stop"!=f}}function nd(a){var b=zf[a.keyCode];return"Ctrl"==b||"Alt"==b||"Shift"==b||"Mod"==b}function od(a,b){if(i&&34==a.keyCode&&a["char"])return!1;var c=zf[a.keyCode];return null==c||a.altGraphKey?!1:(a.altKey&&(c="Alt-"+c),(t?a.metaKey:a.ctrlKey)&&(c="Ctrl-"+c),(t?a.ctrlKey:a.metaKey)&&(c="Cmd-"+c),!b&&a.shiftKey&&(c="Shift-"+c),c)}function pd(a,b){this.pos=this.start=0,this.string=a,this.tabSize=b||8,this.lastColumnPos=this.lastColumnValue=0}function qd(a,b){this.lines=[],this.type=b,this.doc=a}function rd(a,b,c,d,e){if(d&&d.shared)return td(a,b,c,d,e);if(a.cm&&!a.cm.curOp)return Fb(a.cm,rd)(a,b,c,d,e);var f=new qd(a,e);if(Dc(c,b)||Cc(b,c)&&"range"==e&&(!d.inclusiveLeft||!d.inclusiveRight))return f;d&&df(d,f),f.replacedWith&&(f.collapsed=!0,f.replacedWith=lf("span",[f.replacedWith],"CodeMirror-widget"),d.handleMouseEvents||(f.replacedWith.ignoreEvents=!0)),f.collapsed&&(w=!0),f.addToHistory&&we(a,{from:b,to:c,origin:"markText"},{head:a.sel.head,anchor:a.sel.anchor},0/0);var i,j,l,g=b.line,h=0,k=a.cm;if(a.iter(g,c.line+1,function(d){k&&f.collapsed&&!k.options.lineWrapping&&Fd(a,d)==k.display.maxLine&&(l=!0);var e={from:null,to:null,marker:f};h+=d.text.length,g==b.line&&(e.from=b.ch,h-=b.ch),g==c.line&&(e.to=c.ch,h-=d.text.length-c.ch),f.collapsed&&(g==c.line&&(j=Cd(d,c.ch)),g==b.line?i=Cd(d,b.ch):oe(d,0)),wd(d,e),++g}),f.collapsed&&a.iter(b.line,c.line+1,function(b){Gd(a,b)&&oe(b,0)}),f.clearOnEnter&&Le(f,"beforeCursorEnter",function(){f.clear()}),f.readOnly&&(v=!0,(a.history.done.length||a.history.undone.length)&&a.clearHistory()),f.collapsed){if(i!=j)throw new Error("Inserting collapsed marker overlapping an existing one");f.size=h,f.atomic=!0}return k&&(l&&(k.curOp.updateMaxLine=!0),(f.className||f.title||f.startStyle||f.endStyle||f.collapsed)&&Ib(k,b.line,c.line+1),f.atomic&&Mc(k)),f}function sd(a,b){this.markers=a,this.primary=b;for(var c=0,d=this;c<a.length;++c)a[c].parent=this,Le(a[c],"clear",function(){d.clear()})}function td(a,b,c,d,e){d=df(d),d.shared=!1;var f=[rd(a,b,c,d,e)],g=f[0],h=d.replacedWith;return je(a,function(a){h&&(d.replacedWith=h.cloneNode(!0)),f.push(rd(a,Gc(a,b),Gc(a,c),d,e));for(var i=0;i<a.linked.length;++i)if(a.linked[i].isParent)return;g=_e(f)}),new sd(f,g)}function ud(a,b){if(a)for(var c=0;c<a.length;++c){var d=a[c];if(d.marker==b)return d}}function vd(a,b){for(var c,d=0;d<a.length;++d)a[d]!=b&&(c||(c=[])).push(a[d]);return c}function wd(a,b){a.markedSpans=a.markedSpans?a.markedSpans.concat([b]):[b],b.marker.attachLine(a)}function xd(a,b,c){if(a)for(var e,d=0;d<a.length;++d){var f=a[d],g=f.marker,h=null==f.from||(g.inclusiveLeft?f.from<=b:f.from<b);if(h||(g.inclusiveLeft&&g.inclusiveRight||"bookmark"==g.type)&&f.from==b&&(!c||!f.marker.insertLeft)){var i=null==f.to||(g.inclusiveRight?f.to>=b:f.to>b);(e||(e=[])).push({from:f.from,to:i?null:f.to,marker:g})}}return e}function yd(a,b,c){if(a)for(var e,d=0;d<a.length;++d){var f=a[d],g=f.marker,h=null==f.to||(g.inclusiveRight?f.to>=b:f.to>b);if(h||"bookmark"==g.type&&f.from==b&&(!c||f.marker.insertLeft)){var i=null==f.from||(g.inclusiveLeft?f.from<=b:f.from<b);(e||(e=[])).push({from:i?null:f.from-b,to:null==f.to?null:f.to-b,marker:g})}}return e}function zd(a,b){var c=Ic(a,b.from.line)&&le(a,b.from.line).markedSpans,d=Ic(a,b.to.line)&&le(a,b.to.line).markedSpans;if(!c&&!d)return null;var e=b.from.ch,f=b.to.ch,g=Cc(b.from,b.to),h=xd(c,e,g),i=yd(d,f,g),j=1==b.text.length,k=_e(b.text).length+(j?e:0);if(h)for(var l=0;l<h.length;++l){var m=h[l];if(null==m.to){var n=ud(i,m.marker);n?j&&(m.to=null==n.to?null:n.to+k):m.to=e}}if(i)for(var l=0;l<i.length;++l){var m=i[l];if(null!=m.to&&(m.to+=k),null==m.from){var n=ud(h,m.marker);n||(m.from=k,j&&(h||(h=[])).push(m))}else m.from+=k,j&&(h||(h=[])).push(m)}if(j&&h){for(var l=0;l<h.length;++l)null!=h[l].from&&h[l].from==h[l].to&&"bookmark"!=h[l].marker.type&&h.splice(l--,1);h.length||(h=null)}var o=[h];if(!j){var q,p=b.text.length-2;if(p>0&&h)for(var l=0;l<h.length;++l)null==h[l].to&&(q||(q=[])).push({from:null,to:null,marker:h[l].marker});for(var l=0;p>l;++l)o.push(q);o.push(i)}return o}function Ad(a,b){var c=ye(a,b),d=zd(a,b);if(!c)return d;if(!d)return c;for(var e=0;e<c.length;++e){var f=c[e],g=d[e];if(f&&g)a:for(var h=0;h<g.length;++h){for(var i=g[h],j=0;j<f.length;++j)if(f[j].marker==i.marker)continue a;f.push(i)}else g&&(c[e]=g)}return c}function Bd(a,b,c){var d=null;if(a.iter(b.line,c.line+1,function(a){if(a.markedSpans)for(var b=0;b<a.markedSpans.length;++b){var c=a.markedSpans[b].marker;!c.readOnly||d&&-1!=bf(d,c)||(d||(d=[])).push(c)}}),!d)return null;for(var e=[{from:b,to:c}],f=0;f<d.length;++f)for(var g=d[f],h=g.find(),i=0;i<e.length;++i){var j=e[i];if(!Dc(j.to,h.from)&&!Dc(h.to,j.from)){var k=[i,1];(Dc(j.from,h.from)||!g.inclusiveLeft&&Cc(j.from,h.from))&&k.push({from:j.from,to:h.from}),(Dc(h.to,j.to)||!g.inclusiveRight&&Cc(j.to,h.to))&&k.push({from:h.to,to:j.to}),e.splice.apply(e,k),i+=k.length-1}}return e}function Cd(a,b){var d,c=w&&a.markedSpans;if(c)for(var e,f=0;f<c.length;++f)e=c[f],e.marker.collapsed&&(null==e.from||e.from<b)&&(null==e.to||e.to>b)&&(!d||d.width<e.marker.width)&&(d=e.marker);return d}function Dd(a){return Cd(a,-1)}function Ed(a){return Cd(a,a.text.length+1)}function Fd(a,b){for(var c;c=Dd(b);)b=le(a,c.find().from.line);return b}function Gd(a,b){var c=w&&b.markedSpans;if(c)for(var d,e=0;e<c.length;++e)if(d=c[e],d.marker.collapsed){if(null==d.from)return!0;if(!d.marker.replacedWith&&0==d.from&&d.marker.inclusiveLeft&&Hd(a,b,d))return!0}}function Hd(a,b,c){if(null==c.to){var d=c.marker.find().to,e=le(a,d.line);return Hd(a,e,ud(e.markedSpans,c.marker))}if(c.marker.inclusiveRight&&c.to==b.text.length)return!0;for(var f,g=0;g<b.markedSpans.length;++g)if(f=b.markedSpans[g],f.marker.collapsed&&!f.marker.replacedWith&&f.from==c.to&&(f.marker.inclusiveLeft||c.marker.inclusiveRight)&&Hd(a,b,f))return!0}function Id(a){var b=a.markedSpans;if(b){for(var c=0;c<b.length;++c)b[c].marker.detachLine(a);a.markedSpans=null}}function Jd(a,b){if(b){for(var c=0;c<b.length;++c)b[c].marker.attachLine(a);a.markedSpans=b}}function Ld(a){return function(){var b=!this.cm.curOp;b&&Db(this.cm);try{var c=a.apply(this,arguments)}finally{b&&Eb(this.cm)}return c}}function Md(a){return null!=a.height?a.height:(a.node.parentNode&&1==a.node.parentNode.nodeType||nf(a.cm.display.measure,lf("div",[a.node],null,"position: relative")),a.height=a.node.offsetHeight)}function Nd(a,b,c,d){var e=new Kd(a,c,d);return e.noHScroll&&(a.display.alignWidgets=!0),Vc(a,b,function(b){var c=b.widgets||(b.widgets=[]);if(null==e.insertAt?c.push(e):c.splice(Math.min(c.length-1,Math.max(0,e.insertAt)),0,e),e.line=b,!Gd(a.doc,b)||e.showIfHidden){var d=re(a,b)<a.doc.scrollTop;oe(b,b.height+Md(e)),d&&Tc(a,0,e.height)}return!0}),e}function Pd(a,b,c,d){a.text=b,a.stateAfter&&(a.stateAfter=null),a.styles&&(a.styles=null),null!=a.order&&(a.order=null),Id(a),Jd(a,c);var e=d?d(a):1;e!=a.height&&oe(a,e)}function Qd(a){a.parent=null,Id(a)}function Rd(a,b,c,d,e){var f=c.flattenSpans;null==f&&(f=a.options.flattenSpans);var j,g=0,h=null,i=new pd(b,a.options.tabSize);for(""==b&&c.blankLine&&c.blankLine(d);!i.eol();)i.pos>a.options.maxHighlightLength?(f=!1,i.pos=b.length,j=null):j=c.token(i,d),f&&h==j||(g<i.start&&e(i.start,h),g=i.start,h=j),i.start=i.pos;for(;g<i.pos;){var k=Math.min(i.pos,g+5e4);e(k,h),g=k}}function Sd(a,b,c){var d=[a.state.modeGen];Rd(a,b.text,a.doc.mode,c,function(a,b){d.push(a,b)});for(var e=0;e<a.state.overlays.length;++e){var f=a.state.overlays[e],g=1,h=0;Rd(a,b.text,f.mode,!0,function(a,b){for(var c=g;a>h;){var e=d[g];e>a&&d.splice(g,1,a,d[g+1],e),g+=2,h=Math.min(a,e)}if(b)if(f.opaque)d.splice(c,g-c,a,b),g=c+2;else for(;g>c;c+=2){var i=d[c+1];d[c+1]=i?i+" "+b:b}})}return d}function Td(a,b){return b.styles&&b.styles[0]==a.state.modeGen||(b.styles=Sd(a,b,b.stateAfter=eb(a,pe(b)))),b.styles}function Ud(a,b,c){var d=a.doc.mode,e=new pd(b.text,a.options.tabSize);for(""==b.text&&d.blankLine&&d.blankLine(c);!e.eol()&&e.pos<=a.options.maxHighlightLength;)d.token(e,c),e.start=e.pos}function Wd(a,b){if(!a)return null;for(;;){var c=a.match(/(?:^|\s)line-(background-)?(\S+)/);if(!c)break;a=a.slice(0,c.index)+a.slice(c.index+c[0].length);var d=c[1]?"bgClass":"textClass";null==b[d]?b[d]=c[2]:new RegExp("(?:^|s)"+c[2]+"(?:$|s)").test(b[d])||(b[d]+=" "+c[2])}return Vd[a]||(Vd[a]="cm-"+a.replace(/ +/g," cm-"))}function Xd(a,c,d,g){for(var h,i=c,j=!0;h=Dd(i);)i=le(a.doc,h.find().from.line);var k={pre:lf("pre"),col:0,pos:0,measure:null,measuredSomething:!1,cm:a,copyWidgets:g};do{i.text&&(j=!1),k.measure=i==c&&d,k.pos=0,k.addToken=k.measure?$d:Zd,(b||f)&&a.getOption("lineWrapping")&&(k.addToken=_d(k.addToken));var l=be(i,k,Td(a,i));d&&i==c&&!k.measuredSomething&&(d[0]=k.pre.appendChild(vf(a.display.measure)),k.measuredSomething=!0),l&&(i=le(a.doc,l.to.line))}while(l);!d||k.measuredSomething||d[0]||(d[0]=k.pre.appendChild(j?lf("span","\xa0"):vf(a.display.measure))),k.pre.firstChild||Gd(a.doc,c)||k.pre.appendChild(document.createTextNode("\xa0"));var m;if(d&&(b||e)&&(m=se(i))){var n=m.length-1;m[n].from==m[n].to&&--n;var o=m[n],p=m[n-1];if(o.from+1==o.to&&p&&o.level<p.level){var q=d[k.pos-1];q&&q.parentNode.insertBefore(q.measureRight=vf(a.display.measure),q.nextSibling)}}var r=k.textClass?k.textClass+" "+(c.textClass||""):c.textClass;return r&&(k.pre.className=r),Ne(a,"renderLine",a,c,k.pre),k}function Zd(a,b,c,d,e,f){if(b){if(Yd.test(b))for(var g=document.createDocumentFragment(),h=0;;){Yd.lastIndex=h;var i=Yd.exec(b),j=i?i.index-h:b.length-h;if(j&&(g.appendChild(document.createTextNode(b.slice(h,h+j))),a.col+=j),!i)break;if(h+=j+1," "==i[0]){var k=a.cm.options.tabSize,l=k-a.col%k;g.appendChild(lf("span",$e(l),"cm-tab")),a.col+=l}else{var m=lf("span","\u2022","cm-invalidchar");m.title="\\u"+i[0].charCodeAt(0).toString(16),g.appendChild(m),a.col+=1}}else{a.col+=b.length;var g=document.createTextNode(b)}if(c||d||e||a.measure){var n=c||"";d&&(n+=d),e&&(n+=e);var m=lf("span",[g],n);return f&&(m.title=f),a.pre.appendChild(m)}a.pre.appendChild(g)}}function $d(a,c,d,e,f){for(var g=a.cm.options.lineWrapping,h=0;h<c.length;++h){var i=c.charAt(h),j=0==h;i>="\ud800"&&"\udbff">i&&h<c.length-1?(i=c.slice(h,h+2),++h):h&&g&&rf(c,h)&&a.pre.appendChild(lf("wbr"));var k=a.measure[a.pos],l=a.measure[a.pos]=Zd(a,i,d,j&&e,h==c.length-1&&f);k&&(l.leftSide=k.leftSide||k),b&&g&&" "==i&&h&&!/\s/.test(c.charAt(h-1))&&h<c.length-1&&!/\s/.test(c.charAt(h+1))&&(l.style.whiteSpace="normal"),a.pos+=i.length}c.length&&(a.measuredSomething=!0)}function _d(a){function b(a){for(var b=" ",c=0;c<a.length-2;++c)b+=c%2?" ":"\xa0";return b+=" "}return function(c,d,e,f,g,h){return a(c,d.replace(/ {3,}/g,b),e,f,g,h)}}function ae(a,b,c,d){var e=!d&&c.replacedWith;if(e&&(a.copyWidgets&&(e=e.cloneNode(!0)),a.pre.appendChild(e),a.measure)){if(b)a.measure[a.pos]=e;else{var f=vf(a.cm.display.measure);if("bookmark"!=c.type||c.insertLeft){if(a.measure[a.pos])return;a.measure[a.pos]=a.pre.insertBefore(f,e)}else a.measure[a.pos]=a.pre.appendChild(f)}a.measuredSomething=!0}a.pos+=b}function be(a,b,c){var d=a.markedSpans,e=a.text,f=0;if(d)for(var k,m,n,o,p,q,h=e.length,i=0,g=1,j="",l=0;;){if(l==i){m=n=o=p="",q=null,l=1/0;for(var r=[],s=0;s<d.length;++s){var t=d[s],u=t.marker;t.from<=i&&(null==t.to||t.to>i)?(null!=t.to&&l>t.to&&(l=t.to,n=""),u.className&&(m+=" "+u.className),u.startStyle&&t.from==i&&(o+=" "+u.startStyle),u.endStyle&&t.to==l&&(n+=" "+u.endStyle),u.title&&!p&&(p=u.title),u.collapsed&&(!q||q.marker.size<u.size)&&(q=t)):t.from>i&&l>t.from&&(l=t.from),"bookmark"==u.type&&t.from==i&&u.replacedWith&&r.push(u)}if(q&&(q.from||0)==i&&(ae(b,(null==q.to?h:q.to)-i,q.marker,null==q.from),null==q.to))return q.marker.find();if(!q&&r.length)for(var s=0;s<r.length;++s)ae(b,0,r[s])}if(i>=h)break;for(var v=Math.min(h,l);;){if(j){var w=i+j.length;if(!q){var x=w>v?j.slice(0,v-i):j;b.addToken(b,x,k?k+m:m,o,i+x.length==l?n:"",p)}if(w>=v){j=j.slice(v-i),i=v;break}i=w,o=""}j=e.slice(f,f=c[g++]),k=Wd(c[g++],b)}}else for(var g=1;g<c.length;g+=2)b.addToken(b,e.slice(f,f=c[g]),Wd(c[g+1],b))}function ce(a,b,c,d,e){function f(a){return c?c[a]:null}function g(a,c,d){Pd(a,c,d,e),Qe(a,"change",a,b)}var h=b.from,i=b.to,j=b.text,k=le(a,h.line),l=le(a,i.line),m=_e(j),n=f(j.length-1),o=i.line-h.line;if(0==h.ch&&0==i.ch&&""==m){for(var p=0,q=j.length-1,r=[];q>p;++p)r.push(new Od(j[p],f(p),e));g(l,l.text,n),o&&a.remove(h.line,o),r.length&&a.insert(h.line,r)}else if(k==l)if(1==j.length)g(k,k.text.slice(0,h.ch)+m+k.text.slice(i.ch),n);else{for(var r=[],p=1,q=j.length-1;q>p;++p)r.push(new Od(j[p],f(p),e));r.push(new Od(m+k.text.slice(i.ch),n,e)),g(k,k.text.slice(0,h.ch)+j[0],f(0)),a.insert(h.line+1,r)}else if(1==j.length)g(k,k.text.slice(0,h.ch)+j[0]+l.text.slice(i.ch),f(0)),a.remove(h.line+1,o);else{g(k,k.text.slice(0,h.ch)+j[0],f(0)),g(l,m+l.text.slice(i.ch),n);for(var p=1,q=j.length-1,r=[];q>p;++p)r.push(new Od(j[p],f(p),e));o>1&&a.remove(h.line+1,o-1),a.insert(h.line+1,r)}Qe(a,"change",a,b),Lc(a,d.anchor,d.head,null,!0)}function de(a){this.lines=a,this.parent=null;for(var b=0,c=a.length,d=0;c>b;++b)a[b].parent=this,d+=a[b].height;this.height=d}function ee(a){this.children=a;for(var b=0,c=0,d=0,e=a.length;e>d;++d){var f=a[d];b+=f.chunkSize(),c+=f.height,f.parent=this}this.size=b,this.height=c,this.parent=null}function je(a,b,c){function d(a,e,f){if(a.linked)for(var g=0;g<a.linked.length;++g){var h=a.linked[g];if(h.doc!=e){var i=f&&h.sharedHist;(!c||i)&&(b(h.doc,i),d(h.doc,a,i))}}}d(a,null,!0)}function ke(a,b){if(b.cm)throw new Error("This document is already in use.");a.doc=b,b.cm=a,C(a),z(a),a.options.lineWrapping||I(a),a.options.mode=b.modeOption,Ib(a)}function le(a,b){for(b-=a.first;!a.lines;)for(var c=0;;++c){var d=a.children[c],e=d.chunkSize();if(e>b){a=d;break}b-=e}return a.lines[b]}function me(a,b,c){var d=[],e=b.line;return a.iter(b.line,c.line+1,function(a){var f=a.text;e==c.line&&(f=f.slice(0,c.ch)),e==b.line&&(f=f.slice(b.ch)),d.push(f),++e}),d}function ne(a,b,c){var d=[];return a.iter(b,c,function(a){d.push(a.text)}),d}function oe(a,b){for(var c=b-a.height,d=a;d;d=d.parent)d.height+=c}function pe(a){if(null==a.parent)return null;for(var b=a.parent,c=bf(b.lines,a),d=b.parent;d;b=d,d=d.parent)for(var e=0;d.children[e]!=b;++e)c+=d.children[e].chunkSize();return c+b.first}function qe(a,b){var c=a.first;a:do{for(var d=0,e=a.children.length;e>d;++d){var f=a.children[d],g=f.height;if(g>b){a=f;continue a}b-=g,c+=f.chunkSize()}return c}while(!a.lines);for(var d=0,e=a.lines.length;e>d;++d){var h=a.lines[d],i=h.height;if(i>b)break;b-=i}return c+d}function re(a,b){b=Fd(a.doc,b);for(var c=0,d=b.parent,e=0;e<d.lines.length;++e){var f=d.lines[e];if(f==b)break;c+=f.height}for(var g=d.parent;g;d=g,g=d.parent)for(var e=0;e<g.children.length;++e){var h=g.children[e];if(h==d)break;c+=h.height}return c}function se(a){var b=a.order;return null==b&&(b=a.order=Nf(a.text)),b}function te(a){return{done:[],undone:[],undoDepth:1/0,lastTime:0,lastOp:null,lastOrigin:null,generation:a||1,maxGeneration:a||1}}function ue(a,b,c,d){var e=b["spans_"+a.id],f=0;a.iter(Math.max(a.first,c),Math.min(a.first+a.size,d),function(c){c.markedSpans&&((e||(e=b["spans_"+a.id]={}))[f]=c.markedSpans),++f})}function ve(a,b){var c={line:b.from.line,ch:b.from.ch},d={from:c,to:qc(b),text:me(a,b.from,b.to)};return ue(a,d,b.from.line,b.to.line+1),je(a,function(a){ue(a,d,b.from.line,b.to.line+1)},!0),d}function we(a,b,c,d){var e=a.history;e.undone.length=0;var f=+new Date,g=_e(e.done);if(g&&(e.lastOp==d||e.lastOrigin==b.origin&&b.origin&&("+"==b.origin.charAt(0)&&a.cm&&e.lastTime>f-a.cm.options.historyEventDelay||"*"==b.origin.charAt(0)))){var h=_e(g.changes);Cc(b.from,b.to)&&Cc(b.from,h.to)?h.to=qc(b):g.changes.push(ve(a,b)),g.anchorAfter=c.anchor,g.headAfter=c.head}else for(g={changes:[ve(a,b)],generation:e.generation,anchorBefore:a.sel.anchor,headBefore:a.sel.head,anchorAfter:c.anchor,headAfter:c.head},e.done.push(g),e.generation=++e.maxGeneration;e.done.length>e.undoDepth;)e.done.shift();e.lastTime=f,e.lastOp=d,e.lastOrigin=b.origin}function xe(a){if(!a)return null;for(var c,b=0;b<a.length;++b)a[b].marker.explicitlyCleared?c||(c=a.slice(0,b)):c&&c.push(a[b]);return c?c.length?c:null:a}function ye(a,b){var c=b["spans_"+a.id];if(!c)return null;for(var d=0,e=[];d<b.text.length;++d)e.push(xe(c[d]));return e}function ze(a,b){for(var c=0,d=[];c<a.length;++c){var e=a[c],f=e.changes,g=[];d.push({changes:g,anchorBefore:e.anchorBefore,headBefore:e.headBefore,anchorAfter:e.anchorAfter,headAfter:e.headAfter});for(var h=0;h<f.length;++h){var j,i=f[h];if(g.push({from:i.from,to:i.to,text:i.text}),b)for(var k in i)(j=k.match(/^spans_(\d+)$/))&&bf(b,Number(j[1]))>-1&&(_e(g)[k]=i[k],delete i[k])}}return d}function Ae(a,b,c,d){c<a.line?a.line+=d:b<a.line&&(a.line=b,a.ch=0)}function Be(a,b,c,d){for(var e=0;e<a.length;++e){for(var f=a[e],g=!0,h=0;h<f.changes.length;++h){var i=f.changes[h];if(f.copied||(i.from=Ec(i.from),i.to=Ec(i.to)),c<i.from.line)i.from.line+=d,i.to.line+=d;else if(b<=i.to.line){g=!1;break}}f.copied||(f.anchorBefore=Ec(f.anchorBefore),f.headBefore=Ec(f.headBefore),f.anchorAfter=Ec(f.anchorAfter),f.readAfter=Ec(f.headAfter),f.copied=!0),g?(Ae(f.anchorBefore),Ae(f.headBefore),Ae(f.anchorAfter),Ae(f.headAfter)):(a.splice(0,e+1),e=0)}}function Ce(a,b){var c=b.from.line,d=b.to.line,e=b.text.length-(d-c)-1;Be(a.done,c,d,e),Be(a.undone,c,d,e)}function De(){Ie(this)}function Ee(a){return a.stop||(a.stop=De),a}function Fe(a){a.preventDefault?a.preventDefault():a.returnValue=!1}function Ge(a){a.stopPropagation?a.stopPropagation():a.cancelBubble=!0}function He(a){return null!=a.defaultPrevented?a.defaultPrevented:0==a.returnValue}function Ie(a){Fe(a),Ge(a)}function Je(a){return a.target||a.srcElement}function Ke(a){var b=a.which;return null==b&&(1&a.button?b=1:2&a.button?b=3:4&a.button&&(b=2)),q&&a.ctrlKey&&1==b&&(b=3),b}function Le(a,b,c){if(a.addEventListener)a.addEventListener(b,c,!1);else if(a.attachEvent)a.attachEvent("on"+b,c);else{var d=a._handlers||(a._handlers={}),e=d[b]||(d[b]=[]);e.push(c)}}function Me(a,b,c){if(a.removeEventListener)a.removeEventListener(b,c,!1);else if(a.detachEvent)a.detachEvent("on"+b,c);else{var d=a._handlers&&a._handlers[b];if(!d)return;for(var e=0;e<d.length;++e)if(d[e]==c){d.splice(e,1);break}}}function Ne(a,b){var c=a._handlers&&a._handlers[b];if(c)for(var d=Array.prototype.slice.call(arguments,2),e=0;e<c.length;++e)c[e].apply(null,d)}function Qe(a,b){function e(a){return function(){a.apply(null,d)}}var c=a._handlers&&a._handlers[b];if(c){var d=Array.prototype.slice.call(arguments,2);Oe||(++Pe,Oe=[],setTimeout(Se,0));for(var f=0;f<c.length;++f)Oe.push(e(c[f]))}}function Re(a,b,c){return Ne(a,c||b.type,a,b),He(b)||b.codemirrorIgnore}function Se(){--Pe;var a=Oe;Oe=null;for(var b=0;b<a.length;++b)a[b]()}function Te(a,b){var c=a._handlers&&a._handlers[b];return c&&c.length>0}function Ue(a){a.prototype.on=function(a,b){Le(this,a,b)},a.prototype.off=function(a,b){Me(this,a,b)}}function Xe(){this.id=null}function Ye(a,b,c,d,e){null==b&&(b=a.search(/[^\s\u00a0]/),-1==b&&(b=a.length));for(var f=d||0,g=e||0;b>f;++f)" "==a.charAt(f)?g+=c-g%c:++g;return g}function $e(a){for(;Ze.length<=a;)Ze.push(_e(Ze)+" ");return Ze[a]}function _e(a){return a[a.length-1]}function af(a){if(o)a.selectionStart=0,a.selectionEnd=a.value.length;else try{a.select()}catch(b){}}function bf(a,b){if(a.indexOf)return a.indexOf(b);for(var c=0,d=a.length;d>c;++c)if(a[c]==b)return c;return-1}function cf(a,b){function c(){}c.prototype=a;var d=new c;return b&&df(b,d),d}function df(a,b){b||(b={});for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}function ef(a){for(var b=[],c=0;a>c;++c)b.push(void 0);return b}function ff(a){var b=Array.prototype.slice.call(arguments,1);return function(){return a.apply(null,b)}}function hf(a){return/\w/.test(a)||a>"\x80"&&(a.toUpperCase()!=a.toLowerCase()||gf.test(a))}function jf(a){for(var b in a)if(a.hasOwnProperty(b)&&a[b])return!1;return!0}function lf(a,b,c,d){var e=document.createElement(a);if(c&&(e.className=c),d&&(e.style.cssText=d),"string"==typeof b)of(e,b);else if(b)for(var f=0;f<b.length;++f)e.appendChild(b[f]);return e}function mf(a){for(var b=a.childNodes.length;b>0;--b)a.removeChild(a.firstChild);return a}function nf(a,b){return mf(a).appendChild(b)}function of(a,b){d?(a.innerHTML="",a.appendChild(document.createTextNode(b))):a.textContent=b}function pf(a){return a.getBoundingClientRect()}function rf(){return!1}function tf(a){if(null!=sf)return sf;var b=lf("div",null,null,"width: 50px; height: 50px; overflow-x: scroll");return nf(a,b),b.offsetWidth&&(sf=b.offsetHeight-b.clientHeight),sf||0}function vf(a){if(null==uf){var b=lf("span","\u200b");nf(a,lf("span",[b,document.createTextNode("x")])),0!=a.firstChild.offsetHeight&&(uf=b.offsetWidth<=1&&b.offsetHeight>2&&!c)}return uf?lf("span","\u200b"):lf("span","\xa0",null,"display: inline-block; width: 1px; margin-right: -1px")}function Af(a,b,c,d){if(!a)return d(b,c,"ltr");for(var e=!1,f=0;f<a.length;++f){var g=a[f];(g.from<c&&g.to>b||b==c&&g.to==b)&&(d(Math.max(g.from,b),Math.min(g.to,c),1==g.level?"rtl":"ltr"),e=!0)}e||d(b,c,"ltr")}function Bf(a){return a.level%2?a.to:a.from}function Cf(a){return a.level%2?a.from:a.to}function Df(a){var b=se(a);return b?Bf(b[0]):0}function Ef(a){var b=se(a);return b?Cf(_e(b)):a.text.length}function Ff(a,b){var c=le(a.doc,b),d=Fd(a.doc,c);d!=c&&(b=pe(d));var e=se(d),f=e?e[0].level%2?Ef(d):Df(d):0;return Bc(b,f)}function Gf(a,b){for(var c,d;c=Ed(d=le(a.doc,b));)b=c.find().to.line;var e=se(d),f=e?e[0].level%2?Df(d):Ef(d):d.text.length;return Bc(b,f)}function Hf(a,b,c){var d=a[0].level;return b==d?!0:c==d?!1:c>b}function Jf(a,b){for(var d,c=0;c<a.length;++c){var e=a[c];if(e.from<b&&e.to>b)return If=null,c;if(e.from==b||e.to==b){if(null!=d)return Hf(a,e.level,a[d].level)?(If=d,c):(If=c,d);d=c}}return If=null,d}function Kf(a,b,c,d){if(!d)return b+c;do b+=c;while(b>0&&kf.test(a.text.charAt(b)));return b}function Lf(a,b,c,d){var e=se(a);if(!e)return Mf(a,b,c,d);for(var f=Jf(e,b),g=e[f],h=Kf(a,b,g.level%2?-c:c,d);;){if(h>g.from&&h<g.to)return h;if(h==g.from||h==g.to)return Jf(e,h)==f?h:(g=e[f+=c],c>0==g.level%2?g.to:g.from);if(g=e[f+=c],!g)return null;h=c>0==g.level%2?Kf(a,g.to,-1,d):Kf(a,g.from,1,d)}}function Mf(a,b,c,d){var e=b+c;if(d)for(;e>0&&kf.test(a.text.charAt(e));)e+=c;return 0>e||e>a.text.length?null:e}var a=/gecko\/\d/i.test(navigator.userAgent),b=/MSIE \d/.test(navigator.userAgent),c=b&&(null==document.documentMode||document.documentMode<8),d=b&&(null==document.documentMode||document.documentMode<9),e=/Trident\/([7-9]|\d{2,})\./,f=/WebKit\//.test(navigator.userAgent),g=f&&/Qt\/\d+\.\d+/.test(navigator.userAgent),h=/Chrome\//.test(navigator.userAgent),i=/Opera\//.test(navigator.userAgent),j=/Apple Computer/.test(navigator.vendor),k=/KHTML\//.test(navigator.userAgent),l=/Mac OS X 1\d\D([7-9]|\d\d)\D/.test(navigator.userAgent),m=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(navigator.userAgent),n=/PhantomJS/.test(navigator.userAgent),o=/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent),p=o||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(navigator.userAgent),q=o||/Mac/.test(navigator.platform),r=/win/i.test(navigator.platform),s=i&&navigator.userAgent.match(/Version\/(\d*\.\d*)/);s&&(s=Number(s[1])),s&&s>=15&&(i=!1,f=!0);var zb,Sb,Tb,t=q&&(g||i&&(null==s||12.11>s)),u=a||b&&!d,v=!1,w=!1,Cb=0,Yb=0,bc=0,cc=null;b?cc=-.53:a?cc=15:h?cc=-.7:j&&(cc=-1/3);var gc,oc,jc=null,qc=x.changeEnd=function(a){return a.text?Bc(a.from.line+a.text.length-1,_e(a.text).length+(1==a.text.length?a.from.ch:0)):a.to};x.Pos=Bc,x.prototype={constructor:x,focus:function(){window.focus(),Nb(this),mc(this),Kb(this)},setOption:function(a,b){var c=this.options,d=c[a];(c[a]!=b||"mode"==a)&&(c[a]=b,$c.hasOwnProperty(a)&&Fb(this,$c[a])(this,b,d))},getOption:function(a){return this.options[a]},getDoc:function(){return this.doc},addKeyMap:function(a,b){this.state.keyMaps[b?"push":"unshift"](a)},removeKeyMap:function(a){for(var b=this.state.keyMaps,c=0;c<b.length;++c)if(b[c]==a||"string"!=typeof b[c]&&b[c].name==a)return b.splice(c,1),!0},addOverlay:Fb(null,function(a,b){var c=a.token?a:x.getMode(this.options,a);if(c.startState)throw new Error("Overlays may not be stateful.");this.state.overlays.push({mode:c,modeSpec:a,opaque:b&&b.opaque}),this.state.modeGen++,Ib(this)}),removeOverlay:Fb(null,function(a){for(var b=this.state.overlays,c=0;c<b.length;++c){var d=b[c].modeSpec;if(d==a||"string"==typeof a&&d.name==a)return b.splice(c,1),this.state.modeGen++,Ib(this),void 0}}),indentLine:Fb(null,function(a,b,c){"string"!=typeof b&&"number"!=typeof b&&(b=null==b?this.options.smartIndent?"smart":"prev":b?"add":"subtract"),Ic(this.doc,a)&&Uc(this,a,b,c)}),indentSelection:Fb(null,function(a){var b=this.doc.sel;if(Cc(b.from,b.to))return Uc(this,b.from.line,a);for(var c=b.to.line-(b.to.ch?0:1),d=b.from.line;c>=d;++d)Uc(this,d,a)}),getTokenAt:function(a,b){var c=this.doc;a=Gc(c,a);for(var d=eb(this,a.line,b),e=this.doc.mode,f=le(c,a.line),g=new pd(f.text,this.options.tabSize);g.pos<a.ch&&!g.eol();){g.start=g.pos;var h=e.token(g,d)}return{start:g.start,end:g.pos,string:g.current(),className:h||null,type:h||null,state:d}},getTokenTypeAt:function(a){a=Gc(this.doc,a);var b=Td(this,le(this.doc,a.line)),c=0,d=(b.length-1)/2,e=a.ch;if(0==e)return b[2];for(;;){var f=c+d>>1;if((f?b[2*f-1]:0)>=e)d=f;else{if(!(b[2*f+1]<e))return b[2*f+2];c=f+1}}},getModeAt:function(a){var b=this.doc.mode;return b.innerMode?x.innerMode(b,this.getTokenAt(a).state).mode:b},getHelper:function(a,b){if(gd.hasOwnProperty(b)){var c=gd[b],d=this.getModeAt(a);return d[b]&&c[d[b]]||d.helperType&&c[d.helperType]||c[d.name]}},getStateAfter:function(a,b){var c=this.doc;return a=Fc(c,null==a?c.first+c.size-1:a),eb(this,a+1,b)},cursorCoords:function(a,b){var c,d=this.doc.sel;return c=null==a?d.head:"object"==typeof a?Gc(this.doc,a):a?d.from:d.to,vb(this,c,b||"page")},charCoords:function(a,b){return ub(this,Gc(this.doc,a),b||"page")},coordsChar:function(a,b){return a=tb(this,a,b||"page"),xb(this,a.left,a.top)},lineAtHeight:function(a,b){return a=tb(this,{top:a,left:0},b||"page").top,qe(this.doc,a+this.display.viewOffset)},heightAtLine:function(a,b){var c=!1,d=this.doc.first+this.doc.size-1;a<this.doc.first?a=this.doc.first:a>d&&(a=d,c=!0);var e=le(this.doc,a);return sb(this,le(this.doc,a),{top:0,left:0},b||"page").top+(c?e.height:0)},defaultTextHeight:function(){return Ab(this.display)},defaultCharWidth:function(){return Bb(this.display)},setGutterMarker:Fb(null,function(a,b,c){return Vc(this,a,function(a){var d=a.gutterMarkers||(a.gutterMarkers={});return d[b]=c,!c&&jf(d)&&(a.gutterMarkers=null),!0})}),clearGutter:Fb(null,function(a){var b=this,c=b.doc,d=c.first;c.iter(function(c){c.gutterMarkers&&c.gutterMarkers[a]&&(c.gutterMarkers[a]=null,Ib(b,d,d+1),jf(c.gutterMarkers)&&(c.gutterMarkers=null)),++d})}),addLineClass:Fb(null,function(a,b,c){return Vc(this,a,function(a){var d="text"==b?"textClass":"background"==b?"bgClass":"wrapClass";if(a[d]){if(new RegExp("(?:^|\\s)"+c+"(?:$|\\s)").test(a[d]))return!1;a[d]+=" "+c}else a[d]=c;return!0})}),removeLineClass:Fb(null,function(a,b,c){return Vc(this,a,function(a){var d="text"==b?"textClass":"background"==b?"bgClass":"wrapClass",e=a[d];if(!e)return!1;if(null==c)a[d]=null;else{var f=e.match(new RegExp("(?:^|\\s+)"+c+"(?:$|\\s+)"));if(!f)return!1;var g=f.index+f[0].length;a[d]=e.slice(0,f.index)+(f.index&&g!=e.length?" ":"")+e.slice(g)||null}return!0})}),addLineWidget:Fb(null,function(a,b,c){return Nd(this,a,b,c)}),removeLineWidget:function(a){a.clear()},lineInfo:function(a){if("number"==typeof a){if(!Ic(this.doc,a))return null;var b=a;if(a=le(this.doc,a),!a)return null}else{var b=pe(a);if(null==b)return null}return{line:b,handle:a,text:a.text,gutterMarkers:a.gutterMarkers,textClass:a.textClass,bgClass:a.bgClass,wrapClass:a.wrapClass,widgets:a.widgets}},getViewport:function(){return{from:this.display.showingFrom,to:this.display.showingTo}},addWidget:function(a,b,c,d,e){var f=this.display;a=vb(this,Gc(this.doc,a));var g=a.bottom,h=a.left;if(b.style.position="absolute",f.sizer.appendChild(b),"over"==d)g=a.top;else if("above"==d||"near"==d){var i=Math.max(f.wrapper.clientHeight,this.doc.height),j=Math.max(f.sizer.clientWidth,f.lineSpace.clientWidth);("above"==d||a.bottom+b.offsetHeight>i)&&a.top>b.offsetHeight?g=a.top-b.offsetHeight:a.bottom+b.offsetHeight<=i&&(g=a.bottom),h+b.offsetWidth>j&&(h=j-b.offsetWidth)}b.style.top=g+"px",b.style.left=b.style.right="","right"==e?(h=f.sizer.clientWidth-b.offsetWidth,b.style.right="0px"):("left"==e?h=0:"middle"==e&&(h=(f.sizer.clientWidth-b.offsetWidth)/2),b.style.left=h+"px"),c&&Qc(this,h,g,h+b.offsetWidth,g+b.offsetHeight)},triggerOnKeyDown:Fb(null,kc),execCommand:function(a){return jd[a](this)},findPosH:function(a,b,c,d){var e=1;0>b&&(e=-1,b=-b);for(var f=0,g=Gc(this.doc,a);b>f&&(g=Wc(this.doc,g,e,c,d),!g.hitSide);++f);return g},moveH:Fb(null,function(a,b){var d,c=this.doc.sel;d=c.shift||c.extend||Cc(c.from,c.to)?Wc(this.doc,c.head,a,b,this.options.rtlMoveVisually):0>a?c.from:c.to,Jc(this.doc,d,d,a)}),deleteH:Fb(null,function(a,b){var c=this.doc.sel;Cc(c.from,c.to)?Ac(this.doc,"",c.from,Wc(this.doc,c.head,a,b,!1),"+delete"):Ac(this.doc,"",c.from,c.to,"+delete"),this.curOp.userSelChange=!0}),findPosV:function(a,b,c,d){var e=1,f=d;0>b&&(e=-1,b=-b);for(var g=0,h=Gc(this.doc,a);b>g;++g){var i=vb(this,h,"div");if(null==f?f=i.left:i.left=f,h=Xc(this,i,e,c),h.hitSide)break}return h},moveV:Fb(null,function(a,b){var c=this.doc.sel,d=vb(this,c.head,"div");null!=c.goalColumn&&(d.left=c.goalColumn);var e=Xc(this,d,a,b);"page"==b&&Tc(this,0,ub(this,e,"div").top-d.top),Jc(this.doc,e,e,a),c.goalColumn=d.left}),toggleOverwrite:function(a){(null==a||a!=this.state.overwrite)&&((this.state.overwrite=!this.state.overwrite)?this.display.cursor.className+=" CodeMirror-overwrite":this.display.cursor.className=this.display.cursor.className.replace(" CodeMirror-overwrite",""))},hasFocus:function(){return this.state.focused},scrollTo:Fb(null,function(a,b){Sc(this,a,b)}),getScrollInfo:function(){var a=this.display.scroller,b=Ve;return{left:a.scrollLeft,top:a.scrollTop,height:a.scrollHeight-b,width:a.scrollWidth-b,clientHeight:a.clientHeight-b,clientWidth:a.clientWidth-b}},scrollIntoView:Fb(null,function(a,b){null==a?a={from:this.doc.sel.head,to:null}:"number"==typeof a?a={from:Bc(a,0),to:null}:null==a.from&&(a={from:a,to:null}),a.to||(a.to=a.from),b||(b=0);var c=a;null!=a.from.line&&(this.curOp.scrollToPos={from:a.from,to:a.to,margin:b},c={from:vb(this,a.from),to:vb(this,a.to)});var d=Rc(this,Math.min(c.from.left,c.to.left),Math.min(c.from.top,c.to.top)-b,Math.max(c.from.right,c.to.right),Math.max(c.from.bottom,c.to.bottom)+b);Sc(this,d.scrollLeft,d.scrollTop)}),setSize:Fb(null,function(a,b){function c(a){return"number"==typeof a||/^\d+$/.test(String(a))?a+"px":a}null!=a&&(this.display.wrapper.style.width=c(a)),null!=b&&(this.display.wrapper.style.height=c(b)),this.options.lineWrapping&&(this.display.measureLineCache.length=this.display.measureLineCachePos=0),this.curOp.forceUpdate=!0}),operation:function(a){return Hb(this,a)},refresh:Fb(null,function(){var a=null==this.display.cachedTextHeight;pb(this),Sc(this,this.doc.scrollLeft,this.doc.scrollTop),Ib(this),a&&C(this)}),swapDoc:Fb(null,function(a){var b=this.doc;return b.cm=null,ke(this,a),pb(this),Mb(this,!0),Sc(this,a.scrollLeft,a.scrollTop),Qe(this,"swapDoc",this,b),b}),getInputField:function(){return this.display.input},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},Ue(x);var $c=x.optionHandlers={},_c=x.defaults={},bd=x.Init={toString:function(){return"CodeMirror.Init"}};ad("value","",function(a,b){a.setValue(b)},!0),ad("mode",null,function(a,b){a.doc.modeOption=b,z(a)},!0),ad("indentUnit",2,z,!0),ad("indentWithTabs",!1),ad("smartIndent",!0),ad("tabSize",4,function(a){z(a),pb(a),Ib(a)},!0),ad("electricChars",!0),ad("rtlMoveVisually",!r),ad("theme","default",function(a){E(a),F(a)},!0),ad("keyMap","default",D),ad("extraKeys",null),ad("onKeyEvent",null),ad("onDragEvent",null),ad("lineWrapping",!1,A,!0),ad("gutters",[],function(a){J(a.options),F(a)},!0),ad("fixedGutter",!0,function(a,b){a.display.gutters.style.left=b?P(a.display)+"px":"0",a.refresh()},!0),ad("coverGutterNextToScrollbar",!1,K,!0),ad("lineNumbers",!1,function(a){J(a.options),F(a)},!0),ad("firstLineNumber",1,F,!0),ad("lineNumberFormatter",function(a){return a},F,!0),ad("showCursorWhenSelecting",!1,Z,!0),ad("resetSelectionOnContextMenu",!0),ad("readOnly",!1,function(a,b){"nocursor"==b?(nc(a),a.display.input.blur(),a.display.disabled=!0):(a.display.disabled=!1,b||Mb(a,!0))}),ad("dragDrop",!0),ad("cursorBlinkRate",530),ad("cursorScrollMargin",0),ad("cursorHeight",1),ad("workTime",100),ad("workDelay",100),ad("flattenSpans",!0),ad("pollInterval",100),ad("undoDepth",40,function(a,b){a.doc.history.undoDepth=b}),ad("historyEventDelay",500),ad("viewportMargin",10,function(a){a.refresh()},!0),ad("maxHighlightLength",1e4,function(a){z(a),a.refresh()},!0),ad("crudeMeasuringFrom",1e4),ad("moveInputWithCursor",!0,function(a,b){b||(a.display.inputDiv.style.top=a.display.inputDiv.style.left=0)}),ad("tabindex",null,function(a,b){a.display.input.tabIndex=b||""}),ad("autofocus",null);var cd=x.modes={},dd=x.mimeModes={};x.defineMode=function(a,b){if(x.defaults.mode||"null"==a||(x.defaults.mode=a),arguments.length>2){b.dependencies=[];for(var c=2;c<arguments.length;++c)b.dependencies.push(arguments[c])}cd[a]=b},x.defineMIME=function(a,b){dd[a]=b},x.resolveMode=function(a){if("string"==typeof a&&dd.hasOwnProperty(a))a=dd[a];else if(a&&"string"==typeof a.name&&dd.hasOwnProperty(a.name)){var b=dd[a.name];a=cf(b,a),a.name=b.name}else if("string"==typeof a&&/^[\w\-]+\/[\w\-]+\+xml$/.test(a))return x.resolveMode("application/xml");return"string"==typeof a?{name:a}:a||{name:"null"}},x.getMode=function(a,b){var b=x.resolveMode(b),c=cd[b.name];if(!c)return x.getMode(a,"text/plain");var d=c(a,b);if(ed.hasOwnProperty(b.name)){var e=ed[b.name];for(var f in e)e.hasOwnProperty(f)&&(d.hasOwnProperty(f)&&(d["_"+f]=d[f]),d[f]=e[f])}return d.name=b.name,d},x.defineMode("null",function(){return{token:function(a){a.skipToEnd()}}}),x.defineMIME("text/plain","null");var ed=x.modeExtensions={};x.extendMode=function(a,b){var c=ed.hasOwnProperty(a)?ed[a]:ed[a]={};df(b,c)},x.defineExtension=function(a,b){x.prototype[a]=b},x.defineDocExtension=function(a,b){ge.prototype[a]=b},x.defineOption=ad;var fd=[];x.defineInitHook=function(a){fd.push(a)};var gd=x.helpers={};x.registerHelper=function(a,b,c){gd.hasOwnProperty(a)||(gd[a]=x[a]={}),gd[a][b]=c},x.isWordChar=hf,x.copyState=hd,x.startState=id,x.innerMode=function(a,b){for(;a.innerMode;){var c=a.innerMode(b);if(!c||c.mode==a)break;b=c.state,a=c.mode}return c||{mode:a,state:b}};var jd=x.commands={selectAll:function(a){a.setSelection(Bc(a.firstLine(),0),Bc(a.lastLine()))},killLine:function(a){var b=a.getCursor(!0),c=a.getCursor(!1),d=!Cc(b,c);d||a.getLine(b.line).length!=b.ch?a.replaceRange("",b,d?c:Bc(b.line),"+delete"):a.replaceRange("",b,Bc(b.line+1,0),"+delete")},deleteLine:function(a){var b=a.getCursor().line;a.replaceRange("",Bc(b,0),Bc(b),"+delete")},delLineLeft:function(a){var b=a.getCursor();a.replaceRange("",Bc(b.line,0),b,"+delete")},undo:function(a){a.undo()},redo:function(a){a.redo()},goDocStart:function(a){a.extendSelection(Bc(a.firstLine(),0))},goDocEnd:function(a){a.extendSelection(Bc(a.lastLine()))},goLineStart:function(a){a.extendSelection(Ff(a,a.getCursor().line))},goLineStartSmart:function(a){var b=a.getCursor(),c=Ff(a,b.line),d=a.getLineHandle(c.line),e=se(d);if(e&&0!=e[0].level)a.extendSelection(c);else{var f=Math.max(0,d.text.search(/\S/)),g=b.line==c.line&&b.ch<=f&&b.ch;a.extendSelection(Bc(c.line,g?0:f))}},goLineEnd:function(a){a.extendSelection(Gf(a,a.getCursor().line))},goLineRight:function(a){var b=a.charCoords(a.getCursor(),"div").top+5;a.extendSelection(a.coordsChar({left:a.display.lineDiv.offsetWidth+100,top:b},"div"))},goLineLeft:function(a){var b=a.charCoords(a.getCursor(),"div").top+5;a.extendSelection(a.coordsChar({left:0,top:b},"div"))},goLineUp:function(a){a.moveV(-1,"line")},goLineDown:function(a){a.moveV(1,"line")},goPageUp:function(a){a.moveV(-1,"page")},goPageDown:function(a){a.moveV(1,"page")},goCharLeft:function(a){a.moveH(-1,"char")},goCharRight:function(a){a.moveH(1,"char")},goColumnLeft:function(a){a.moveH(-1,"column")},goColumnRight:function(a){a.moveH(1,"column")},goWordLeft:function(a){a.moveH(-1,"word")},goGroupRight:function(a){a.moveH(1,"group")},goGroupLeft:function(a){a.moveH(-1,"group")},goWordRight:function(a){a.moveH(1,"word")},delCharBefore:function(a){a.deleteH(-1,"char")},delCharAfter:function(a){a.deleteH(1,"char")},delWordBefore:function(a){a.deleteH(-1,"word")},delWordAfter:function(a){a.deleteH(1,"word")},delGroupBefore:function(a){a.deleteH(-1,"group")},delGroupAfter:function(a){a.deleteH(1,"group")},indentAuto:function(a){a.indentSelection("smart")},indentMore:function(a){a.indentSelection("add")},indentLess:function(a){a.indentSelection("subtract")},insertTab:function(a){a.replaceSelection(" ","end","+input")},defaultTab:function(a){a.somethingSelected()?a.indentSelection("add"):a.replaceSelection(" ","end","+input")},transposeChars:function(a){var b=a.getCursor(),c=a.getLine(b.line);b.ch>0&&b.ch<c.length-1&&a.replaceRange(c.charAt(b.ch)+c.charAt(b.ch-1),Bc(b.line,b.ch-1),Bc(b.line,b.ch+1))},newlineAndIndent:function(a){Fb(a,function(){a.replaceSelection("\n","end","+input"),a.indentLine(a.getCursor().line,null,!0)})()},toggleOverwrite:function(a){a.toggleOverwrite()}},kd=x.keyMap={};kd.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite"},kd.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Alt-Up":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Down":"goDocEnd","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore",fallthrough:"basic"},kd.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineStart","Cmd-Right":"goLineEnd","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delLineLeft",fallthrough:["basic","emacsy"]},kd["default"]=q?kd.macDefault:kd.pcDefault,kd.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars"},x.lookupKey=md,x.isModifierKey=nd,x.keyName=od,x.fromTextArea=function(a,b){function e(){a.value=i.getValue()}if(b||(b={}),b.value=a.value,!b.tabindex&&a.tabindex&&(b.tabindex=a.tabindex),!b.placeholder&&a.placeholder&&(b.placeholder=a.placeholder),null==b.autofocus){var c=document.body;try{c=document.activeElement}catch(d){}b.autofocus=c==a||null!=a.getAttribute("autofocus")&&c==document.body}if(a.form&&(Le(a.form,"submit",e),!b.leaveSubmitMethodAlone)){var f=a.form,g=f.submit;try{var h=f.submit=function(){e(),f.submit=g,f.submit(),f.submit=h}}catch(d){}}a.style.display="none";var i=x(function(b){a.parentNode.insertBefore(b,a.nextSibling)},b);return i.save=e,i.getTextArea=function(){return a},i.toTextArea=function(){e(),a.parentNode.removeChild(i.getWrapperElement()),a.style.display="",a.form&&(Me(a.form,"submit",e),"function"==typeof a.form.submit&&(a.form.submit=g))},i},pd.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return 0==this.pos},peek:function(){return this.string.charAt(this.pos)||void 0},next:function(){return this.pos<this.string.length?this.string.charAt(this.pos++):void 0},eat:function(a){var b=this.string.charAt(this.pos);if("string"==typeof a)var c=b==a;else var c=b&&(a.test?a.test(b):a(b));return c?(++this.pos,b):void 0},eatWhile:function(a){for(var b=this.pos;this.eat(a););return this.pos>b},eatSpace:function(){for(var a=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>a},skipToEnd:function(){this.pos=this.string.length},skipTo:function(a){var b=this.string.indexOf(a,this.pos);return b>-1?(this.pos=b,!0):void 0},backUp:function(a){this.pos-=a},column:function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=Ye(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue},indentation:function(){return Ye(this.string,null,this.tabSize)},match:function(a,b,c){if("string"!=typeof a){var f=this.string.slice(this.pos).match(a);return f&&f.index>0?null:(f&&b!==!1&&(this.pos+=f[0].length),f)}var d=function(a){return c?a.toLowerCase():a},e=this.string.substr(this.pos,a.length);return d(e)==d(a)?(b!==!1&&(this.pos+=a.length),!0):void 0},current:function(){return this.string.slice(this.start,this.pos)}},x.StringStream=pd,x.TextMarker=qd,Ue(qd),qd.prototype.clear=function(){if(!this.explicitlyCleared){var a=this.doc.cm,b=a&&!a.curOp;if(b&&Db(a),Te(this,"clear")){var c=this.find();c&&Qe(this,"clear",c.from,c.to)}for(var d=null,e=null,f=0;f<this.lines.length;++f){var g=this.lines[f],h=ud(g.markedSpans,this);null!=h.to&&(e=pe(g)),g.markedSpans=vd(g.markedSpans,h),null!=h.from?d=pe(g):this.collapsed&&!Gd(this.doc,g)&&a&&oe(g,Ab(a.display))}if(a&&this.collapsed&&!a.options.lineWrapping)for(var f=0;f<this.lines.length;++f){var i=Fd(a.doc,this.lines[f]),j=H(a.doc,i);j>a.display.maxLineLength&&(a.display.maxLine=i,a.display.maxLineLength=j,a.display.maxLineChanged=!0)}null!=d&&a&&Ib(a,d,e+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,a&&Mc(a)),b&&Eb(a)}},qd.prototype.find=function(){for(var a,b,c=0;c<this.lines.length;++c){var d=this.lines[c],e=ud(d.markedSpans,this);if(null!=e.from||null!=e.to){var f=pe(d);null!=e.from&&(a=Bc(f,e.from)),null!=e.to&&(b=Bc(f,e.to))}}return"bookmark"==this.type?a:a&&{from:a,to:b}},qd.prototype.changed=function(){var a=this.find(),b=this.doc.cm;if(a&&b){"bookmark"!=this.type&&(a=a.from);var c=le(this.doc,a.line);if(kb(b,c),a.line>=b.display.showingFrom&&a.line<b.display.showingTo){for(var d=b.display.lineDiv.firstChild;d;d=d.nextSibling)if(d.lineObj==c){d.offsetHeight!=c.height&&oe(c,d.offsetHeight);break}Hb(b,function(){b.curOp.selectionChanged=b.curOp.forceUpdate=b.curOp.updateMaxLine=!0})}}},qd.prototype.attachLine=function(a){if(!this.lines.length&&this.doc.cm){var b=this.doc.cm.curOp;b.maybeHiddenMarkers&&-1!=bf(b.maybeHiddenMarkers,this)||(b.maybeUnhiddenMarkers||(b.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(a)},qd.prototype.detachLine=function(a){if(this.lines.splice(bf(this.lines,a),1),!this.lines.length&&this.doc.cm){var b=this.doc.cm.curOp;(b.maybeHiddenMarkers||(b.maybeHiddenMarkers=[])).push(this)}},x.SharedTextMarker=sd,Ue(sd),sd.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var a=0;a<this.markers.length;++a)this.markers[a].clear();Qe(this,"clear")}},sd.prototype.find=function(){return this.primary.find()};var Kd=x.LineWidget=function(a,b,c){if(c)for(var d in c)c.hasOwnProperty(d)&&(this[d]=c[d]);this.cm=a,this.node=b};Ue(Kd),Kd.prototype.clear=Ld(function(){var a=this.line.widgets,b=pe(this.line);if(null!=b&&a){for(var c=0;c<a.length;++c)a[c]==this&&a.splice(c--,1);a.length||(this.line.widgets=null);var d=re(this.cm,this.line)<this.cm.doc.scrollTop;oe(this.line,Math.max(0,this.line.height-Md(this))),d&&Tc(this.cm,0,-this.height),Ib(this.cm,b,b+1)}}),Kd.prototype.changed=Ld(function(){var a=this.height;this.height=null;var b=Md(this)-a;if(b){oe(this.line,this.line.height+b);var c=pe(this.line);Ib(this.cm,c,c+1)}});var Od=x.Line=function(a,b,c){this.text=a,Jd(this,b),this.height=c?c(this):1};Ue(Od);var Vd={},Yd=/[\t\u0000-\u0019\u00ad\u200b\u2028\u2029\uFEFF]/g;de.prototype={chunkSize:function(){return this.lines.length},removeInner:function(a,b){for(var c=a,d=a+b;d>c;++c){var e=this.lines[c];this.height-=e.height,Qd(e),Qe(e,"delete")}this.lines.splice(a,b)},collapse:function(a){a.splice.apply(a,[a.length,0].concat(this.lines))},insertInner:function(a,b,c){this.height+=c,this.lines=this.lines.slice(0,a).concat(b).concat(this.lines.slice(a));for(var d=0,e=b.length;e>d;++d)b[d].parent=this},iterN:function(a,b,c){for(var d=a+b;d>a;++a)if(c(this.lines[a]))return!0}},ee.prototype={chunkSize:function(){return this.size},removeInner:function(a,b){this.size-=b;for(var c=0;c<this.children.length;++c){var d=this.children[c],e=d.chunkSize();if(e>a){var f=Math.min(b,e-a),g=d.height;if(d.removeInner(a,f),this.height-=g-d.height,e==f&&(this.children.splice(c--,1),d.parent=null),0==(b-=f))break;a=0}else a-=e}if(this.size-b<25){var h=[];this.collapse(h),this.children=[new de(h)],this.children[0].parent=this}},collapse:function(a){for(var b=0,c=this.children.length;c>b;++b)this.children[b].collapse(a)},insertInner:function(a,b,c){this.size+=b.length,this.height+=c;for(var d=0,e=this.children.length;e>d;++d){var f=this.children[d],g=f.chunkSize();if(g>=a){if(f.insertInner(a,b,c),f.lines&&f.lines.length>50){for(;f.lines.length>50;){var h=f.lines.splice(f.lines.length-25,25),i=new de(h);f.height-=i.height,this.children.splice(d+1,0,i),i.parent=this}this.maybeSpill()}break}a-=g}},maybeSpill:function(){if(!(this.children.length<=10)){var a=this;do{var b=a.children.splice(a.children.length-5,5),c=new ee(b);if(a.parent){a.size-=c.size,a.height-=c.height;var e=bf(a.parent.children,a);a.parent.children.splice(e+1,0,c)}else{var d=new ee(a.children);d.parent=a,a.children=[d,c],a=d}c.parent=a.parent}while(a.children.length>10);a.parent.maybeSpill()}},iterN:function(a,b,c){for(var d=0,e=this.children.length;e>d;++d){var f=this.children[d],g=f.chunkSize();if(g>a){var h=Math.min(b,g-a);if(f.iterN(a,h,c))return!0;if(0==(b-=h))break;a=0}else a-=g}}};var fe=0,ge=x.Doc=function(a,b,c){if(!(this instanceof ge))return new ge(a,b,c);null==c&&(c=0),ee.call(this,[new de([new Od("",null)])]),this.first=c,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.history=te(),this.cleanGeneration=1,this.frontier=c;var d=Bc(c,0);this.sel={from:d,to:d,head:d,anchor:d,shift:!1,extend:!1,goalColumn:null},this.id=++fe,this.modeOption=b,"string"==typeof a&&(a=wf(a)),ce(this,{from:d,to:d,text:a},null,{head:d,anchor:d})};ge.prototype=cf(ee.prototype,{constructor:ge,iter:function(a,b,c){c?this.iterN(a-this.first,b-a,c):this.iterN(this.first,this.first+this.size,a)},insert:function(a,b){for(var c=0,d=0,e=b.length;e>d;++d)c+=b[d].height;this.insertInner(a-this.first,b,c)},remove:function(a,b){this.removeInner(a-this.first,b)},getValue:function(a){var b=ne(this,this.first,this.first+this.size);return a===!1?b:b.join(a||"\n")},setValue:function(a){var b=Bc(this.first,0),c=this.first+this.size-1;uc(this,{from:b,to:Bc(c,le(this,c).text.length),text:wf(a),origin:"setValue"},{head:b,anchor:b},!0)},replaceRange:function(a,b,c,d){b=Gc(this,b),c=c?Gc(this,c):b,Ac(this,a,b,c,d)},getRange:function(a,b,c){var d=me(this,Gc(this,a),Gc(this,b));return c===!1?d:d.join(c||"\n")},getLine:function(a){var b=this.getLineHandle(a);return b&&b.text},setLine:function(a,b){Ic(this,a)&&Ac(this,b,Bc(a,0),Gc(this,Bc(a)))},removeLine:function(a){a?Ac(this,"",Gc(this,Bc(a-1)),Gc(this,Bc(a))):Ac(this,"",Bc(0,0),Gc(this,Bc(1,0)))},getLineHandle:function(a){return Ic(this,a)?le(this,a):void 0},getLineNumber:function(a){return pe(a)},getLineHandleVisualStart:function(a){return"number"==typeof a&&(a=le(this,a)),Fd(this,a)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(a){return Gc(this,a)},getCursor:function(a){var c,b=this.sel;return c=null==a||"head"==a?b.head:"anchor"==a?b.anchor:"end"==a||a===!1?b.to:b.from,Ec(c)},somethingSelected:function(){return!Cc(this.sel.head,this.sel.anchor)},setCursor:Gb(function(a,b,c){var d=Gc(this,"number"==typeof a?Bc(a,b||0):a);c?Jc(this,d):Lc(this,d,d)}),setSelection:Gb(function(a,b,c){Lc(this,Gc(this,a),Gc(this,b||a),c)}),extendSelection:Gb(function(a,b,c){Jc(this,Gc(this,a),b&&Gc(this,b),c)}),getSelection:function(a){return this.getRange(this.sel.from,this.sel.to,a)},replaceSelection:function(a,b,c){uc(this,{from:this.sel.from,to:this.sel.to,text:wf(a),origin:c},b||"around")},undo:Gb(function(){wc(this,"undo")}),redo:Gb(function(){wc(this,"redo")}),setExtending:function(a){this.sel.extend=a},historySize:function(){var a=this.history;return{undo:a.done.length,redo:a.undone.length}},clearHistory:function(){this.history=te(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration()},changeGeneration:function(){return this.history.lastOp=this.history.lastOrigin=null,this.history.generation},isClean:function(a){return this.history.generation==(a||this.cleanGeneration)},getHistory:function(){return{done:ze(this.history.done),undone:ze(this.history.undone)}},setHistory:function(a){var b=this.history=te(this.history.maxGeneration);b.done=a.done.slice(0),b.undone=a.undone.slice(0)},markText:function(a,b,c){return rd(this,Gc(this,a),Gc(this,b),c,"range")},setBookmark:function(a,b){var c={replacedWith:b&&(null==b.nodeType?b.widget:b),insertLeft:b&&b.insertLeft};return a=Gc(this,a),rd(this,a,a,c,"bookmark")},findMarksAt:function(a){a=Gc(this,a);var b=[],c=le(this,a.line).markedSpans;if(c)for(var d=0;d<c.length;++d){var e=c[d];(null==e.from||e.from<=a.ch)&&(null==e.to||e.to>=a.ch)&&b.push(e.marker.parent||e.marker)}return b},getAllMarks:function(){var a=[];return this.iter(function(b){var c=b.markedSpans;if(c)for(var d=0;d<c.length;++d)null!=c[d].from&&a.push(c[d].marker)}),a},posFromIndex:function(a){var b,c=this.first;return this.iter(function(d){var e=d.text.length+1;return e>a?(b=a,!0):(a-=e,++c,void 0)}),Gc(this,Bc(c,b))},indexFromPos:function(a){a=Gc(this,a);var b=a.ch;return a.line<this.first||a.ch<0?0:(this.iter(this.first,a.line,function(a){b+=a.text.length+1}),b)},copy:function(a){var b=new ge(ne(this,this.first,this.first+this.size),this.modeOption,this.first);return b.scrollTop=this.scrollTop,b.scrollLeft=this.scrollLeft,b.sel={from:this.sel.from,to:this.sel.to,head:this.sel.head,anchor:this.sel.anchor,shift:this.sel.shift,extend:!1,goalColumn:this.sel.goalColumn},a&&(b.history.undoDepth=this.history.undoDepth,b.setHistory(this.getHistory())),b},linkedDoc:function(a){a||(a={});var b=this.first,c=this.first+this.size;null!=a.from&&a.from>b&&(b=a.from),null!=a.to&&a.to<c&&(c=a.to);var d=new ge(ne(this,b,c),a.mode||this.modeOption,b);return a.sharedHist&&(d.history=this.history),(this.linked||(this.linked=[])).push({doc:d,sharedHist:a.sharedHist}),d.linked=[{doc:this,isParent:!0,sharedHist:a.sharedHist}],d},unlinkDoc:function(a){if(a instanceof x&&(a=a.doc),this.linked)for(var b=0;b<this.linked.length;++b){var c=this.linked[b];if(c.doc==a){this.linked.splice(b,1),a.unlinkDoc(this);break}}if(a.history==this.history){var d=[a.id];je(a,function(a){d.push(a.id)},!0),a.history=te(),a.history.done=ze(this.history.done,d),a.history.undone=ze(this.history.undone,d)}},iterLinkedDocs:function(a){je(this,a)},getMode:function(){return this.mode},getEditor:function(){return this.cm}}),ge.prototype.eachLine=ge.prototype.iter;var he="iter insert remove copy getEditor".split(" ");for(var ie in ge.prototype)ge.prototype.hasOwnProperty(ie)&&bf(he,ie)<0&&(x.prototype[ie]=function(a){return function(){return a.apply(this.doc,arguments)}}(ge.prototype[ie]));Ue(ge),x.e_stop=Ie,x.e_preventDefault=Fe,x.e_stopPropagation=Ge;var Oe,Pe=0;x.on=Le,x.off=Me,x.signal=Ne;var Ve=30,We=x.Pass={toString:function(){return"CodeMirror.Pass"}};Xe.prototype={set:function(a,b){clearTimeout(this.id),this.id=setTimeout(b,a)}},x.countColumn=Ye;var Ze=[""],gf=/[\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/,kf=/[\u0300-\u036F\u0483-\u0487\u0488-\u0489\u0591-\u05BD\u05BF\u05C1-\u05C2\u05C4-\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7-\u06E8\u06EA-\u06ED\uA66F\uA670-\uA672\uA674-\uA67D\uA69F\udc00-\udfff]/;x.replaceGetRect=function(a){pf=a};var qf=function(){if(d)return!1;var a=lf("div");return"draggable"in a||"dragDrop"in a}();a?rf=function(a,b){return 36==a.charCodeAt(b-1)&&39==a.charCodeAt(b)}:j&&!/Version\/([6-9]|\d\d)\b/.test(navigator.userAgent)?rf=function(a,b){return/\-[^\-?]|\?[^!\'\"\),.\-\/:;\?\]\}]/.test(a.slice(b-1,b+1))}:f&&/Chrome\/(?:29|[3-9]\d|\d\d\d)\./.test(navigator.userAgent)?rf=function(a,b){var c=a.charCodeAt(b-1);return c>=8208&&8212>=c}:f&&(rf=function(a,b){if(b>1&&45==a.charCodeAt(b-1)){if(/\w/.test(a.charAt(b-2))&&/[^\-?\.]/.test(a.charAt(b)))return!0;if(b>2&&/[\d\.,]/.test(a.charAt(b-2))&&/[\d\.,]/.test(a.charAt(b)))return!1}return/[~!#%&*)=+}\]\\|\"\.>,:;][({[<]|-[^\-?\.\u2010-\u201f\u2026]|\?[\w~`@#$%\^&*(_=+{[|><]|\u2026[\w~`@#$%\^&*(_=+{[><]/.test(a.slice(b-1,b+1))});var sf,uf,wf=3!="\n\nb".split(/\n/).length?function(a){for(var b=0,c=[],d=a.length;d>=b;){var e=a.indexOf("\n",b);-1==e&&(e=a.length);var f=a.slice(b,"\r"==a.charAt(e-1)?e-1:e),g=f.indexOf("\r");-1!=g?(c.push(f.slice(0,g)),b+=g+1):(c.push(f),b=e+1)}return c}:function(a){return a.split(/\r\n?|\n/)};x.splitLines=wf;var xf=window.getSelection?function(a){try{return a.selectionStart!=a.selectionEnd}catch(b){return!1}}:function(a){try{var b=a.ownerDocument.selection.createRange()}catch(c){}return b&&b.parentElement()==a?0!=b.compareEndPoints("StartToEnd",b):!1},yf=function(){var a=lf("div");return"oncopy"in a?!0:(a.setAttribute("oncopy","return;"),"function"==typeof a.oncopy)}(),zf={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",91:"Mod",92:"Mod",93:"Mod",109:"-",107:"=",127:"Delete",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63276:"PageUp",63277:"PageDown",63275:"End",63273:"Home",63234:"Left",63232:"Up",63235:"Right",63233:"Down",63302:"Insert",63272:"Delete"};x.keyNames=zf,function(){for(var a=0;10>a;a++)zf[a+48]=String(a);for(var a=65;90>=a;a++)zf[a]=String.fromCharCode(a);for(var a=1;12>=a;a++)zf[a+111]=zf[a+63235]="F"+a}();var If,Nf=function(){function c(c){return 255>=c?a.charAt(c):c>=1424&&1524>=c?"R":c>=1536&&1791>=c?b.charAt(c-1536):c>=1792&&2220>=c?"r":"L"}var a="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLL",b="rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmmrrrrrrrrrrrrrrrrrr",d=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,e=/[stwN]/,f=/[LRr]/,g=/[Lb1n]/,h=/[1n]/,i="L";return function(a){if(!d.test(a))return!1;for(var l,b=a.length,j=[],k=0;b>k;++k)j.push(l=c(a.charCodeAt(k)));for(var k=0,m=i;b>k;++k){var l=j[k];"m"==l?j[k]=m:m=l}for(var k=0,n=i;b>k;++k){var l=j[k];"1"==l&&"r"==n?j[k]="n":f.test(l)&&(n=l,"r"==l&&(j[k]="R"))}for(var k=1,m=j[0];b-1>k;++k){var l=j[k];"+"==l&&"1"==m&&"1"==j[k+1]?j[k]="1":","!=l||m!=j[k+1]||"1"!=m&&"n"!=m||(j[k]=m),m=l}for(var k=0;b>k;++k){var l=j[k];if(","==l)j[k]="N";else if("%"==l){for(var o=k+1;b>o&&"%"==j[o];++o);for(var p=k&&"!"==j[k-1]||b-1>o&&"1"==j[o]?"1":"N",q=k;o>q;++q)j[q]=p;k=o-1}}for(var k=0,n=i;b>k;++k){var l=j[k];"L"==n&&"1"==l?j[k]="L":f.test(l)&&(n=l)}for(var k=0;b>k;++k)if(e.test(j[k])){for(var o=k+1;b>o&&e.test(j[o]);++o);for(var r="L"==(k?j[k-1]:i),s="L"==(b-1>o?j[o]:i),p=r||s?"L":"R",q=k;o>q;++q)j[q]=p;k=o-1}for(var u,t=[],k=0;b>k;)if(g.test(j[k])){var v=k;for(++k;b>k&&g.test(j[k]);++k);t.push({from:v,to:k,level:0})}else{var w=k,x=t.length;for(++k;b>k&&"L"!=j[k];++k);for(var q=w;k>q;)if(h.test(j[q])){q>w&&t.splice(x,0,{from:w,to:q,level:1});var y=q;for(++q;k>q&&h.test(j[q]);++q);t.splice(x,0,{from:y,to:q,level:2}),w=q}else++q;k>w&&t.splice(x,0,{from:w,to:k,level:1})}return 1==t[0].level&&(u=a.match(/^\s+/))&&(t[0].from=u[0].length,t.unshift({from:0,to:u[0].length,level:0})),1==_e(t).level&&(u=a.match(/\s+$/))&&(_e(t).to-=u[0].length,t.push({from:b-u[0].length,to:b,level:0})),t[0].level!=_e(t).level&&t.push({from:b,to:b,level:t[0].level}),t}}();return x.version="3.19.1",x}(),CodeMirror.defineMode("css",function(a,b){"use strict";function l(a,b){return k=b,a}function m(a,b){var c=a.next();if(d[c]){var e=d[c](a,b);if(e!==!1)return e}if("@"==c)return a.eatWhile(/[\w\\\-]/),l("def",a.current());if("="==c)l(null,"compare");else{if(("~"==c||"|"==c)&&a.eat("="))return l(null,"compare");if('"'==c||"'"==c)return b.tokenize=n(c),b.tokenize(a,b);if("#"==c)return a.eatWhile(/[\w\\\-]/),l("atom","hash");if("!"==c)return a.match(/^\s*\w*/),l("keyword","important");if(/\d/.test(c)||"."==c&&a.eat(/\d/))return a.eatWhile(/[\w.%]/),l("number","unit");if("-"!==c)return/[,+>*\/]/.test(c)?l(null,"select-op"):"."==c&&a.match(/^-?[_a-z][_a-z0-9-]*/i)?l("qualifier","qualifier"):":"==c?l("operator",c):/[;{}\[\]\(\)]/.test(c)?l(null,c):"u"==c&&a.match("rl(")?(a.backUp(1),b.tokenize=o,l("property","variable")):(a.eatWhile(/[\w\\\-]/),l("property","variable"));if(/\d/.test(a.peek()))return a.eatWhile(/[\w.%]/),l("number","unit");if(a.match(/^[^-]+-/))return l("meta","meta")}}function n(a,b){return function(c,d){for(var f,e=!1;null!=(f=c.next())&&(f!=a||e);)e=!e&&"\\"==f;return e||(b&&c.backUp(1),d.tokenize=m),l("string","string")}}function o(a,b){return a.next(),b.tokenize=a.match(/\s*[\"\']/,!1)?m:n(")",!0),l(null,"(")}b.propertyKeywords||(b=CodeMirror.resolveMode("text/css"));var c=a.indentUnit||a.tabSize||2,d=b.hooks||{},e=b.atMediaTypes||{},f=b.atMediaFeatures||{},g=b.propertyKeywords||{},h=b.colorKeywords||{},i=b.valueKeywords||{},j=!!b.allowNested,k=null;return{startState:function(a){return{tokenize:m,baseIndent:a||0,stack:[],lastToken:null}},token:function(a,b){if(b.tokenize=b.tokenize||m,b.tokenize==m&&a.eatSpace())return null;var c=b.tokenize(a,b);c&&"string"!=typeof c&&(c=l(c[0],c[1]));var d=b.stack[b.stack.length-1];if("variable"==c)return"variable-definition"==k&&b.stack.push("propertyValue"),b.lastToken="variable-2";if("property"==c){var n=a.current().toLowerCase();"propertyValue"==d?c=i.hasOwnProperty(n)?"string-2":h.hasOwnProperty(n)?"keyword":"variable-2":"rule"==d?g.hasOwnProperty(n)||(c+="error"):"block"==d?c=g.hasOwnProperty(n)?"property":h.hasOwnProperty(n)?"keyword":i.hasOwnProperty(n)?"string-2":"tag":d&&"@media{"!=d?"@media"==d?c=e[a.current()]?"attribute":/^(only|not)$/.test(n)?"keyword":"and"==n?"error":f.hasOwnProperty(n)?"error":"attribute error":"@mediaType"==d?c=e.hasOwnProperty(n)?"attribute":"and"==n?"operator":/^(only|not)$/.test(n)?"error":"error":"@mediaType("==d?g.hasOwnProperty(n)||(e.hasOwnProperty(n)?c="error":"and"==n?c="operator":/^(only|not)$/.test(n)?c="error":c+="error"):c="@import"==d?"tag":"error":c="tag"}else"atom"==c?d&&"@media{"!=d&&"block"!=d?"propertyValue"==d?/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/.test(a.current())||(c+="error"):c="error":c="builtin":"@media"==d&&"{"==k&&(c="error");if("{"==k)if("@media"==d||"@mediaType"==d)b.stack[b.stack.length-1]="@media{";else{var o=j?"block":"rule";b.stack.push(o)}else if("}"==k)for("interpolation"==d&&(c="operator");b.stack.length;){var p=b.stack.pop();if(p.indexOf("{")>-1)break}else if("interpolation"==k)b.stack.push("interpolation");else if("@media"==k)b.stack.push("@media");else if("@import"==k)b.stack.push("@import");else if("@media"==d&&/\b(keyword|attribute)\b/.test(c))b.stack[b.stack.length-1]="@mediaType";else if("@mediaType"==d&&","==a.current())b.stack[b.stack.length-1]="@media";else if("("==k)"@media"==d||"@mediaType"==d?(b.stack[b.stack.length-1]="@mediaType",b.stack.push("@mediaType(")):b.stack.push("(");else if(")"==k)for(;b.stack.length;){var p=b.stack.pop();if(p.indexOf("(")>-1)break}else":"==k&&"property"==b.lastToken?b.stack.push("propertyValue"):"propertyValue"==d&&";"==k?b.stack.pop():"@import"==d&&";"==k&&b.stack.pop();return b.lastToken=c},indent:function(a,b){var d=a.stack.length;return/^\}/.test(b)&&(d-="propertyValue"==a.stack[d-1]?2:1),a.baseIndent+d*c},electricChars:"}",blockCommentStart:"",fold:"brace"}}),function(){function a(a){for(var b={},c=0;c<a.length;++c)b[a[c]]=!0;return b}function g(a,b){for(var d,c=!1;null!=(d=a.next());){if(c&&"/"==d){b.tokenize=null;break}c="*"==d}return["comment","comment"]}var b=a(["all","aural","braille","handheld","print","projection","screen","tty","tv","embossed"]),c=a(["width","min-width","max-width","height","min-height","max-height","device-width","min-device-width","max-device-width","device-height","min-device-height","max-device-height","aspect-ratio","min-aspect-ratio","max-aspect-ratio","device-aspect-ratio","min-device-aspect-ratio","max-device-aspect-ratio","color","min-color","max-color","color-index","min-color-index","max-color-index","monochrome","min-monochrome","max-monochrome","resolution","min-resolution","max-resolution","scan","grid"]),d=a(["align-content","align-items","align-self","alignment-adjust","alignment-baseline","anchor-point","animation","animation-delay","animation-direction","animation-duration","animation-iteration-count","animation-name","animation-play-state","animation-timing-function","appearance","azimuth","backface-visibility","background","background-attachment","background-clip","background-color","background-image","background-origin","background-position","background-repeat","background-size","baseline-shift","binding","bleed","bookmark-label","bookmark-level","bookmark-state","bookmark-target","border","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-decoration-break","box-shadow","box-sizing","break-after","break-before","break-inside","caption-side","clear","clip","color","color-profile","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","content","counter-increment","counter-reset","crop","cue","cue-after","cue-before","cursor","direction","display","dominant-baseline","drop-initial-after-adjust","drop-initial-after-align","drop-initial-before-adjust","drop-initial-before-align","drop-initial-size","drop-initial-value","elevation","empty-cells","fit","fit-position","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","float-offset","flow-from","flow-into","font","font-feature-settings","font-family","font-kerning","font-language-override","font-size","font-size-adjust","font-stretch","font-style","font-synthesis","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-ligatures","font-variant-numeric","font-variant-position","font-weight","grid-cell","grid-column","grid-column-align","grid-column-sizing","grid-column-span","grid-columns","grid-flow","grid-row","grid-row-align","grid-row-sizing","grid-row-span","grid-rows","grid-template","hanging-punctuation","height","hyphens","icon","image-orientation","image-rendering","image-resolution","inline-box-align","justify-content","left","letter-spacing","line-break","line-height","line-stacking","line-stacking-ruby","line-stacking-shift","line-stacking-strategy","list-style","list-style-image","list-style-position","list-style-type","margin","margin-bottom","margin-left","margin-right","margin-top","marker-offset","marks","marquee-direction","marquee-loop","marquee-play-count","marquee-speed","marquee-style","max-height","max-width","min-height","min-width","move-to","nav-down","nav-index","nav-left","nav-right","nav-up","opacity","order","orphans","outline","outline-color","outline-offset","outline-style","outline-width","overflow","overflow-style","overflow-wrap","overflow-x","overflow-y","padding","padding-bottom","padding-left","padding-right","padding-top","page","page-break-after","page-break-before","page-break-inside","page-policy","pause","pause-after","pause-before","perspective","perspective-origin","pitch","pitch-range","play-during","position","presentation-level","punctuation-trim","quotes","region-break-after","region-break-before","region-break-inside","region-fragment","rendering-intent","resize","rest","rest-after","rest-before","richness","right","rotation","rotation-point","ruby-align","ruby-overhang","ruby-position","ruby-span","shape-inside","shape-outside","size","speak","speak-as","speak-header","speak-numeral","speak-punctuation","speech-rate","stress","string-set","tab-size","table-layout","target","target-name","target-new","target-position","text-align","text-align-last","text-decoration","text-decoration-color","text-decoration-line","text-decoration-skip","text-decoration-style","text-emphasis","text-emphasis-color","text-emphasis-position","text-emphasis-style","text-height","text-indent","text-justify","text-outline","text-overflow","text-shadow","text-size-adjust","text-space-collapse","text-transform","text-underline-position","text-wrap","top","transform","transform-origin","transform-style","transition","transition-delay","transition-duration","transition-property","transition-timing-function","unicode-bidi","vertical-align","visibility","voice-balance","voice-duration","voice-family","voice-pitch","voice-range","voice-rate","voice-stress","voice-volume","volume","white-space","widows","width","word-break","word-spacing","word-wrap","z-index","zoom","clip-path","clip-rule","mask","enable-background","filter","flood-color","flood-opacity","lighting-color","stop-color","stop-opacity","pointer-events","color-interpolation","color-interpolation-filters","color-profile","color-rendering","fill","fill-opacity","fill-rule","image-rendering","marker","marker-end","marker-mid","marker-start","shape-rendering","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","text-rendering","baseline-shift","dominant-baseline","glyph-orientation-horizontal","glyph-orientation-vertical","kerning","text-anchor","writing-mode"]),e=a(["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","grey","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"]),f=a(["above","absolute","activeborder","activecaption","afar","after-white-space","ahead","alias","all","all-scroll","alternate","always","amharic","amharic-abegede","antialiased","appworkspace","arabic-indic","armenian","asterisks","auto","avoid","avoid-column","avoid-page","avoid-region","background","backwards","baseline","below","bidi-override","binary","bengali","blink","block","block-axis","bold","bolder","border","border-box","both","bottom","break","break-all","break-word","button","button-bevel","buttonface","buttonhighlight","buttonshadow","buttontext","cambodian","capitalize","caps-lock-indicator","caption","captiontext","caret","cell","center","checkbox","circle","cjk-earthly-branch","cjk-heavenly-stem","cjk-ideographic","clear","clip","close-quote","col-resize","collapse","column","compact","condensed","contain","content","content-box","context-menu","continuous","copy","cover","crop","cross","crosshair","currentcolor","cursive","dashed","decimal","decimal-leading-zero","default","default-button","destination-atop","destination-in","destination-out","destination-over","devanagari","disc","discard","document","dot-dash","dot-dot-dash","dotted","double","down","e-resize","ease","ease-in","ease-in-out","ease-out","element","ellipse","ellipsis","embed","end","ethiopic","ethiopic-abegede","ethiopic-abegede-am-et","ethiopic-abegede-gez","ethiopic-abegede-ti-er","ethiopic-abegede-ti-et","ethiopic-halehame-aa-er","ethiopic-halehame-aa-et","ethiopic-halehame-am-et","ethiopic-halehame-gez","ethiopic-halehame-om-et","ethiopic-halehame-sid-et","ethiopic-halehame-so-et","ethiopic-halehame-ti-er","ethiopic-halehame-ti-et","ethiopic-halehame-tig","ew-resize","expanded","extra-condensed","extra-expanded","fantasy","fast","fill","fixed","flat","footnotes","forwards","from","geometricPrecision","georgian","graytext","groove","gujarati","gurmukhi","hand","hangul","hangul-consonant","hebrew","help","hidden","hide","higher","highlight","highlighttext","hiragana","hiragana-iroha","horizontal","hsl","hsla","icon","ignore","inactiveborder","inactivecaption","inactivecaptiontext","infinite","infobackground","infotext","inherit","initial","inline","inline-axis","inline-block","inline-table","inset","inside","intrinsic","invert","italic","justify","kannada","katakana","katakana-iroha","keep-all","khmer","landscape","lao","large","larger","left","level","lighter","line-through","linear","lines","list-item","listbox","listitem","local","logical","loud","lower","lower-alpha","lower-armenian","lower-greek","lower-hexadecimal","lower-latin","lower-norwegian","lower-roman","lowercase","ltr","malayalam","match","media-controls-background","media-current-time-display","media-fullscreen-button","media-mute-button","media-play-button","media-return-to-realtime-button","media-rewind-button","media-seek-back-button","media-seek-forward-button","media-slider","media-sliderthumb","media-time-remaining-display","media-volume-slider","media-volume-slider-container","media-volume-sliderthumb","medium","menu","menulist","menulist-button","menulist-text","menulist-textfield","menutext","message-box","middle","min-intrinsic","mix","mongolian","monospace","move","multiple","myanmar","n-resize","narrower","ne-resize","nesw-resize","no-close-quote","no-drop","no-open-quote","no-repeat","none","normal","not-allowed","nowrap","ns-resize","nw-resize","nwse-resize","oblique","octal","open-quote","optimizeLegibility","optimizeSpeed","oriya","oromo","outset","outside","outside-shape","overlay","overline","padding","padding-box","painted","page","paused","persian","plus-darker","plus-lighter","pointer","polygon","portrait","pre","pre-line","pre-wrap","preserve-3d","progress","push-button","radio","read-only","read-write","read-write-plaintext-only","rectangle","region","relative","repeat","repeat-x","repeat-y","reset","reverse","rgb","rgba","ridge","right","round","row-resize","rtl","run-in","running","s-resize","sans-serif","scroll","scrollbar","se-resize","searchfield","searchfield-cancel-button","searchfield-decoration","searchfield-results-button","searchfield-results-decoration","semi-condensed","semi-expanded","separate","serif","show","sidama","single","skip-white-space","slide","slider-horizontal","slider-vertical","sliderthumb-horizontal","sliderthumb-vertical","slow","small","small-caps","small-caption","smaller","solid","somali","source-atop","source-in","source-out","source-over","space","square","square-button","start","static","status-bar","stretch","stroke","sub","subpixel-antialiased","super","sw-resize","table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row","table-row-group","telugu","text","text-bottom","text-top","textarea","textfield","thai","thick","thin","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedshadow","tibetan","tigre","tigrinya-er","tigrinya-er-abegede","tigrinya-et","tigrinya-et-abegede","to","top","transparent","ultra-condensed","ultra-expanded","underline","up","upper-alpha","upper-armenian","upper-greek","upper-hexadecimal","upper-latin","upper-norwegian","upper-roman","uppercase","urdu","url","vertical","vertical-text","visible","visibleFill","visiblePainted","visibleStroke","visual","w-resize","wait","wave","wider","window","windowframe","windowtext","x-large","x-small","xor","xx-large","xx-small"]);CodeMirror.defineMIME("text/ss",{atMediaTypes:b,atMediaFeatures:c,propertyKeywords:d,colorKeywords:e,valueKeywords:f,hooks:{"<":function(a,b){function c(a,b){for(var d,c=0;null!=(d=a.next());){if(c>=2&&">"==d){b.tokenize=null;break}c="-"==d?c+1:0}return["comment","comment"]}return a.eat("!")?(b.tokenize=c,c(a,b)):void 0},"/":function(a,b){return a.eat("*")?(b.tokenize=g,g(a,b)):!1}},name:"css"}),CodeMirror.defineMIME("text/-scss",{atMediaTypes:b,atMediaFeatures:c,propertyKeywords:d,colorKeywords:e,valueKeywords:f,allowNested:!0,hooks:{":":function(a){return a.match(/\s*{/)?[null,"{"]:!1},$:function(a){return a.match(/^[\w-]+/),":"==a.peek()?["variable","variable-definition"]:["variable","variable"]},",":function(a,b){return"propertyValue"==b.stack[b.stack.length-1]?["operator",";"]:void 0},"/":function(a,b){return a.eat("/)?(a.skipToEnd(),["comment","comment"]):a.eat("*")?(b.tokenize=g,g(a,b)):["operator","operator"]},"#":function(a){return a.eat("{")?["operator","interpolation"]:(a.eatWhile(/[\w\\\-]/),["atom","hash"])}},name:"css"})}(),CodeMirror.defineMode("less",function(a){function d(a,b){return c=b,a}function f(a,b){var f=a.next();if("@"==f)return a.eatWhile(/[\w\-]/),d("meta",a.current());if("/"==f&&a.eat("*"))return b.tokenize=h,h(a,b);if("<"==f&&a.eat("!"))return b.tokenize=i,i(a,b);if("="==f)d(null,"compare");else{if("|"==f&&a.eat("="))return d(null,"compare");if('"'==f||"'"==f)return b.tokenize=j(f),b.tokenize(a,b);if("/"==f){if(a.eat("/"))return b.tokenize=g,g(a,b);if("string"==c||"("==c)return d("string","string");if(void 0!==b.stack[b.stack.length-1])return d(null,f);if(a.eatWhile(/[\a-zA-Z0-9\-_.\s]/),/\/|\)|#/.test(a.peek()||a.eatSpace()&&")"===a.peek())||a.eol())return d("string","string")}else{if("!"==f)return a.match(/^\s*\w*/),d("keyword","important");if(/\d/.test(f))return a.eatWhile(/[\w.%]/),d("number","unit");if(/[,+<>*\/]/.test(f))return"="==a.peek()||"a"==c?d("string","string"):","===f?d(null,f):d(null,"select-op");if(/[;{}:\[\]()~\|]/.test(f)){if(":"==f)return a.eatWhile(/[a-z\\\-]/),e.test(a.current())?d("tag","tag"):":"==a.peek()?(a.next(),a.eatWhile(/[a-z\\\-]/),a.current().match(/\:\:\-(o|ms|moz|webkit)\-/)?d("string","string"):e.test(a.current().substring(1))?d("tag","tag"):d(null,f)):d(null,f);if("~"!=f)return d(null,f);if("r"==c)return d("string","string")}else{if("."==f)return"("==c?d("string","string"):(a.eatWhile(/[\a-zA-Z0-9\-_]/)," "===a.peek()&&a.eatSpace(),")"===a.peek()||":"===c?d("number","unit"):a.current().length>1&&"rule"===b.stack[b.stack.length-1]&&null===a.peek().match(/{|,|\+|\(/)?d("number","unit"):d("tag","tag"));if("#"==f)return a.eatWhile(/[A-Za-z0-9]/),4==a.current().length||7==a.current().length?null!=a.current().match(/[A-Fa-f0-9]{6}|[A-Fa-f0-9]{3}/,!1)?a.current().substring(1)!=a.current().match(/[A-Fa-f0-9]{6}|[A-Fa-f0-9]{3}/,!1)?d("atom","tag"):(a.eatSpace(),/[\/<>.(){!$%^&*_\-\\?=+\|#'~`]/.test(a.peek())?"select-op"===c?d("number","unit"):d("atom","tag"):"}"==a.peek()?d("number","unit"):/[a-zA-Z\\]/.test(a.peek())?d("atom","tag"):a.eol()?d("atom","tag"):d("number","unit")):(a.eatWhile(/[\w\\\-]/),d("atom",a.current())):(a.eatWhile(/[\w\\\-]/),"rule"===b.stack[b.stack.length-1]?d("atom",a.current()):d("atom",a.current()));if("&"==f)return a.eatWhile(/[\w\-]/),d(null,f);if(a.eatWhile(/[\w\\\-_%.{]/),null===a.current().match(/\\/)){if("string"==c)return"{"===b.stack[b.stack.length-1]&&":"===a.peek()?d("variable","variable"):("/"===a.peek()&&a.eatWhile(/[\w\\\-_%.{:\/]/),d(c,a.current()));if(null!=a.current().match(/(^http$|^https$)/))return a.eatWhile(/[\w\\\-_%.{:\/]/),"/"===a.peek()&&a.eatWhile(/[\w\\\-_%.{:\/]/),d("string","string");if("<"==a.peek()||">"==a.peek()||"+"==a.peek())return"("!==c||"n"!==a.current()&&"-n"!==a.current()?d("tag","tag"):d("string",a.current());if(/\(/.test(a.peek()))return"when"===a.current()?d("variable","variable"):"@media"===b.stack[b.stack.length-1]&&"and"===a.current()?d("variable",a.current()):d(null,f);if("/"==a.peek()&&void 0!==b.stack[b.stack.length-1])return"/"===a.peek()&&a.eatWhile(/[\w\\\-_%.{:\/]/),d("string",a.current());if(a.current().match(/\-\d|\-.\d/))return d("number","unit");if(/\/|[\s\)]/.test(a.peek()||a.eol()||a.eatSpace()&&"/"==a.peek())&&-1!==a.current().indexOf("."))return"{"==a.current().substring(a.current().length-1,a.current().length)?(a.backUp(1),d("tag","tag")):(a.eatSpace(),/[{<>.a-zA-Z\/]/.test(a.peek())||a.eol()?d("tag","tag"):d("string","string"));if(a.eol()||"["==a.peek()||"#"==a.peek()||"tag"==c){if("{"==a.current().substring(a.current().length-1,a.current().length))a.backUp(1);else{if("border-color"===b.stack[b.stack.length-1]||"background-position"===b.stack[b.stack.length-1]||"font-family"===b.stack[b.stack.length-1])return d(null,a.current());if("tag"===c)return d("tag","tag");if((":"===c||"unit"===c)&&"rule"===b.stack[b.stack.length-1])return d(null,a.current());if("rule"===b.stack[b.stack.length-1]&&"tag"===c)return d("string",a.current());if(";"===b.stack[b.stack.length-1]&&":"===c)return d(null,a.current());if("#"===a.peek()&&void 0!==c&&null===c.match(/\+|,|tag|select\-op|}|{|;/g))return d("string",a.current());if("variable"===c)return d(null,a.current());if("{"===b.stack[b.stack.length-1]&&"comment"===c)return d("variable",a.current());if(0===b.stack.length&&(";"===c||"comment"===c))return d("tag",a.current());if(("{"===b.stack[b.stack.length-1]||";"===c)&&"@media{"!==b.stack[b.stack.length-1])return d("variable",a.current());if("{"===b.stack[b.stack.length-2]&&";"===b.stack[b.stack.length-1])return d("variable",a.current())}return d("tag","tag")}if("compare"==c||"a"==c||"("==c)return d("string","string");if("|"==c||"-"==a.current()||"["==c)return"|"==c&&null!==a.peek().match(/\]|=|\~/)?d("number",a.current()):"|"==c?d("tag","tag"):"["==c?(a.eatWhile(/\w\-/),d("number",a.current())):d(null,f);if(":"==a.peek()||a.eatSpace()&&":"==a.peek()){a.next();var k=":"==a.peek()?!0:!1;if(k)a.backUp(1);else{var l=a.pos,m=a.current().length;a.eatWhile(/[a-z\\\-]/);var n=a.pos;if(null!=a.current().substring(m-1).match(e))return a.backUp(n-(l-1)),d("tag","tag");a.backUp(n-(l-1))}return k?d("tag","tag"):d("variable","variable")}return"font-family"===b.stack[b.stack.length-1]||"background-position"===b.stack[b.stack.length-1]||"border-color"===b.stack[b.stack.length-1]?d(null,null):null===b.stack[b.stack.length-1]&&":"===c?d(null,a.current()):/\^|\$/.test(a.current())&&null!==a.peek().match(/\~|=/)?d("string","string"):"unit"===c&&"rule"===b.stack[b.stack.length-1]?d(null,"unit"):"unit"===c&&";"===b.stack[b.stack.length-1]?d(null,"unit"):")"===c&&"rule"===b.stack[b.stack.length-1]?d(null,"unit"):c&&null!==c.match("@")&&"rule"===b.stack[b.stack.length-1]?d(null,"unit"):";"!==c&&"}"!==c&&","!==c||";"!==b.stack[b.stack.length-1]?";"===c&&void 0!==a.peek()&&null===a.peek().match(/{|./)||";"===c&&a.eatSpace()&&null===a.peek().match(/{|./)?d("variable",a.current()):"@media"===c&&"@media"===b.stack[b.stack.length-1]||"@namespace"===c?d("tag",a.current()):"{"===c&&";"===b.stack[b.stack.length-1]&&"{"===a.peek()?d("tag","tag"):"{"!==c&&":"!==c||";"!==b.stack[b.stack.length-1]?"{"===b.stack[b.stack.length-1]&&a.eatSpace()&&null===a.peek().match(/.|#/)||"select-op"===c||"rule"===b.stack[b.stack.length-1]&&","===c?d("tag","tag"):"variable"===c&&"rule"===b.stack[b.stack.length-1]?d("tag","tag"):a.eatSpace()&&"{"===a.peek()||a.eol()||"{"===a.peek()?d("tag","tag"):")"!==c||"and"!=a.current()&&"and "!=a.current()?")"!==c||"when"!=a.current()&&"when "!=a.current()?")"===c||"comment"===c||"{"===c?d("tag","tag"):a.sol()?d("tag","tag"):a.eatSpace()&&"#"===a.peek()||"#"===a.peek()?d("tag","tag"):0===b.stack.length?d("tag","tag"):";"===c&&void 0!==a.peek()&&null!==a.peek().match(/^[.|\#]/g)?d("tag","tag"):":"===c?(a.eatSpace(),d(null,a.current())):"and "===a.current()||"and"===a.current()?d("variable",a.current()):";"===c&&"{"===b.stack[b.stack.length-1]?d("variable",a.current()):"rule"===b.stack[b.stack.length-1]?d(null,a.current()):d("tag",a.current()):d("variable","variable"):d("variable","variable"):d(null,a.current()):d("tag",a.current())}if("\\"===a.current().charAt(a.current().length-1)){for(a.eat(/\'|\"|\)|\(/);a.eatWhile(/[\w\\\-_%.{]/);)a.eat(/\'|\"|\)|\(/);return d("string",a.current())}}}}}function g(a,b){return a.skipToEnd(),b.tokenize=f,d("comment","comment")}function h(a,b){for(var e,c=!1;null!=(e=a.next());){if(c&&"/"==e){b.tokenize=f;break}c="*"==e}return d("comment","comment")}function i(a,b){for(var e,c=0;null!=(e=a.next());){if(c>=2&&">"==e){b.tokenize=f;break}c="-"==e?c+1:0}return d("comment","comment")}function j(a){return function(b,c){for(var g,e=!1;null!=(g=b.next())&&(g!=a||e);)e=!e&&"\\"==g;return e||(c.tokenize=f),d("string","string")}}var c,b=a.indentUnit,e=/(^\:root$|^\:nth\-child$|^\:nth\-last\-child$|^\:nth\-of\-type$|^\:nth\-last\-of\-type$|^\:first\-child$|^\:last\-child$|^\:first\-of\-type$|^\:last\-of\-type$|^\:only\-child$|^\:only\-of\-type$|^\:empty$|^\:link|^\:visited$|^\:active$|^\:hover$|^\:focus$|^\:target$|^\:lang$|^\:enabled^\:disabled$|^\:checked$|^\:first\-line$|^\:first\-letter$|^\:before$|^\:after$|^\:not$|^\:required$|^\:invalid$)/;return{startState:function(a){return{tokenize:f,baseIndent:a||0,stack:[]}},token:function(a,b){if(a.eatSpace())return null;var e=b.tokenize(a,b),f=b.stack[b.stack.length-1];if("hash"==c&&"rule"==f?e="atom":"variable"==e&&("rule"==f?e=null:f&&"@media{"!=f||(e="when"==a.current()?"variable":/[\s,|\s\)|\s]/.test(a.peek())?"tag":c)),"rule"==f&&/^[\{\};]$/.test(c)&&b.stack.pop(),"{"==c?"@media"==f?b.stack[b.stack.length-1]="@media{":b.stack.push("{"):"}"==c?b.stack.pop():"@media"==c?b.stack.push("@media"):"font-family"===a.current()?b.stack[b.stack.length-1]="font-family":"background-position"===a.current()?b.stack[b.stack.length-1]="background-position":"border-color"===a.current()?b.stack[b.stack.length-1]="border-color":"{"==f&&"comment"!=c&&"tag"!==c?b.stack.push("rule"):":"===a.peek()&&null===a.current().match(/@|#/)&&(e=c),";"!==c||"font-family"!=b.stack[b.stack.length-1]&&"background-position"!=b.stack[b.stack.length-1]&&"border-color"!=b.stack[b.stack.length-1]){if("tag"===c&&")"===a.peek()&&null===a.current().match(/\:/))c=null,e=null;else if("variable"===c&&")"===a.peek()||"variable"===c&&a.eatSpace()&&")"===a.peek())return d(null,a.current())}else b.stack[b.stack.length-1]=a.current();return e},indent:function(a,c){var d=a.stack.length;return/^\}/.test(c)?d-="rule"===a.stack[a.stack.length-1]?2:1:"{"===a.stack[a.stack.length-2]&&(d-="rule"===a.stack[a.stack.length-1]?1:0),a.baseIndent+d*b},electricChars:"}",blockCommentStart:"/*",blockCommentEnd:"*/",lineComment:"//"}}),CodeMirror.defineMIME("text/x-less","less"),CodeMirror.mimeModes.hasOwnProperty("text/css")||CodeMirror.defineMIME("text/css","less");

} /* end modules/custom-css/custom-css/js/codemirror.min.js */

if ( jpconcat.files['modules/custom-css/custom-css/js/css-editor.js'] ) {

(function($){var safe,win,safecssResize,safecssInit;safecssResize=function(){safe.height(win.height()-safe.offset().top-250);};safecssInit=function(){safe=$('#safecss');win=$(window);postboxes.add_postbox_toggles('editcss');safecssResize();$('#safecssform').on('click','#preview',function(e){e.preventDefault();document.forms.safecssform.target='csspreview';document.forms.safecssform.action.value='preview';document.forms.safecssform.submit();document.forms.safecssform.target='';document.forms.safecssform.action.value='save';});};window.onresize=safecssResize;addLoadEvent(safecssInit);})(jQuery);jQuery(function($){$('.edit-preprocessor').bind('click',function(e){e.preventDefault();$('#preprocessor-select').slideDown();$(this).hide();});$('.cancel-preprocessor').bind('click',function(e){e.preventDefault();$('#preprocessor-select').slideUp(function(){$('.edit-preprocessor').show();$('#preprocessor_choices').val($('#custom_css_preprocessor').val());});});$('.save-preprocessor').bind('click',function(e){e.preventDefault();$('#preprocessor-select').slideUp();$('#preprocessor-display').text($('#preprocessor_choices option:selected').text());$('#custom_css_preprocessor').val($('#preprocessor_choices').val()).change();$('.edit-preprocessor').show();});$('.edit-css-mode').bind('click',function(e){e.preventDefault();$('#css-mode-select').slideDown();$(this).hide();});$('.cancel-css-mode').bind('click',function(e){e.preventDefault();$('#css-mode-select').slideUp(function(){$('.edit-css-mode').show();$('input[name=add_to_existing_display][value='+$('#add_to_existing').val()+']').attr('checked',true);});});$('.save-css-mode').bind('click',function(e){e.preventDefault();$('#css-mode-select').slideUp();$('#css-mode-display').text($('input[name=add_to_existing_display]:checked').val()=='true'?'Add-on':'Replacement');$('#add_to_existing').val($('input[name=add_to_existing_display]:checked').val());$('.edit-css-mode').show();});});

} /* end modules/custom-css/custom-css/js/css-editor.js */

if ( jpconcat.files['modules/custom-css/custom-css/js/use-codemirror.js'] ) {

(function($){var Jetpack_CSS={modes:{'default':'text/css','less':'text/x-less','sass':'text/x-scss'},init:function(){this.$textarea=$('#safecss');this.editor=window.CodeMirror.fromTextArea(this.$textarea.get(0),{mode:this.getMode(),lineNumbers:true,tabSize:2,indentWithTabs:true,lineWrapping:true});this.setEditorHeight();},addListeners:function(){$(window).on('resize',_.bind(_.debounce(this.setEditorHeight,100),this));this.editor.on('change',_.bind(function(editor){this.$textarea.val(editor.getValue());},this));$('#preprocessor_choices').change(_.bind(function(){this.editor.setOption('mode',this.getMode());},this));},setEditorHeight:function(){var height=$('html').height()-$(this.editor.getWrapperElement()).offset().top;this.editor.setSize(null,height);},getMode:function(){var mode=$('#preprocessor_choices').val();if(''===mode||!this.modes[mode]){mode='default';}
return this.modes[mode];}};$(document).ready(_.bind(Jetpack_CSS.init,Jetpack_CSS));})(jQuery);

} /* end modules/custom-css/custom-css/js/use-codemirror.js */

if ( jpconcat.files['modules/custom-post-types/comics/comics.js'] ) {

jQuery(function($){var Jetpack_Comics={init:function(){$(document).on('dragover.jetpack-comics','body, #jetpack-comic-drop-zone',this.onDragOver);$(document).on('dragleave.jetpack-comics','body, #jetpack-comic-drop-zone',this.onDragLeave);$(document).on('drop.jetpack-comics','body, #jetpack-comic-drop-zone',this.onDrop);$('body').append($('<div id="jetpack-comic-drop-zone"><p class="dragging" /><p class="uploading" /></div>'));$('#jetpack-comic-drop-zone').find('.dragging').text(Jetpack_Comics_Options.labels.dragging).end().find('.uploading').text(Jetpack_Comics_Options.labels.uploading).prepend($('<span class="spinner"/>'));if(!('FileReader'in window&&'File'in window)){$('#jetpack-comic-drop-zone .dragging').text(Jetpack_Comics_Options.labels.unsupported);$(document).off('drop.jetpack-comics').on('drop.jetpack-comics','body, #jetpack-comic-drop-zone',this.onDragLeave);}},filterImageFiles:function(files){var validFiles=[];for(var i=0,_len=files.length;i<_len;i++){if(files[i].type.match(/^image\//i)){validFiles.push(files[i]);}}
return validFiles;},dragTimeout:null,onDragOver:function(event){event.preventDefault();clearTimeout(Jetpack_Comics.dragTimeout);$('body').addClass('dragging');},onDragLeave:function(){clearTimeout(Jetpack_Comics.dragTimeout);Jetpack_Comics.dragTimeout=setTimeout(function(){$('body').removeClass('dragging');},100);},onDrop:function(event){event.preventDefault();event.stopPropagation();event.originalEvent.stopPropagation();event.originalEvent.preventDefault();var files=Jetpack_Comics.filterImageFiles(event.originalEvent.dataTransfer.files);$('body').removeClass('dragging');if(files.length===0){alert(Jetpack_Comics_Options.labels.invalidUpload);return;}
$('body').addClass('uploading');var formData=new FormData();for(var i=0,fl=files.length;i<fl;i++){formData.append('image_'+i,files[i]);}
$('#jetpack-comic-drop-zone .uploading .spinner').spin();$.ajax({url:Jetpack_Comics_Options.writeURL+'&nonce='+Jetpack_Comics_Options.nonce,data:formData,processData:false,contentType:false,type:'POST',dataType:'json',xhrFields:{withCredentials:true}}).done(function(data){$('#jetpack-comic-drop-zone .uploading').text(Jetpack_Comics_Options.labels.processing);if('url'in data){document.location.href=data.url;}
else if('error'in data){alert(data.error);$('body').removeClass('uploading');}}).fail(function(){alert(Jetpack_Comics_Options.labels.error);});}};Jetpack_Comics.init();});

} /* end modules/custom-post-types/comics/comics.js */

if ( jpconcat.files['modules/custom-post-types/js/many-items.js'] ) {

(function($){var menuSelector,nonceInput,methods;methods={init:function(){var $this=this,tbody,row;this.on('keypress.manyItemsTable',function(event){if(13!==event.which){return;}
event.preventDefault();if('function'===typeof FormData){methods.submitRow.apply($this);}
methods.addRow.apply($this);}).on('focus.manyItemsTable',':input',function(){$this.data('currentRow',$(this).parents('tr:first'));});tbody=this.find('tbody:last');row=tbody.find('tr:first').clone();this.data('form',this.parents('form:first'));this.data('tbody',tbody);this.data('row',row);this.data('currentRow',row);menuSelector=$('#nova-menu-tax');nonceInput=$('#_wpnonce');return this;},destroy:function(){this.off('.manyItemsTable');return this;},submitRow:function(){var submittedRow,currentInputs,allInputs,partialFormData;submittedRow=this.data('currentRow');currentInputs=submittedRow.find(':input');allInputs=this.data('form').find(':input').not(currentInputs).attr('disabled',true).end();partialFormData=new FormData(this.data('form').get(0));partialFormData.append('ajax','1');partialFormData.append('nova_menu_tax',menuSelector.val());partialFormData.append('_wpnonce',nonceInput.val());allInputs.attr('disabled',false);$.ajax({url:'',type:'POST',data:partialFormData,processData:false,contentType:false}).complete(function(xhr){submittedRow.html(xhr.responseText);});currentInputs.attr('disabled',true);return this;},addRow:function(){var row=this.data('row').clone();row.appendTo(this.data('tbody'));row.find(':input:first').focus();return this;}};$.fn.manyItemsTable=function(method){if(methods[method]){return methods[method].apply(this,Array.prototype.slice.call(arguments,1));}else if(typeof method==='object'||!method){return methods.init.apply(this,arguments);}else{$.error('Method '+method+' does not exist on jQuery.manyItemsTable');return this;}};$.fn.clickAddRow=function(){var tbody=this.find('tbody:last'),row=tbody.find('tr:first').clone();$(row).find('input').attr('value','');$(row).appendTo(tbody);};})(jQuery);jQuery('.many-items-table').one('focus',':input',function(event){jQuery(event.delegateTarget).manyItemsTable();});jQuery('.many-items-table').on('click','a.nova-new-row',function(event){jQuery(event.delegateTarget).clickAddRow();});

} /* end modules/custom-post-types/js/many-items.js */

if ( jpconcat.files['modules/custom-post-types/js/menu-checkboxes.js'] ) {

(function($){var NovaCheckBoxes={inputs:null,popInputs:null,initialize:function(){NovaCheckBoxes.popInputs=$('#nova_menuchecklist-pop').find(':checkbox');NovaCheckBoxes.inputs=$('#nova_menuchecklist').find(':checkbox').change(NovaCheckBoxes.checkOne).change(NovaCheckBoxes.syncPop);if(!NovaCheckBoxes.isChecked()){NovaCheckBoxes.checkFirst();}
NovaCheckBoxes.syncPop();},syncPop:function(){NovaCheckBoxes.popInputs.each(function(){var $this=$(this);$this.prop('checked',$('#in-nova_menu-'+$this.val()).is(':checked'));});},isChecked:function(){return NovaCheckBoxes.inputs.is(':checked');},checkFirst:function(){console.log('first!');NovaCheckBoxes.inputs.first().prop('checked',true);},checkOne:function(){if($(this).is(':checked')){return NovaCheckBoxes.inputs.not(this).prop('checked',false);}else{return NovaCheckBoxes.checkFirst();}}};$(NovaCheckBoxes.initialize);})(jQuery);

} /* end modules/custom-post-types/js/menu-checkboxes.js */

if ( jpconcat.files['modules/custom-post-types/js/nova-drag-drop.js'] ) {

(function($){var list;function init(){list=$('#the-list');dragMenus();addNonce();addSubmitButton();}
function dragMenus(){list.sortable({cancel:'.no-items',stop:function(event,ui){if(ui.item.is(':first-child')){return list.sortable('cancel');}
reOrder();}});}
function reOrder(){list.find('.menu-label-row').each(function(){var term_id=$(this).data('term_id');$(this).nextUntil('.menu-label-row').each(function(i){var row=$(this);row.find('.menu-order-value').val(i);row.find('.nova-menu-term').val(term_id);});});}
function addSubmitButton(){$('.tablenav').prepend('<input type="submit" class="button-primary button-reorder alignright" value="'+_novaDragDrop.reorder+'" name="'+_novaDragDrop.reorderName+'" />');}
function addNonce(){$('#posts-filter').append('<input type="hidden" name="'+_novaDragDrop.nonceName+'" value="'+_novaDragDrop.nonce+'" />');}
$(document).ready(init);})(jQuery);

} /* end modules/custom-post-types/js/nova-drag-drop.js */

if ( jpconcat.files['modules/gplus-authorship/admin/connect.js'] ) {

function googlePlusSignInCallback(authResult){var blogID=jQuery('#current-blog-id').attr('data-value');if(authResult['code']){jQuery.ajax({type:'POST',url:'index.php?page=gplus-authorship&blog_id='+blogID+'&store_token='+authResult['code']+'&state='+state,contentType:'application/json; charset=utf-8',processData:false,success:function(result){if('undefined'==typeof result.error){googlePlusSendToParent({success:true});}else{googlePlusSendToParent({error:result.error});}},error:function(result){if('undefined'!=typeof result.error){googlePlusSendToParent({error:result.error});}else{googlePlusSendToParent({error:'unknown'});}}});}else if(authResult['error']){googlePlusSendToParent({error:authResult['error']});}else{googlePlusSendToParent({error:'unknown'});}}
function googlePlusSendToParent(data){if('immediate_failed'==data.error)
return;pm({target:window.parent,type:'googlePlusSignInMessage',data:data,origin:'*'});}

} /* end modules/gplus-authorship/admin/connect.js */

if ( jpconcat.files['modules/gplus-authorship/admin/listener.js'] ) {

jQuery(function($){pm.bind('googlePlusSignInMessage',function(message){if('undefined'!==typeof message.error){GooglePlusMessageHandler.error(message.error);}else if('undefined'!==typeof message.success&&'undefined'!==typeof message.result){GooglePlusMessageHandler.success(message.result);}else{GooglePlusMessageHandler.unknownMessage(message);}});var GooglePlusMessageHandler={outputContainer:'#result',success:function(result){$.post('./admin-ajax.php',{action:'save_gplus_profile_data',name:result.name,url:result.url,profile_image:result.profile_image,id:result.id,state:result.state},function(){$(GooglePlusMessageHandler.outputContainer).text(GPlusL10n.connected);window.location.href='options-general.php?page=sharing&r='+Math.round(Math.random()*100000)+'#gplus';});},error:function(error){if('unknown'===error){$(GooglePlusMessageHandler.outputContainer).text(GPlusL10n.unknownError);}else if('access_denied'===error){$(GooglePlusMessageHandler.outputContainer).text(GPlusL10n.accessDenied);}else{$(GooglePlusMessageHandler.outputContainer).text(error);}},unknownMessage:function(message){console.log('DEBUG: An unknown message was passed via postMessage:');console.log(message);GooglePlusMessageHandler.error('unknown');}};$('#disconnect-gplus').click(function(){var ays=confirm('Are you sure you want to disconnect your Google+ profile? If you have any Publicize accounts connected to this profile they will also be disconnected.');if(!ays){return false;}});});

} /* end modules/gplus-authorship/admin/listener.js */

if ( jpconcat.files['modules/holiday-snow/snowstorm.js'] ) {

var snowStorm=(function(window,document){this.autoStart=true;this.flakesMax=60;this.flakesMaxActive=60;this.animationInterval=40;this.excludeMobile=true;this.flakeBottom=null;this.followMouse=true;this.snowColor='#fff';this.snowCharacter='&bull;';this.snowStick=false;this.targetElement=null;this.useMeltEffect=true;this.useTwinkleEffect=false;this.usePositionFixed=false;this.freezeOnBlur=true;this.flakeLeftOffset=0;this.flakeRightOffset=0;this.flakeWidth=5;this.flakeHeight=5;this.vMaxX=2.5;this.vMaxY=2.5;this.zIndex=100000;var s=this,storm=this,i,isIE=navigator.userAgent.match(/msie/i),isIE6=navigator.userAgent.match(/msie 6/i),isWin98=navigator.appVersion.match(/windows 98/i),isMobile=navigator.userAgent.match(/mobile|opera m(ob|in)/i),isBackCompatIE=(isIE&&document.compatMode==='BackCompat'),noFixed=(isMobile||isBackCompatIE||isIE6),screenX=null,screenX2=null,screenY=null,scrollY=null,vRndX=null,vRndY=null,windOffset=1,windMultiplier=2,flakeTypes=6,fixedForEverything=false,opacitySupported=(function(){try{document.createElement('div').style.opacity='0.5';}catch(e){return false;}
return true;}()),didInit=false,docFrag=document.createDocumentFragment();this.timers=[];this.flakes=[];this.disabled=false;this.active=false;this.meltFrameCount=20;this.meltFrames=[];this.events=(function(){var old=(!window.addEventListener&&window.attachEvent),slice=Array.prototype.slice,evt={add:(old?'attachEvent':'addEventListener'),remove:(old?'detachEvent':'removeEventListener')};function getArgs(oArgs){var args=slice.call(oArgs),len=args.length;if(old){args[1]='on'+args[1];if(len>3){args.pop();}}else if(len===3){args.push(false);}
return args;}
function apply(args,sType){var element=args.shift(),method=[evt[sType]];if(old){element[method](args[0],args[1]);}else{element[method].apply(element,args);}}
function addEvent(){apply(getArgs(arguments),'add');}
function removeEvent(){apply(getArgs(arguments),'remove');}
return{add:addEvent,remove:removeEvent};}());function rnd(n,min){if(isNaN(min)){min=0;}
return(Math.random()*n)+min;}
function plusMinus(n){return(parseInt(rnd(2),10)===1?n*-1:n);}
this.randomizeWind=function(){var i;vRndX=plusMinus(rnd(s.vMaxX,0.2));vRndY=rnd(s.vMaxY,0.2);if(this.flakes){for(i=0;i<this.flakes.length;i++){if(this.flakes[i].active){this.flakes[i].setVelocities();}}}};this.scrollHandler=function(){var i;scrollY=(s.flakeBottom?0:parseInt(window.scrollY||document.documentElement.scrollTop||document.body.scrollTop,10));if(isNaN(scrollY)){scrollY=0;}
if(!fixedForEverything&&!s.flakeBottom&&s.flakes){for(i=s.flakes.length;i--;){if(s.flakes[i].active===0){s.flakes[i].stick();}}}};this.resizeHandler=function(){if(window.innerWidth||window.innerHeight){screenX=window.innerWidth-16-s.flakeRightOffset;screenY=(s.flakeBottom?s.flakeBottom:window.innerHeight);}else{screenX=(document.documentElement.clientWidth||document.body.clientWidth||document.body.scrollWidth)-(!isIE?8:0)-s.flakeRightOffset;screenY=s.flakeBottom?s.flakeBottom:(document.documentElement.clientHeight||document.body.clientHeight||document.body.scrollHeight);}
screenX2=parseInt(screenX/2,10);};this.resizeHandlerAlt=function(){screenX=s.targetElement.offsetLeft+s.targetElement.offsetWidth-s.flakeRightOffset;screenY=s.flakeBottom?s.flakeBottom:s.targetElement.offsetTop+s.targetElement.offsetHeight;screenX2=parseInt(screenX/2,10);};this.freeze=function(){var i;if(!s.disabled){s.disabled=1;}else{return false;}
for(i=s.timers.length;i--;){clearInterval(s.timers[i]);}};this.resume=function(){if(s.disabled){s.disabled=0;}else{return false;}
s.timerInit();};this.toggleSnow=function(){if(!s.flakes.length){s.start();}else{s.active=!s.active;if(s.active){s.show();s.resume();}else{s.stop();s.freeze();}}};this.stop=function(){var i;this.freeze();for(i=this.flakes.length;i--;){this.flakes[i].o.style.display='none';}
s.events.remove(window,'scroll',s.scrollHandler);s.events.remove(window,'resize',s.resizeHandler);if(s.freezeOnBlur){if(isIE){s.events.remove(document,'focusout',s.freeze);s.events.remove(document,'focusin',s.resume);}else{s.events.remove(window,'blur',s.freeze);s.events.remove(window,'focus',s.resume);}}};this.show=function(){var i;for(i=this.flakes.length;i--;){this.flakes[i].o.style.display='block';}};this.SnowFlake=function(parent,type,x,y){var s=this,storm=parent;this.type=type;this.x=x||parseInt(rnd(screenX-20),10);this.y=(!isNaN(y)?y:-rnd(screenY)-12);this.vX=null;this.vY=null;this.vAmpTypes=[1,1.2,1.4,1.6,1.8];this.vAmp=this.vAmpTypes[this.type];this.melting=false;this.meltFrameCount=storm.meltFrameCount;this.meltFrames=storm.meltFrames;this.meltFrame=0;this.twinkleFrame=0;this.active=1;this.fontSize=(10+(this.type/5)*10);this.o=document.createElement('div');this.o.innerHTML=storm.snowCharacter;this.o.style.color=storm.snowColor;this.o.style.position=(fixedForEverything?'fixed':'absolute');this.o.style.width=storm.flakeWidth+'px';this.o.style.height=storm.flakeHeight+'px';this.o.style.fontFamily='arial,verdana';this.o.style.cursor='default';this.o.style.overflow='hidden';this.o.style.fontWeight='normal';this.o.style.zIndex=storm.zIndex;docFrag.appendChild(this.o);this.refresh=function(){if(isNaN(s.x)||isNaN(s.y)){return false;}
s.o.style.left=s.x+'px';s.o.style.top=s.y+'px';};this.stick=function(){if(noFixed||(storm.targetElement!==document.documentElement&&storm.targetElement!==document.body)){s.o.style.top=(screenY+scrollY-storm.flakeHeight)+'px';}else if(storm.flakeBottom){s.o.style.top=storm.flakeBottom+'px';}else{s.o.style.display='none';s.o.style.top='auto';s.o.style.bottom='0px';s.o.style.position='fixed';s.o.style.display='block';}};this.vCheck=function(){if(s.vX>=0&&s.vX<0.2){s.vX=0.2;}else if(s.vX<0&&s.vX>-0.2){s.vX=-0.2;}
if(s.vY>=0&&s.vY<0.2){s.vY=0.2;}};this.move=function(){var vX=s.vX*windOffset,yDiff;s.x+=vX;s.y+=(s.vY*s.vAmp);if(s.x>=screenX||screenX-s.x<storm.flakeWidth){s.x=0;}else if(vX<0&&s.x-storm.flakeLeftOffset<-storm.flakeWidth){s.x=screenX-storm.flakeWidth-1;}
s.refresh();yDiff=screenY+scrollY-s.y;if(yDiff<storm.flakeHeight){s.active=0;if(storm.snowStick){s.stick();}else{s.recycle();}}else{if(storm.useMeltEffect&&s.active&&s.type<3&&!s.melting&&Math.random()>0.998){s.melting=true;s.melt();}
if(storm.useTwinkleEffect){if(!s.twinkleFrame){if(Math.random()>0.9){s.twinkleFrame=parseInt(Math.random()*20,10);}}else{s.twinkleFrame--;s.o.style.visibility=(s.twinkleFrame&&s.twinkleFrame%2===0?'hidden':'visible');}}}};this.animate=function(){s.move();};this.setVelocities=function(){s.vX=vRndX+rnd(storm.vMaxX*0.12,0.1);s.vY=vRndY+rnd(storm.vMaxY*0.12,0.1);};this.setOpacity=function(o,opacity){if(!opacitySupported){return false;}
o.style.opacity=opacity;};this.melt=function(){if(!storm.useMeltEffect||!s.melting){s.recycle();}else{if(s.meltFrame<s.meltFrameCount){s.setOpacity(s.o,s.meltFrames[s.meltFrame]);s.o.style.fontSize=s.fontSize-(s.fontSize*(s.meltFrame/s.meltFrameCount))+'px';s.o.style.lineHeight=storm.flakeHeight+2+(storm.flakeHeight*0.75*(s.meltFrame/s.meltFrameCount))+'px';s.meltFrame++;}else{s.recycle();}}};this.recycle=function(){s.o.style.display='none';s.o.style.position=(fixedForEverything?'fixed':'absolute');s.o.style.bottom='auto';s.setVelocities();s.vCheck();s.meltFrame=0;s.melting=false;s.setOpacity(s.o,1);s.o.style.padding='0px';s.o.style.margin='0px';s.o.style.fontSize=s.fontSize+'px';s.o.style.lineHeight=(storm.flakeHeight+2)+'px';s.o.style.textAlign='center';s.o.style.verticalAlign='baseline';s.x=parseInt(rnd(screenX-storm.flakeWidth-20),10);s.y=parseInt(rnd(screenY)*-1,10)-storm.flakeHeight;s.refresh();s.o.style.display='block';s.active=1;};this.recycle();this.refresh();};this.snow=function(){var active=0,used=0,waiting=0,flake=null,i;for(i=s.flakes.length;i--;){if(s.flakes[i].active===1){s.flakes[i].move();active++;}else if(s.flakes[i].active===0){used++;}else{waiting++;}
if(s.flakes[i].melting){s.flakes[i].melt();}}
if(active<s.flakesMaxActive){flake=s.flakes[parseInt(rnd(s.flakes.length),10)];if(flake.active===0){flake.melting=true;}}};this.mouseMove=function(e){if(!s.followMouse){return true;}
var x=parseInt(e.clientX,10);if(x<screenX2){windOffset=-windMultiplier+(x/screenX2*windMultiplier);}else{x-=screenX2;windOffset=(x/screenX2)*windMultiplier;}};this.createSnow=function(limit,allowInactive){var i;for(i=0;i<limit;i++){s.flakes[s.flakes.length]=new s.SnowFlake(s,parseInt(rnd(flakeTypes),10));if(allowInactive||i>s.flakesMaxActive){s.flakes[s.flakes.length-1].active=-1;}}
storm.targetElement.appendChild(docFrag);};this.timerInit=function(){s.timers=(!isWin98?[setInterval(s.snow,s.animationInterval)]:[setInterval(s.snow,s.animationInterval*3),setInterval(s.snow,s.animationInterval)]);};this.init=function(){var i;for(i=0;i<s.meltFrameCount;i++){s.meltFrames.push(1-(i/s.meltFrameCount));}
s.randomizeWind();s.createSnow(s.flakesMax);s.events.add(window,'resize',s.resizeHandler);s.events.add(window,'scroll',s.scrollHandler);if(s.freezeOnBlur){if(isIE){s.events.add(document,'focusout',s.freeze);s.events.add(document,'focusin',s.resume);}else{s.events.add(window,'blur',s.freeze);s.events.add(window,'focus',s.resume);}}
s.resizeHandler();s.scrollHandler();if(s.followMouse){s.events.add(isIE?document:window,'mousemove',s.mouseMove);}
s.animationInterval=Math.max(20,s.animationInterval);s.timerInit();};this.start=function(bFromOnLoad){if(!didInit){didInit=true;}else if(bFromOnLoad){return true;}
if(typeof s.targetElement==='string'){var targetID=s.targetElement;s.targetElement=document.getElementById(targetID);if(!s.targetElement){throw new Error('Snowstorm: Unable to get targetElement "'+targetID+'"');}}
if(!s.targetElement){s.targetElement=(!isIE?(document.documentElement?document.documentElement:document.body):document.body);}
if(s.targetElement!==document.documentElement&&s.targetElement!==document.body){s.resizeHandler=s.resizeHandlerAlt;}
s.resizeHandler();s.usePositionFixed=(s.usePositionFixed&&!noFixed);fixedForEverything=s.usePositionFixed;if(screenX&&screenY&&!s.disabled){s.init();s.active=true;}};function doDelayedStart(){window.setTimeout(function(){s.start(true);},20);s.events.remove(isIE?document:window,'mousemove',doDelayedStart);}
function doStart(){if(!s.excludeMobile||!isMobile){if(s.freezeOnBlur){s.events.add(isIE?document:window,'mousemove',doDelayedStart);}else{doDelayedStart();}}
s.events.remove(window,'load',doStart);}
if(s.autoStart){s.events.add(window,'load',doStart,false);}
return this;}(window,document));

} /* end modules/holiday-snow/snowstorm.js */

if ( jpconcat.files['modules/infinite-scroll/infinity.js'] ) {

(function($){var Scroller,ajaxurl,stats,type,text,totop,timer;var isIE=(-1!=navigator.userAgent.search('MSIE'));if(isIE){var IEVersion=navigator.userAgent.match(/MSIE\s?(\d+)\.?\d*;/);var IEVersion=parseInt(IEVersion[1]);}
if("https:"==document.location.protocol){infiniteScroll.settings.ajaxurl=infiniteScroll.settings.ajaxurl.replace("http://","https://");}
Scroller=function(settings){var self=this;this.id=settings.id;this.body=$(document.body);this.window=$(window);this.element=$('#'+settings.id);this.wrapperClass=settings.wrapper_class;this.ready=true;this.disabled=false;this.page=1;this.offset=settings.offset;this.currentday=settings.currentday;this.order=settings.order;this.throttle=false;this.handle='<div id="infinite-handle"><span>'+text.replace('\\','')+'</span></div>';this.click_handle=settings.click_handle;this.google_analytics=settings.google_analytics;this.history=settings.history;this.origURL=window.location.href;this.footer=$('#infinite-footer');this.footer.wrap=settings.footer;this.wpMediaelement=null;if(type=='scroll'){this.window.bind('scroll.infinity',function(){this.throttle=true;});self.gotop();setInterval(function(){if(this.throttle){this.throttle=false;self.thefooter();self.refresh();}},300);self.ensureFilledViewport();this.body.bind('post-load',{self:self},self.checkViewportOnLoad);}else if(type=='click'){if(this.click_handle){this.element.append(this.handle);}
this.body.delegate('#infinite-handle','click.infinity',function(){if(self.click_handle){$('#infinite-handle').remove();}
self.refresh();});}
this.body.bind('post-load',{self:self},self.initializeMejs);};Scroller.prototype.check=function(){var container=this.element.offset();if('object'!==typeof container){return false;}
var bottom=this.window.scrollTop()+this.window.height(),threshold=container.top+this.element.outerHeight(false)-(this.window.height()*2);return bottom>threshold;};Scroller.prototype.render=function(response){this.body.addClass('infinity-success');this.element.append(response.html);this.body.trigger('post-load',response);this.ready=true;};Scroller.prototype.query=function(){return{page:this.page,currentday:this.currentday,order:this.order,scripts:window.infiniteScroll.settings.scripts,styles:window.infiniteScroll.settings.styles,query_args:window.infiniteScroll.settings.query_args,last_post_date:window.infiniteScroll.settings.last_post_date,};};Scroller.prototype.gotop=function(){var blog=$('#infinity-blog-title');blog.attr('title',totop);blog.bind('click',function(e){$('html, body').animate({scrollTop:0},'fast');e.preventDefault();});};Scroller.prototype.thefooter=function(){var self=this,width;if($.type(this.footer.wrap)==="string"){width=$('body #'+this.footer.wrap).outerWidth(false);if(width>479)
this.footer.find('.container').css('width',width);}
if(this.window.scrollTop()>=350)
self.footer.animate({'bottom':0},'fast');else if(this.window.scrollTop()<350)
self.footer.animate({'bottom':'-50px'},'fast');};Scroller.prototype.refresh=function(){var self=this,query,jqxhr,load,loader,color;if(this.disabled||!this.ready||!this.check())
return;this.ready=false;if(this.click_handle){loader='<span class="infinite-loader"></span>';this.element.append(loader);loader=this.element.find('.infinite-loader');color=loader.css('color');try{loader.spin('medium-left',color);}catch(error){}}
query=$.extend({action:'infinite_scroll'},this.query());jqxhr=$.post(infiniteScroll.settings.ajaxurl,query);jqxhr.fail(function(){if(self.click_handle){loader.hide();}
self.ready=true;});jqxhr.done(function(response){if(self.click_handle){loader.hide();}
if(!response)
return;response=$.parseJSON(response);if(!response||!response.type)
return;if(response.type=='empty'){self.disabled=true;self.body.addClass('infinity-end').removeClass('infinity-success');}else if(response.type=='success'){if(response.scripts){$(response.scripts).each(function(){var elementToAppendTo=this.footer?'body':'head';window.infiniteScroll.settings.scripts.push(this.handle);if(this.extra_data){var data=document.createElement('script'),dataContent=document.createTextNode("//<![CDATA[ \n"+this.extra_data+"\n//]]>");data.type='text/javascript';data.appendChild(dataContent);document.getElementsByTagName(elementToAppendTo)[0].appendChild(data);}
var script=document.createElement('script');script.type='text/javascript';script.src=this.src;script.id=this.handle;if('wp-mediaelement'===this.handle){self.body.unbind('post-load',self.initializeMejs);}
if('wp-mediaelement'===this.handle&&'undefined'===typeof mejs){self.wpMediaelement={};self.wpMediaelement.tag=script;self.wpMediaelement.element=elementToAppendTo;setTimeout(self.maybeLoadMejs.bind(self),250);}else{document.getElementsByTagName(elementToAppendTo)[0].appendChild(script);}});}
if(response.styles){$(response.styles).each(function(){window.infiniteScroll.settings.styles.push(this.handle);var style=document.createElement('link');style.rel='stylesheet';style.href=this.src;style.id=this.handle+'-css';if(this.conditional&&(!isIE||!eval(this.conditional.replace(/%ver/g,IEVersion))))
var style=false;if(style)
document.getElementsByTagName('head')[0].appendChild(style);});}
self.page++;if(stats)
new Image().src=document.location.protocol+'//pixel.wp.com/g.gif?'+stats+'&post=0&baba='+Math.random();if('object'==typeof response.postflair&&'object'==typeof WPCOM_sharing_counts)
WPCOM_sharing_counts=$.extend(WPCOM_sharing_counts,response.postflair);self.render.apply(self,arguments);if(type=='click'){if(response.lastbatch){if(self.click_handle){$('#infinite-handle').remove();}else{self.body.trigger('infinite-scroll-posts-end');}}else{if(self.click_handle){self.element.append(self.handle);}else{self.body.trigger('infinite-scroll-posts-more');}}}
if(response.currentday){self.currentday=response.currentday;}
if(self.google_analytics){var ga_url=self.history.path.replace(/%d/,self.page);if('object'===typeof _gaq){_gaq.push(['_trackPageview',ga_url]);}
if('function'===typeof ga){ga('send','pageview',ga_url);}}}});return jqxhr;};Scroller.prototype.maybeLoadMejs=function(){if(null===this.wpMediaelement){return;}
if('undefined'===typeof mejs){setTimeout(this.maybeLoadMejs,250);}else{document.getElementsByTagName(this.wpMediaelement.element)[0].appendChild(this.wpMediaelement.tag);this.wpMediaelement=null;this.body.bind('post-load',{self:this},this.initializeMejs);}}
Scroller.prototype.initializeMejs=function(ev,response){if(-1===response.html.indexOf('wp-audio-shortcode')&&-1===response.html.indexOf('wp-video-shortcode')){return;}
if('undefined'===typeof mejs){return;}
$(function(){var settings={};if(typeof _wpmejsSettings!=='undefined'){settings.pluginPath=_wpmejsSettings.pluginPath;}
settings.success=function(mejs){var autoplay=mejs.attributes.autoplay&&'false'!==mejs.attributes.autoplay;if('flash'===mejs.pluginType&&autoplay){mejs.addEventListener('canplay',function(){mejs.play();},false);}};$('.wp-audio-shortcode, .wp-video-shortcode').not('.mejs-container').mediaelementplayer(settings);});}
Scroller.prototype.ensureFilledViewport=function(){var self=this,windowHeight=self.window.height(),postsHeight=self.element.height()
aveSetHeight=0,wrapperQty=0;if(postsHeight===0){$(self.element.selector+' > li').each(function(){postsHeight+=$(this).height();});if(postsHeight===0){self.body.unbind('post-load',self.checkViewportOnLoad);return;}}
$('.'+self.wrapperClass).each(function(){aveSetHeight+=$(this).height();wrapperQty++;});if(wrapperQty>0)
aveSetHeight=aveSetHeight / wrapperQty;else
aveSetHeight=0;if(postsHeight<windowHeight&&(postsHeight+aveSetHeight<windowHeight)){self.ready=true;self.refresh();}
else{self.body.unbind('post-load',self.checkViewportOnLoad);}}
Scroller.prototype.checkViewportOnLoad=function(ev){ev.data.self.ensureFilledViewport();}
Scroller.prototype.determineURL=function(){var self=window.infiniteScroll.scroller,windowTop=$(window).scrollTop(),windowBottom=windowTop+$(window).height(),windowSize=windowBottom-windowTop,setsInView=[],pageNum=false;$('.'+self.wrapperClass).each(function(){var id=$(this).attr('id'),setTop=$(this).offset().top,setHeight=$(this).outerHeight(false),setBottom=0,setPageNum=$(this).data('page-num');if(0==setHeight){$('> *',this).each(function(){setHeight+=$(this).outerHeight(false);});}
setBottom=setTop+setHeight;if(setTop<windowTop&&setBottom>windowBottom){setsInView.push({'id':id,'top':setTop,'bottom':setBottom,'pageNum':setPageNum});}
else if(setTop>windowTop&&setTop<windowBottom){setsInView.push({'id':id,'top':setTop,'bottom':setBottom,'pageNum':setPageNum});}
else if(setBottom>windowTop&&setBottom<windowBottom){setsInView.push({'id':id,'top':setTop,'bottom':setBottom,'pageNum':setPageNum});}});if(0==setsInView.length){pageNum=-1;}
else if(1==setsInView.length){var setData=setsInView.pop();if(((windowBottom-setData.top)/ windowSize)<0.5)
pageNum=-1;else
pageNum=setData.pageNum;}
else{var majorityPercentageInView=0;$.each(setsInView,function(i,setData){var topInView=0,bottomInView=0,percentOfView=0;if(setData.top>windowTop&&setData.top<windowBottom)
topInView=(windowBottom-setData.top)/ windowSize;if(setData.bottom>windowTop&&setData.bottom<windowBottom)
bottomInView=(setData.bottom-windowTop)/ windowSize;if(topInView>=bottomInView)
percentOfView=topInView;else if(bottomInView>=topInView)
percentOfView=bottomInView;if(percentOfView>majorityPercentageInView){pageNum=setData.pageNum;majorityPercentageInView=percentOfView;}});}
if('number'==typeof pageNum){if(pageNum!=-1)
pageNum++;self.updateURL(pageNum);}}
Scroller.prototype.updateURL=function(page){var self=this,offset=self.offset>0?self.offset-1:0,pageSlug=-1==page?self.origURL:window.location.protocol+'//'+self.history.host+self.history.path.replace(/%d/,page+offset)+self.history.parameters;if(window.location.href!=pageSlug){history.pushState(null,null,pageSlug);}}
$(document).ready(function(){if('object'!=typeof infiniteScroll)
return;ajaxurl=infiniteScroll.settings.ajaxurl;stats=infiniteScroll.settings.stats;type=infiniteScroll.settings.type;text=infiniteScroll.settings.text;totop=infiniteScroll.settings.totop;infiniteScroll.scroller=new Scroller(infiniteScroll.settings);if(!isIE||(isIE&&IEVersion>=10)){$(window).bind('scroll',function(){clearTimeout(timer);timer=setTimeout(infiniteScroll.scroller.determineURL,100);});}});})(jQuery);

} /* end modules/infinite-scroll/infinity.js */

if ( jpconcat.files['modules/likes/post-count-jetpack.js'] ) {

var wpPostLikeCount=wpPostLikeCount||{};(function($){wpPostLikeCount=jQuery.extend(wpPostLikeCount,{request:function(options){return $.ajax({type:'GET',url:wpPostLikeCount.jsonAPIbase+options.path,dataType:'jsonp',data:options.data,success:function(response){options.success(response);},error:function(response){options.error(response);}});}});})(jQuery);

} /* end modules/likes/post-count-jetpack.js */

if ( jpconcat.files['modules/likes/post-count.js'] ) {

var wpPostLikeCount=wpPostLikeCount||{};(function($){wpPostLikeCount=jQuery.extend(wpPostLikeCount,{jsonAPIbase:'https://public-api.wordpress.com/rest/v1',APIqueue:[],wpPostLikeCount:function(){$('.post-like-count').each(function(){var post_id=$(this).attr('data-post-id');var blog_id=$(this).attr('data-blog-id');wpPostLikeCount.APIqueue.push('/sites/'+blog_id+'/posts/'+post_id+'/likes');});wpPostLikeCount.getCounts();},showCount:function(post_id,count){$('#post-like-count-'+post_id).find('.comment-count').hide();$('#post-like-count-'+post_id).find('.comment-count').text(count);$('#post-like-count-'+post_id).find('.comment-count').fadeIn();},getCounts:function(){var batchRequest={path:'/batch',data:'',success:function(response){for(var path in response){if(!response[path].error_data){var urlPieces=path.split('/');var post_id=urlPieces[4];wpPostLikeCount.showCount(post_id,response[path].found);}}},error:function(){}};var amp='';for(var i=0;i<wpPostLikeCount.APIqueue.length;i++){if(i>0){amp='&';}
batchRequest.data+=amp+'urls[]='+wpPostLikeCount.APIqueue[i];}
wpPostLikeCount.request(batchRequest);}});})(jQuery);jQuery(document).ready(function(){wpPostLikeCount.wpPostLikeCount();});

} /* end modules/likes/post-count.js */

if ( jpconcat.files['modules/minileven/theme/pub/minileven/js/small-menu.js'] ) {

(function(){var nav=document.getElementById('access'),button,menu;if(!nav){return;}
button=nav.getElementsByTagName('h3')[0];menu=nav.getElementsByTagName('ul')[0];if(!button){return;}
if(!menu||!menu.childNodes.length){button.style.display='none';return;}
button.onclick=function(){if(-1===menu.className.indexOf('nav-menu')){menu.className='nav-menu';}
if(-1!==button.className.indexOf('toggled-on')){button.className=button.className.replace(' toggled-on','');menu.className=menu.className.replace(' toggled-on','');}else{button.className+=' toggled-on';menu.className+=' toggled-on';}};})();

} /* end modules/minileven/theme/pub/minileven/js/small-menu.js */

if ( jpconcat.files['modules/photon/photon.js'] ) {

(function($){var restore_dims=function(){$('img[data-recalc-dims]').each(function recalc(){var $this=$(this);if(this.complete){if($this.data('lazy-src')&&$this.attr('src')!==$this.data('lazy-src')){$this.load(recalc);return;}
var width=this.width,height=this.height;if(width&&width>0&&height&&height>0){$this.attr({width:width,height:height});reset_for_retina(this);}}
else{$this.load(recalc);}});},reset_for_retina=function(img){$(img).removeAttr('data-recalc-dims').removeAttr('scale');};$(document).ready(restore_dims);if('on'in $.fn){$(document.body).on('post-load',restore_dims);}else{$(document).delegate('body','post-load',restore_dims);}})(jQuery);

} /* end modules/photon/photon.js */

if ( jpconcat.files['modules/post-by-email/post-by-email.js'] ) {

jetpack_post_by_email={init:function(){jQuery('#jp-pbe-enable').click(jetpack_post_by_email.enable);jQuery('#jp-pbe-regenerate').click(jetpack_post_by_email.regenerate);jQuery('#jp-pbe-disable').click(jetpack_post_by_email.disable);},enable:function(){jQuery('#jp-pbe-enable').attr('disabled','disabled');jQuery('#jp-pbe-error').fadeOut();jQuery('#jp-pbe-spinner').fadeIn();var data={action:'jetpack_post_by_email_enable'};jQuery.post(ajaxurl,data,jetpack_post_by_email.handle_enabled);},handle_enabled:function(response){var enabled=false,error;try{error=JSON.parse(response);}catch(e){enabled=true;}
jQuery('#jp-pbe-regenerate').removeAttr('disabled');jQuery('#jp-pbe-disable').removeAttr('disabled');if(enabled){jQuery('#jp-pbe-enable').fadeOut(400,function(){jQuery('#jp-pbe-enable').removeAttr('disabled');jQuery('#jp-pbe-email').val(response);jQuery('#jp-pbe-info').fadeIn();});}else{jQuery('#jp-pbe-error').text(error.message);jQuery('#jp-pbe-error').fadeIn();jQuery('#jp-pbe-enable').removeAttr('disabled');}
jQuery('#jp-pbe-spinner').fadeOut();},regenerate:function(){jQuery('#jp-pbe-regenerate').attr('disabled','disabled');jQuery('#jp-pbe-disable').attr('disabled','disabled');jQuery('#jp-pbe-error').fadeOut();jQuery('#jp-pbe-spinner').fadeIn();var data={action:'jetpack_post_by_email_regenerate'};jQuery.post(ajaxurl,data,jetpack_post_by_email.handle_regenerated);},handle_regenerated:function(response){var regenerated=false,error;try{error=JSON.parse(response);}catch(e){regenerated=true;}
if(regenerated){jQuery('#jp-pbe-email-wrapper').fadeOut(400,function(){jQuery('#jp-pbe-email').val(response);jQuery('#jp-pbe-email-wrapper').fadeIn();});}else{jQuery('#jp-pbe-error').text(error.message);jQuery('#jp-pbe-error').fadeIn();}
jQuery('#jp-pbe-regenerate').removeAttr('disabled');jQuery('#jp-pbe-disable').removeAttr('disabled');jQuery('#jp-pbe-spinner').fadeOut();},disable:function(){jQuery('#jp-pbe-regenerate').attr('disabled','disabled');jQuery('#jp-pbe-disable').attr('disabled','disabled');jQuery('#jp-pbe-error').fadeOut();jQuery('#jp-pbe-spinner').fadeIn();var data={action:'jetpack_post_by_email_disable'};jQuery.post(ajaxurl,data,jetpack_post_by_email.handle_disabled);},handle_disabled:function(response){var disabled=false,error;try{error=JSON.parse(response);}catch(e){disabled=true;}
if('error'!==error.response){disabled=true;}
if(disabled){jQuery('#jp-pbe-enable').removeAttr('disabled');jQuery('#jp-pbe-info').fadeOut(400,function(){jQuery('#jp-pbe-regenerate').removeAttr('disabled');jQuery('#jp-pbe-disable').removeAttr('disabled');jQuery('#jp-pbe-enable').fadeIn();});}else{jQuery('#jp-pbe-regenerate').removeAttr('disabled');jQuery('#jp-pbe-disable').removeAttr('disabled');jQuery('#jp-pbe-error').text(error.message);jQuery('#jp-pbe-error').fadeIn();}
jQuery('#jp-pbe-spinner').fadeOut();}};jQuery(function(){jetpack_post_by_email.init();});

} /* end modules/post-by-email/post-by-email.js */

if ( jpconcat.files['modules/publicize/assets/publicize.js'] ) {

var showOptionsPage;jQuery(function($){showOptionsPage=function(service,nonce,connection,blogId){tb_show(null,null,null);$('body').append('<div id=\'TB_load\'><img src=\''+tb_pathToImage+'\' /></div>');$('#TB_load').show();var query='';if(connection){query+='&connection='+encodeURIComponent(connection);}
if('undefined'!==typeof(blogId)&&blogId){query+='&blog_id='+Number(blogId);}
$.post(ajaxurl,'action=publicize_'+service+'_options_page&_wpnonce='+nonce+query,function(response){$('#TB_load').remove();try{var obj=jQuery.parseJSON(response);if(obj&&'object'===typeof(obj)){if(obj.hasOwnProperty('fb_redirect')){location.href=obj.fb_redirect+'&redirect_uri='+encodeURIComponent(location.href);return;}}}catch(err){}
if(response){var blogID=$('input[name=wpas_ajax_blog_id]').val();var message=$('<div id="wpas-ajax-'+blogID+'" class="wrap"></div>').append(response);message.append('<a href="#TB_inline?thickbox&height=420&width=555&inlineId=wpas-ajax-'+blogID+'" id="wpas-click-'+blogID+'" class="new-thickbox" style="display: none;"></a>');$('#wpas-message').html(message);tb_init('a.new-thickbox');$('#wpas-click-'+blogID).click();var tb_height=parseInt($('#TB_ajaxContent').css('height'),10);var content_height=$('#thickbox-content').height();if(content_height<tb_height){var new_height=content_height+15;$('#TB_ajaxContent').css('height',new_height);var new_margin=parseInt($('#TB_window').css('margin-top'),10)+(tb_height-new_height)/ 2+'px';$('#TB_window').css('margin-top',new_margin);}
$('.save-options').unbind('click').click(function(){var sel=$('input[name=\'option\']:checked');var global=$('input[name=\'global\']:checked');var connection=$(this).data('connection');var token=encodeURIComponent(sel.val());var id=encodeURIComponent(sel.attr('id'));var type=encodeURIComponent(sel.attr('data-type'));var nonce=$(this).attr('rel');var global_conn='off';var global_nonce='';if(global.length){global_conn='on';global_nonce=global.val();}
$.post(ajaxurl,'action=publicize_'+service+'_options_save&connection='+connection+'&selected_id='+id+'&token='+token+'&type='+type+'&_wpnonce='+nonce+'&global='+global_conn+'&global_nonce='+global_nonce,function(){var frameNonce;tb_remove();frameNonce=document.location.search.match(/frame-nonce=([^&]+)/);if(/inside-newdash=1/.test(document.location.search)&&frameNonce){document.location='options-general.php?page=sharing&inside-newdash=1&frame-nonce'+frameNonce[1];}else{top.location='options-general.php?page=sharing';}});});}},'html');};$('body').append('<div id="wpas-message" style="display: none"></div>');$('.wpas-posts').change(function(){var inputs=$(this).parents('td:first').find(':input');var _this=this;var blogID=inputs.filter('[name=wpas_ajax_blog_id]').val();$('#waiting_'+blogID).show();$.post(ajaxurl,inputs.serialize()+'&action=wpas_post',function(response){myblogsResponse.call(_this,blogID,response);},'html');});$('.options').unbind('click').bind('click',function(e){e.preventDefault();e.stopPropagation();var service=$(this).attr('class').replace('options ','');var blogId=null;if('undefined'!==typeof($(this).attr('id'))){blogId=parseInt($(this).attr('id').replace('options-',''),10);}
var nonce=$(this).attr('href').replace('#nonce=','');var connection=$(this).data('connection');showOptionsPage.call(this,service,nonce,connection,blogId);});publicizeConnTestStart=function(){$('.pub-connection-test').addClass('test-in-progress');$.post(ajaxurl,{action:'test_publicize_conns'},publicizeConnTestComplete);};publicizeConnRefreshClick=function(event){event.preventDefault();var popupURL=event.currentTarget.href;var popupTitle=event.currentTarget.title;var popupWin=window.open(popupURL,popupTitle,'');var popupWinTimer=window.setInterval(function(){if(popupWin.closed!==false){window.clearInterval(popupWinTimer);publicizeConnTestStart();}},500);};publicizeConnTestComplete=function(response){$('.pub-connection-test').removeClass('test-in-progress');$.each(response.data,function(index,testResult){var testSelector='#pub-connection-test-'+testResult.connectionID;if(testResult.connectionTestPassed){$(testSelector).addClass('test-passed').html('').removeClass('test-failed');}else{$(testSelector).addClass('test-failed').html('<p><span class="pub-connection-error">'+testResult.connectionTestMessage+'</span></p>').removeClass('test-passed');if(testResult.userCanRefresh){$(testSelector).append('<br/>');$('<a/>',{'class':'pub-refresh-button button','title':testResult.refreshText,'href':testResult.refreshURL,'text':testResult.refreshText,'target':'_refresh_'+testResult.serviceName}).appendTo(testSelector).click(publicizeConnRefreshClick);}}});};$(document).ready(function(){if($('.pub-connection-test').length){publicizeConnTestStart();}});});

} /* end modules/publicize/assets/publicize.js */

if ( jpconcat.files['modules/related-posts/related-posts.js'] ) {

(function($){var jprp={response:null,getEndpointURL:function(URL){var locationObject=document.location;if('string'===typeof(URL)&&URL.match(/^https?:\/\//)){locationObject=document.createElement('a');locationObject.href=URL;}
var args='relatedposts=1';if(!$('#jp-relatedposts').data('exclude')){args+='&relatedposts_exclude='+$('#jp-relatedposts').data('exclude');}
if(''===locationObject.search){return locationObject.pathname+'?'+args;}else{return locationObject.pathname+locationObject.search+'&'+args;}},getAnchor:function(post){var anchor_title=post.title;if(''!==(''+post.excerpt)){anchor_title+='\n\n'+post.excerpt;}
var anchor=$('<a>');anchor.attr({'class':'jp-relatedposts-post-a','href':post.url,'title':anchor_title,'rel':'nofollow','data-origin':post.url_meta.origin,'data-position':post.url_meta.position});var anchor_html=$('<div>').append(anchor).html();return[anchor_html.substring(0,anchor_html.length-4),'</a>'];},generateMinimalHtml:function(posts){var self=this;var html='';$.each(posts,function(index,post){var anchor=self.getAnchor(post);var classes='jp-relatedposts-post jp-relatedposts-post'+index;html+='<p class="'+classes+'" data-post-id="'+post.id+'" data-post-format="'+post.format+'">';html+='<span class="jp-relatedposts-post-title">'+anchor[0]+post.title+anchor[1]+'</span>';html+='<span class="jp-relatedposts-post-context">'+post.context+'</span>';html+='</p>';});return'<div class="jp-relatedposts-items jp-relatedposts-items-minimal">'+html+'</div>';},generateVisualHtml:function(posts){var self=this;var html='';$.each(posts,function(index,post){var anchor=self.getAnchor(post);var classes='jp-relatedposts-post jp-relatedposts-post'+index;if(!post.img.src){classes+=' jp-relatedposts-post-nothumbs';}else{classes+=' jp-relatedposts-post-thumbs';}
html+='<div class="'+classes+'" data-post-id="'+post.id+'" data-post-format="'+post.format+'">';if(post.img.src){html+=anchor[0]+'<img class="jp-relatedposts-post-img" src="'+post.img.src+'" width="'+post.img.width+'" alt="'+post.title+'" />'+anchor[1];}
html+='<h4 class="jp-relatedposts-post-title">'+anchor[0]+post.title+anchor[1]+'</h4>';html+='<p class="jp-relatedposts-post-excerpt">'+post.excerpt+'</p>';html+='<p class="jp-relatedposts-post-context">'+post.context+'</p>';html+='</div>';});return'<div class="jp-relatedposts-items jp-relatedposts-items-visual">'+html+'</div>';},getTrackedUrl:function(anchor){var args='relatedposts_hit=1';args+='&relatedposts_origin='+$(anchor).data('origin');args+='&relatedposts_position='+$(anchor).data('position');if(''===anchor.search){return anchor.pathname+'?'+args;}else{return anchor.pathname+anchor.search+'&'+args;}},cleanupTrackedUrl:function(){if('function'!==typeof history.replaceState){return;}
var cleaned_search=document.location.search.replace(/\brelatedposts_[a-z]+=[0-9]*&?\b/gi,'');if('?'===cleaned_search){cleaned_search='';}
if(document.location.search!==cleaned_search){history.replaceState({},document.title,document.location.pathname+cleaned_search);}}};$(function(){jprp.cleanupTrackedUrl();$.getJSON(jprp.getEndpointURL(),function(response){if(0===response.items.length||0===$('#jp-relatedposts').length){return;}
jprp.response=response;var html='';if(!response.show_thumbnails){html=jprp.generateMinimalHtml(response.items);}else{html=jprp.generateVisualHtml(response.items);}
$('#jp-relatedposts').append(html).show();$('#jp-relatedposts a.jp-relatedposts-post-a').click(function(){this.href=jprp.getTrackedUrl(this);});});});})(jQuery);

} /* end modules/related-posts/related-posts.js */

if ( jpconcat.files['modules/sharedaddy/admin-sharing.js'] ) {

(function($){$(document).ready(function(){function enable_share_button(){$('.preview a.sharing-anchor').unbind('mouseenter mouseenter').hover(function(){if($(this).data('hasappeared')!==true){var item=$('.sharing-hidden .inner');var original=$(this).parents('li');var timer=setTimeout(function(){$(item).css({left:$(original).position().left+'px',top:$(original).position().top+$(original).height()+3+'px'}).slideDown(200,function(){$(original).data('hasappeared',true).data('hasoriginal',true).data('hasitem',false);$(item).mouseleave(handler_item_leave).mouseenter(handler_item_enter);$(original).mouseleave(handler_original_leave).mouseenter(handler_original_enter);$(original).click(close_it);});var handler_item_leave=function(){$(original).data('hasitem',false);if($(original).data('hasoriginal')===false){var timer=setTimeout(close_it,800);$(original).data('timer2',timer);}};var handler_item_enter=function(){$(original).data('hasitem',true);clearTimeout($(original).data('timer2'));};var handler_original_leave=function(){$(original).data('hasoriginal',false);if($(original).data('hasitem')===false){var timer=setTimeout(close_it,800);$(original).data('timer2',timer);}};var handler_original_enter=function(){$(original).data('hasoriginal',true);clearTimeout($(original).data('timer2'));};var close_it=function(){item.slideUp(200);$(original).unbind('mouseleave',handler_original_leave).unbind('mouseenter',handler_original_enter);$(item).unbind('mouseleave',handler_item_leave).unbind('mouseenter',handler_item_leave);$(original).data('hasappeared',false);$(original).unbind('click',close_it);return false;};},200);$(this).data('timer',timer);}},function(){clearTimeout($(this).data('timer'));$(this).data('timer',false);});}
function update_preview(){var button_style=$('#button_style').val();$('#live-preview ul.preview li').remove();if($('#save-enabled-shares input[name=visible]').val()||$('#save-enabled-shares input[name=hidden]').val()){$('#live-preview ul.preview').append($('#live-preview ul.archive .sharing-label').clone());}
$('ul.services-enabled li').each(function(){if($(this).hasClass('service')){var service=$(this).attr('id');$('#live-preview ul.preview').append($('#live-preview ul.archive li.preview-'+service).clone());}});if($('#save-enabled-shares input[name=hidden]').val()){$('#live-preview ul.preview').append($('#live-preview ul.archive .share-more').parent().clone());$('.sharing-hidden ul li').remove();$('ul.services-hidden li').each(function(){if($(this).hasClass('service')){var service=$(this).attr('id');$('.sharing-hidden .inner ul').append($('#live-preview ul.archive .preview-'+service).clone());}});enable_share_button();}
$('#live-preview div.sharedaddy').removeClass('sd-social-icon');$('#live-preview li.advanced').removeClass('no-icon');if('icon'===button_style){$('#live-preview ul.preview div span').html('&nbsp;').parent().addClass('no-text');$('#live-preview div.sharedaddy').addClass('sd-social-icon');}else if('official'===button_style){$('#live-preview ul.preview .advanced').each(function(){if(!$(this).hasClass('preview-press-this')&&!$(this).hasClass('preview-email')&&!$(this).hasClass('preview-print')&&!$(this).hasClass('share-custom')){$(this).find('.option a span').html('').parent().removeClass('sd-button').parent().attr('class','option option-smart-on');}});}else if('text'===button_style){$('#live-preview li.advanced').addClass('no-icon');}}
window.sharing_option_changed=function(){var item=this;$(this).parents('li:first').css('backgroundImage','url("'+sharing_loading_icon+'")');$(this).parents('form').ajaxSubmit(function(response){if(response.indexOf('<!---')>=0){var button=response.substring(0,response.indexOf('<!--->'));var preview=response.substring(response.indexOf('<!--->')+6);if($(item).is(':submit')===true){$(item).parents('li:first').replaceWith(button);}
$('#live-preview ul.archive li.preview-'+$(item).parents('form').find('input[name=service]').val()).replaceWith(preview);}
update_preview();$(item).parents('li:first').removeAttr('style');});if($(item).is(':submit')===true){return false;}
return true;};function showExtraOptions(service){jQuery('.'+service+'-extra-options').css({backgroundColor:'#ffffcc'}).fadeIn();}
function hideExtraOptions(service){jQuery('.'+service+'-extra-options').fadeOut('slow');}
function save_services(){$('#enabled-services h3 img').show();if($('#enabled-services ul.services-enabled li.service').length>0){$('#drag-instructions').hide();}
else{$('#drag-instructions').show();}
if($('#enabled-services li.service').length>0){$('#live-preview .services h2').hide();}
else{$('#live-preview .services h2').show();}
var visible=[],hidden=[];$('ul.services-enabled li').each(function(){if($(this).hasClass('service')){visible[visible.length]=$(this).attr('id');showExtraOptions($(this).attr('id'));}});$('ul.services-available li').each(function(){if($(this).hasClass('service')){hideExtraOptions($(this).attr('id'));}});$('ul.services-hidden li').each(function(){if($(this).hasClass('service')){hidden[hidden.length]=$(this).attr('id');showExtraOptions($(this).attr('id'));}});$('#save-enabled-shares input[name=visible]').val(visible.join(','));$('#save-enabled-shares input[name=hidden]').val(hidden.join(','));update_preview();$('#save-enabled-shares').ajaxSubmit(function(){$('#enabled-services h3 img').hide();});}
$('#enabled-services .services ul').sortable({receive:function(){save_services();},stop:function(){save_services();$('li.service').enableSelection();},over:function(){$(this).find('ul').addClass('dropping');$('#enabled-services li.end-fix').remove();$('#enabled-services ul').append('<li class="end-fix"></li>');},out:function(){$(this).find('ul').removeClass('dropping');$('#enabled-services li.end-fix').remove();$('#enabled-services ul').append('<li class="end-fix"></li>');},helper:function(event,ui){ui.find('.advanced-form').hide();return ui.clone();},start:function(){$('.advanced-form').hide();$('li.service').disableSelection();},placeholder:'dropzone',opacity:0.8,delay:150,forcePlaceholderSize:true,items:'li',connectWith:'#available-services ul, #enabled-services .services ul',cancel:'.advanced-form'});$('#available-services ul').sortable({opacity:0.8,delay:150,cursor:'move',connectWith:'#enabled-services .services ul',placeholder:'dropzone',forcePlaceholderSize:true,start:function(){$('.advanced-form').hide();}});$('.service').on('keydown',function(e){switch(e.keyCode){case 13:keyboardDragDrop($(this));break;case 32:keyboardDragDrop($(this));break;case 37:keyboardChangeOrder($(this),'left');break;case 39:keyboardChangeOrder($(this),'right');break;default:return true;}
e.preventDefault();});function keyboardChangeOrder($this,dir){var thisParent=$this.parent(),thisParentsChildren=thisParent.find('li'),thisPosition=thisParentsChildren.index($this)+1,totalChildren=thisParentsChildren.length-1,thisService;if(thisParent.hasClass('services-available')){return;}
if('left'===dir){if(1===thisPosition){return;}
var prevSibling=$this.prev();thisService=$this.detach();prevSibling.before(thisService);prevSibling.prev().focus();}
if('right'===dir){if(thisPosition===totalChildren){return;}
var nextSibling=$this.next();thisService=$this.detach();nextSibling.after(thisService);nextSibling.next().focus();}
save_services();}
function keyboardDragDrop($this){var dropzone,thisParent=$this.parent();if(thisParent.hasClass('services-available')){dropzone='services-enabled';}else if(thisParent.hasClass('services-enabled')){dropzone='services-hidden';}else{dropzone='services-available';}
var thisService=$this.detach();$('.'+dropzone).prepend(thisService).find('li:first-child').focus();save_services();}
$('.preview-hidden a').click(function(){$(this).parent().find('.preview').toggle();return false;});$('#new-service form').ajaxForm({beforeSubmit:function(){$('#new-service-form .error').hide();$('#new-service-form img').show();$('#new-service-form input[type=submit]').prop('disabled',true);},success:function(response){$('#new-service-form img').hide();if((''+response)==='1'){$('#new-service-form .inerror').removeClass('inerror').addClass('error');$('#new-service-form .error').show();$('#new-service-form input[type=submit]').prop('disabled',false);}
else{document.location=document.location.href.replace(/&create_new_service=true/i,'');}}});function init_handlers(){$('#services-config a.remove').unbind('click').click(function(){var form=$(this).parent().next();$(this).parents('li:first').css('backgroundImage','url("'+sharing_loading_icon+'")');form.ajaxSubmit(function(){form.parents('li:first').fadeOut(function(){$(this).remove();update_preview();});});return false;});}
$('#button_style').change(function(){update_preview();return true;}).change();$('input[name=sharing_label]').blur(function(){$('#live-preview h3.sd-title').text($('<div/>').text($(this).val()).html());});init_handlers();enable_share_button();});})(jQuery);

} /* end modules/sharedaddy/admin-sharing.js */

if ( jpconcat.files['modules/sharedaddy/sharing.js'] ) {

var WPCOMSharing={done_urls:[],get_counts:function(url){if('undefined'!=typeof WPCOMSharing.done_urls[WPCOM_sharing_counts[url]])
return;if(jQuery('#sharing-facebook-'+WPCOM_sharing_counts[url]).length)
jQuery.getScript('https://api.facebook.com/method/fql.query?query='+encodeURIComponent("SELECT total_count, url FROM link_stat WHERE url='"+url+"'")+'&format=json&callback=WPCOMSharing.update_facebook_count');if(jQuery('#sharing-twitter-'+WPCOM_sharing_counts[url]).length)
jQuery.getScript(window.location.protocol+'//cdn.api.twitter.com/1/urls/count.json?callback=WPCOMSharing.update_twitter_count&url='+encodeURIComponent(url));if(jQuery('#sharing-linkedin-'+WPCOM_sharing_counts[url]).length)
jQuery.getScript(window.location.protocol+'//www.linkedin.com/countserv/count/share?format=jsonp&callback=WPCOMSharing.update_linkedin_count&url='+encodeURIComponent(url));WPCOMSharing.done_urls[WPCOM_sharing_counts[url]]=true;},update_facebook_count:function(data){if('undefined'!=typeof data[0].total_count&&(data[0].total_count*1)>0){WPCOMSharing.inject_share_count('sharing-facebook-'+WPCOM_sharing_counts[data[0].url],data[0].total_count);}},update_twitter_count:function(data){if('undefined'!=typeof data.count&&(data.count*1)>0){if('undefined'==typeof WPCOM_sharing_counts[data.url])
data.url=data.url.replace(/\/$/,"");WPCOMSharing.inject_share_count('sharing-twitter-'+WPCOM_sharing_counts[data.url],data.count);}},update_linkedin_count:function(data){if('undefined'!=typeof data.count&&(data.count*1)>0){WPCOMSharing.inject_share_count('sharing-linkedin-'+WPCOM_sharing_counts[data.url],data.count);}},inject_share_count:function(dom_id,count){jQuery('#'+dom_id+' span').append('<span class="share-count">'+WPCOMSharing.format_count(count)+'</span>');},format_count:function(count){if(count<1000)
return count;if(count>=1000&&count<10000)
return String(count).substring(0,1)+'K+';return'10K+';}};(function($){$.fn.extend({share_is_email:function(value){return /^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i.test(this.val());}});$(document).on('ready',WPCOMSharing_do);$(document.body).on('post-load',WPCOMSharing_do);function WPCOMSharing_do(){if('undefined'!=typeof WPCOM_sharing_counts){for(var url in WPCOM_sharing_counts){WPCOMSharing.get_counts(url);}}
var $more_sharing_buttons=$('.sharedaddy a.sharing-anchor');$more_sharing_buttons.click(function(){return false;});$('.sharedaddy a').each(function(){if($(this).attr('href')&&$(this).attr('href').indexOf('share=')!=-1)
$(this).attr('href',$(this).attr('href')+'&nb=1');});$more_sharing_buttons.on('click',function(){var $more_sharing_button=$(this),$more_sharing_pane=$more_sharing_button.parents('div:first').find('.inner');if($more_sharing_pane.is(':animated')){return;}
if(true===$more_sharing_pane.data('justSlid')){return;}
$('#sharing_email').slideUp(200);$more_sharing_pane.css({left:$more_sharing_button.position().left+'px',top:$more_sharing_button.position().top+$more_sharing_button.height()+3+'px'}).slideToggle(200);});if(document.ontouchstart===undefined){$more_sharing_buttons.hover(function(){var $more_sharing_button=$(this),$more_sharing_pane=$more_sharing_button.parents('div:first').find('.inner');if(!$more_sharing_pane.is(':animated')){var timer=setTimeout(function(){$('#sharing_email').slideUp(200);$more_sharing_pane.data('justSlid',true);$more_sharing_pane.css({left:$more_sharing_button.position().left+'px',top:$more_sharing_button.position().top+$more_sharing_button.height()+3+'px'}).slideDown(200,function(){$more_sharing_button.data('hasoriginal',true).data('hasitem',false);setTimeout(function(){$more_sharing_pane.data('justSlid',false);},300);if($more_sharing_pane.find('.share-google-plus-1').size()){return;}
$more_sharing_pane.mouseleave(handler_item_leave).mouseenter(handler_item_enter);$more_sharing_button.mouseleave(handler_original_leave).mouseenter(handler_original_enter);});var handler_item_leave=function(){$more_sharing_button.data('hasitem',false);if($more_sharing_button.data('hasoriginal')===false){var timer=setTimeout(close_it,800);$more_sharing_button.data('timer2',timer);}};var handler_item_enter=function(){$more_sharing_button.data('hasitem',true);clearTimeout($more_sharing_button.data('timer2'));}
var handler_original_leave=function(){$more_sharing_button.data('hasoriginal',false);if($more_sharing_button.data('hasitem')===false){var timer=setTimeout(close_it,800);$more_sharing_button.data('timer2',timer);}};var handler_original_enter=function(){$more_sharing_button.data('hasoriginal',true);clearTimeout($more_sharing_button.data('timer2'));};var close_it=function(){$more_sharing_pane.data('justSlid',true);$more_sharing_pane.slideUp(200,function(){setTimeout(function(){$more_sharing_pane.data('justSlid',false);},300);});$more_sharing_button.unbind('mouseleave',handler_original_leave).unbind('mouseenter',handler_original_enter);$more_sharing_pane.unbind('mouseleave',handler_item_leave).unbind('mouseenter',handler_item_leave);return false;};},200);$more_sharing_button.data('timer',timer);}},function(){$more_sharing_buttons.each(function(){clearTimeout($(this).data('timer'));});$more_sharing_buttons.data('timer',false);});}
$(document).click(function(){$more_sharing_buttons.each(function(){clearTimeout($(this).data('timer'));});$more_sharing_buttons.data('timer',false);$('.sharedaddy .inner').slideUp();});$('.sharedaddy ul').each(function(item){if('yep'==$(this).data('has-click-events'))
return;$(this).data('has-click-events','yep');printUrl=function(uniqueId,urlToPrint){$('body:first').append('<iframe style="position:fixed;top:100;left:100;height:1px;width:1px;border:none;" id="printFrame-'+uniqueId+'" name="printFrame-'+uniqueId+'" src="'+urlToPrint+'" onload="frames[\'printFrame-'+uniqueId+'\'].focus();frames[\'printFrame-'+uniqueId+'\'].print();"></iframe>')};$(this).find('a.share-print').click(function(){ref=$(this).attr('href');var do_print=function(){if(ref.indexOf('#print')==-1){uid=new Date().getTime();printUrl(uid,ref);}
else
print();}
if($(this).parents('.sharing-hidden').length>0){$(this).parents('.inner').slideUp(0,function(){do_print();});}
else
do_print();return false;});$(this).find('a.share-press-this').click(function(){var s='';if(window.getSelection)
s=window.getSelection();else if(document.getSelection)
s=document.getSelection();else if(document.selection)
s=document.selection.createRange().text;if(s)
$(this).attr('href',$(this).attr('href')+'&sel='+encodeURI(s));if(!window.open($(this).attr('href'),'t','toolbar=0,resizable=1,scrollbars=1,status=1,width=720,height=570'))
document.location.href=$(this).attr('href');return false;});$('a.share-email',this).on('click',function(){var url=$(this).attr('href'),key;if($('#sharing_email').is(':visible'))
$('#sharing_email').slideUp(200);else{$('.sharedaddy .inner').slideUp();$('#sharing_email .response').remove();$('#sharing_email form').show();$('#sharing_email form input[type=submit]').removeAttr('disabled');$('#sharing_email form a.sharing_cancel').show();key='';if($('#recaptcha_public_key').length>0)
key=$('#recaptcha_public_key').val();Recaptcha.create(key,'sharing_recaptcha',{lang:recaptcha_options.lang});$('#sharing_email').css({left:$(this).offset().left+'px',top:$(this).offset().top+$(this).height()+'px'}).slideDown(200);$('#sharing_email a.sharing_cancel').unbind('click').click(function(){$('#sharing_email .errors').hide();$('#sharing_email').slideUp(200);$('#sharing_background').fadeOut();return false;});$('#sharing_email input[type=submit]').unbind('click').click(function(){var form=$(this).parents('form');$(this).prop('disabled',true);form.find('a.sharing_cancel').hide();form.find('img.loading').show();$('#sharing_email .errors').hide();$('#sharing_email .error').removeClass('error');if($('#sharing_email input[name=source_email]').share_is_email()==false)
$('#sharing_email input[name=source_email]').addClass('error');if($('#sharing_email input[name=target_email]').share_is_email()==false)
$('#sharing_email input[name=target_email]').addClass('error');if($('#sharing_email .error').length==0){$.ajax({url:url,type:'POST',data:form.serialize(),success:function(response){form.find('img.loading').hide();if(response=='1'||response=='2'||response=='3'){$('#sharing_email .errors-'+response).show();form.find('input[type=submit]').removeAttr('disabled');form.find('a.sharing_cancel').show();Recaptcha.reload();}
else{$('#sharing_email form').hide();$('#sharing_email').append(response);$('#sharing_email a.sharing_cancel').click(function(){$('#sharing_email').slideUp(200);$('#sharing_background').fadeOut();return false;});}}});return false;}
form.find('img.loading').hide();form.find('input[type=submit]').removeAttr('disabled');form.find('a.sharing_cancel').show();$('#sharing_email .errors-1').show();return false;});}
return false;});});$('li.share-email, li.share-custom a.sharing-anchor').addClass('share-service-visible');}})(jQuery);var RecaptchaTemplates={};RecaptchaTemplates.VertHtml='<table id="recaptcha_table" class="recaptchatable" > <tr> <td colspan="6" class=\'recaptcha_r1_c1\'></td> </tr> <tr> <td class=\'recaptcha_r2_c1\'></td> <td colspan="4" class=\'recaptcha_image_cell\'><div id="recaptcha_image"></div></td> <td class=\'recaptcha_r2_c2\'></td> </tr> <tr> <td rowspan="6" class=\'recaptcha_r3_c1\'></td> <td colspan="4" class=\'recaptcha_r3_c2\'></td> <td rowspan="6" class=\'recaptcha_r3_c3\'></td> </tr> <tr> <td rowspan="3" class=\'recaptcha_r4_c1\' height="49"> <div class="recaptcha_input_area"> <label for="recaptcha_response_field" class="recaptcha_input_area_text"><span id="recaptcha_instructions_image" class="recaptcha_only_if_image recaptcha_only_if_no_incorrect_sol"></span><span id="recaptcha_instructions_audio" class="recaptcha_only_if_no_incorrect_sol recaptcha_only_if_audio"></span><span id="recaptcha_instructions_error" class="recaptcha_only_if_incorrect_sol"></span></label><br/> <input name="recaptcha_response_field" id="recaptcha_response_field" type="text" /> </div> </td> <td rowspan="4" class=\'recaptcha_r4_c2\'></td> <td><a id=\'recaptcha_reload_btn\'><img id=\'recaptcha_reload\' width="25" height="17" /></a></td> <td rowspan="4" class=\'recaptcha_r4_c4\'></td> </tr> <tr> <td><a id=\'recaptcha_switch_audio_btn\' class="recaptcha_only_if_image"><img id=\'recaptcha_switch_audio\' width="25" height="16" alt="" /></a><a id=\'recaptcha_switch_img_btn\' class="recaptcha_only_if_audio"><img id=\'recaptcha_switch_img\' width="25" height="16" alt=""/></a></td> </tr> <tr> <td><a id=\'recaptcha_whatsthis_btn\'><img id=\'recaptcha_whatsthis\' width="25" height="16" /></a></td> </tr> <tr> <td class=\'recaptcha_r7_c1\'></td> <td class=\'recaptcha_r8_c1\'></td> </tr> </table> ';RecaptchaTemplates.CleanCss=".recaptchatable td img{display:block}.recaptchatable .recaptcha_image_cell center img{height:57px}.recaptchatable .recaptcha_image_cell center{height:57px}.recaptchatable .recaptcha_image_cell{background-color:white;height:57px;padding:7px!important}.recaptchatable,#recaptcha_area tr,#recaptcha_area td,#recaptcha_area th{margin:0!important;border:0!important;border-collapse:collapse!important;vertical-align:middle!important}.recaptchatable *{margin:0;padding:0;border:0;color:black;position:static;top:auto;left:auto;right:auto;bottom:auto;text-align:left!important}.recaptchatable #recaptcha_image{margin:auto;border:1px solid #dfdfdf!important}.recaptchatable a img{border:0}.recaptchatable a,.recaptchatable a:hover{-moz-outline:none;border:0!important;padding:0!important;text-decoration:none;color:blue;background:none!important;font-weight:normal}.recaptcha_input_area{position:relative!important;background:none!important}.recaptchatable label.recaptcha_input_area_text{border:1px solid #dfdfdf!important;margin:0!important;padding:0!important;position:static!important;top:auto!important;left:auto!important;right:auto!important;bottom:auto!important}.recaptcha_theme_red label.recaptcha_input_area_text,.recaptcha_theme_white label.recaptcha_input_area_text{color:black!important}.recaptcha_theme_blackglass label.recaptcha_input_area_text{color:white!important}.recaptchatable #recaptcha_response_field{font-size:11pt}.recaptcha_theme_blackglass #recaptcha_response_field,.recaptcha_theme_white #recaptcha_response_field{border:1px solid gray}.recaptcha_theme_red #recaptcha_response_field{border:1px solid #cca940}.recaptcha_audio_cant_hear_link{font-size:7pt;color:black}.recaptchatable{line-height:1em;border:1px solid #dfdfdf!important}.recaptcha_error_text{color:red}";RecaptchaTemplates.CleanHtml='<table id="recaptcha_table" class="recaptchatable"> <tr height="73"> <td class=\'recaptcha_image_cell\' width="302"><center><div id="recaptcha_image"></div></center></td> <td style="padding: 10px 7px 7px 7px;"> <a id=\'recaptcha_reload_btn\'><img id=\'recaptcha_reload\' width="25" height="18" alt="" /></a> <a id=\'recaptcha_switch_audio_btn\' class="recaptcha_only_if_image"><img id=\'recaptcha_switch_audio\' width="25" height="15" alt="" /></a><a id=\'recaptcha_switch_img_btn\' class="recaptcha_only_if_audio"><img id=\'recaptcha_switch_img\' width="25" height="15" alt=""/></a> <a id=\'recaptcha_whatsthis_btn\'><img id=\'recaptcha_whatsthis\' width="25" height="16" /></a> </td> <td style="padding: 18px 7px 18px 7px;"> <img id=\'recaptcha_logo\' alt="" width="71" height="36" /> </td> </tr> <tr> <td style="padding-left: 7px;"> <div class="recaptcha_input_area" style="padding-top: 2px; padding-bottom: 7px;"> <input style="border: 1px solid #3c3c3c; width: 302px;" name="recaptcha_response_field" id="recaptcha_response_field" type="text" /> </div> </td> <td></td> <td style="padding: 4px 7px 12px 7px;"> <img id="recaptcha_tagline" width="71" height="17" /> </td> </tr> </table> ';RecaptchaTemplates.ContextHtml='<table id="recaptcha_table" class="recaptchatable"> <tr> <td colspan="6" class=\'recaptcha_r1_c1\'></td> </tr> <tr> <td class=\'recaptcha_r2_c1\'></td> <td colspan="4" class=\'recaptcha_image_cell\'><div id="recaptcha_image"></div></td> <td class=\'recaptcha_r2_c2\'></td> </tr> <tr> <td rowspan="6" class=\'recaptcha_r3_c1\'></td> <td colspan="4" class=\'recaptcha_r3_c2\'></td> <td rowspan="6" class=\'recaptcha_r3_c3\'></td> </tr> <tr> <td rowspan="3" class=\'recaptcha_r4_c1\' height="49"> <div class="recaptcha_input_area"> <label for="recaptcha_response_field" class="recaptcha_input_area_text"><span id="recaptcha_instructions_context" class="recaptcha_only_if_image recaptcha_only_if_no_incorrect_sol"></span><span id="recaptcha_instructions_audio" class="recaptcha_only_if_no_incorrect_sol recaptcha_only_if_audio"></span><span id="recaptcha_instructions_error" class="recaptcha_only_if_incorrect_sol"></span></label><br/> <input name="recaptcha_response_field" id="recaptcha_response_field" type="text" /> </div> </td> <td rowspan="4" class=\'recaptcha_r4_c2\'></td> <td><a id=\'recaptcha_reload_btn\'><img id=\'recaptcha_reload\' width="25" height="17" /></a></td> <td rowspan="4" class=\'recaptcha_r4_c4\'></td> </tr> <tr> <td><a id=\'recaptcha_switch_audio_btn\' class="recaptcha_only_if_image"><img id=\'recaptcha_switch_audio\' width="25" height="16" alt="" /></a><a id=\'recaptcha_switch_img_btn\' class="recaptcha_only_if_audio"><img id=\'recaptcha_switch_img\' width="25" height="16" alt=""/></a></td> </tr> <tr> <td><a id=\'recaptcha_whatsthis_btn\'><img id=\'recaptcha_whatsthis\' width="25" height="16" /></a></td> </tr> <tr> <td class=\'recaptcha_r7_c1\'></td> <td class=\'recaptcha_r8_c1\'></td> </tr> </table> ';RecaptchaTemplates.VertCss=".recaptchatable td img{display:block}.recaptchatable .recaptcha_r1_c1{background:url(IMGROOT/sprite.png) 0 -63px no-repeat;width:318px;height:9px}.recaptchatable .recaptcha_r2_c1{background:url(IMGROOT/sprite.png) -18px 0 no-repeat;width:9px;height:57px}.recaptchatable .recaptcha_r2_c2{background:url(IMGROOT/sprite.png) -27px 0 no-repeat;width:9px;height:57px}.recaptchatable .recaptcha_r3_c1{background:url(IMGROOT/sprite.png) 0 0 no-repeat;width:9px;height:63px}.recaptchatable .recaptcha_r3_c2{background:url(IMGROOT/sprite.png) -18px -57px no-repeat;width:300px;height:6px}.recaptchatable .recaptcha_r3_c3{background:url(IMGROOT/sprite.png) -9px 0 no-repeat;width:9px;height:63px}.recaptchatable .recaptcha_r4_c1{background:url(IMGROOT/sprite.png) -43px 0 no-repeat;width:171px;height:49px}.recaptchatable .recaptcha_r4_c2{background:url(IMGROOT/sprite.png) -36px 0 no-repeat;width:7px;height:57px}.recaptchatable .recaptcha_r4_c4{background:url(IMGROOT/sprite.png) -214px 0 no-repeat;width:97px;height:57px}.recaptchatable .recaptcha_r7_c1{background:url(IMGROOT/sprite.png) -43px -49px no-repeat;width:171px;height:8px}.recaptchatable .recaptcha_r8_c1{background:url(IMGROOT/sprite.png) -43px -49px no-repeat;width:25px;height:8px}.recaptchatable .recaptcha_image_cell center img{height:57px}.recaptchatable .recaptcha_image_cell center{height:57px}.recaptchatable .recaptcha_image_cell{background-color:white;height:57px}#recaptcha_area,#recaptcha_table{width:318px!important}.recaptchatable,#recaptcha_area tr,#recaptcha_area td,#recaptcha_area th{margin:0!important;border:0!important;padding:0!important;border-collapse:collapse!important;vertical-align:middle!important}.recaptchatable *{margin:0;padding:0;border:0;font-family:helvetica,sans-serif;font-size:8pt;color:black;position:static;top:auto;left:auto;right:auto;bottom:auto;text-align:left!important}.recaptchatable #recaptcha_image{margin:auto}.recaptchatable img{border:0!important;margin:0!important;padding:0!important}.recaptchatable a,.recaptchatable a:hover{-moz-outline:none;border:0!important;padding:0!important;text-decoration:none;color:blue;background:none!important;font-weight:normal}.recaptcha_input_area{position:relative!important;width:146px!important;height:45px!important;margin-left:20px!important;margin-right:5px!important;margin-top:4px!important;background:none!important}.recaptchatable label.recaptcha_input_area_text{margin:0!important;padding:0!important;position:static!important;top:auto!important;left:auto!important;right:auto!important;bottom:auto!important;background:none!important;height:auto!important;width:auto!important}.recaptcha_theme_red label.recaptcha_input_area_text,.recaptcha_theme_white label.recaptcha_input_area_text{color:black!important}.recaptcha_theme_blackglass label.recaptcha_input_area_text{color:white!important}.recaptchatable #recaptcha_response_field{width:145px!important;position:absolute!important;bottom:7px!important;padding:0!important;margin:0!important;font-size:10pt}.recaptcha_theme_blackglass #recaptcha_response_field,.recaptcha_theme_white #recaptcha_response_field{border:1px solid gray}.recaptcha_theme_red #recaptcha_response_field{border:1px solid #cca940}.recaptcha_audio_cant_hear_link{font-size:7pt;color:black}.recaptchatable{line-height:1em}#recaptcha_instructions_error{color:red!important}";var RecaptchaStr_en={visual_challenge:"Get a visual challenge",audio_challenge:"Get an audio challenge",refresh_btn:"Get a new challenge",instructions_visual:"Type the two words:",instructions_context:"Type the words in the boxes:",instructions_audio:"Type what you hear:",help_btn:"Help",play_again:"Play sound again",cant_hear_this:"Download sound as MP3",incorrect_try_again:"Incorrect. Try again."},RecaptchaStr_de={visual_challenge:"Visuelle Aufgabe generieren",audio_challenge:"Audio-Aufgabe generieren",refresh_btn:"Neue Aufgabe generieren",instructions_visual:"Gib die 2 W\u00f6rter ein:",instructions_context:"",instructions_audio:"Gib die 8 Ziffern ein:",help_btn:"Hilfe",incorrect_try_again:"Falsch. Nochmals versuchen!"},RecaptchaStr_es={visual_challenge:"Obt\u00e9n un reto visual",audio_challenge:"Obt\u00e9n un reto audible",refresh_btn:"Obt\u00e9n un nuevo reto",instructions_visual:"Escribe las 2 palabras:",instructions_context:"",instructions_audio:"Escribe los 8 n\u00fameros:",help_btn:"Ayuda",incorrect_try_again:"Incorrecto. Otro intento."},RecaptchaStr_fr={visual_challenge:"D\u00e9fi visuel",audio_challenge:"D\u00e9fi audio",refresh_btn:"Nouveau d\u00e9fi",instructions_visual:"Entrez les deux mots:",instructions_context:"",instructions_audio:"Entrez les huit chiffres:",help_btn:"Aide",incorrect_try_again:"Incorrect."},RecaptchaStr_nl={visual_challenge:"Test me via een afbeelding",audio_challenge:"Test me via een geluidsfragment",refresh_btn:"Nieuwe uitdaging",instructions_visual:"Type de twee woorden:",instructions_context:"",instructions_audio:"Type de acht cijfers:",help_btn:"Help",incorrect_try_again:"Foute invoer."},RecaptchaStr_pt={visual_challenge:"Obter um desafio visual",audio_challenge:"Obter um desafio sonoro",refresh_btn:"Obter um novo desafio",instructions_visual:"Escreva as 2 palavras:",instructions_context:"",instructions_audio:"Escreva os 8 numeros:",help_btn:"Ajuda",incorrect_try_again:"Incorrecto. Tenta outra vez."},RecaptchaStr_ru={visual_challenge:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0432\u0438\u0437\u0443\u0430\u043b\u044c\u043d\u0443\u044e \u0437\u0430\u0434\u0430\u0447\u0443",audio_challenge:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0437\u0432\u0443\u043a\u043e\u0432\u0443\u044e \u0437\u0430\u0434\u0430\u0447\u0443",refresh_btn:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u043d\u043e\u0432\u0443\u044e \u0437\u0430\u0434\u0430\u0447\u0443",instructions_visual:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0434\u0432\u0430 \u0441\u043b\u043e\u0432\u0430:",instructions_context:"",instructions_audio:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0432\u043e\u0441\u0435\u043c\u044c \u0447\u0438\u0441\u0435\u043b:",help_btn:"\u041f\u043e\u043c\u043e\u0449\u044c",incorrect_try_again:"\u041d\u0435\u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u043e."},RecaptchaStr_tr={visual_challenge:"G\u00f6rsel deneme",audio_challenge:"\u0130\u015fitsel deneme",refresh_btn:"Yeni deneme",instructions_visual:"\u0130ki kelimeyi yaz\u0131n:",instructions_context:"",instructions_audio:"Sekiz numaray\u0131 yaz\u0131n:",help_btn:"Yard\u0131m (\u0130ngilizce)",incorrect_try_again:"Yanl\u0131\u015f. Bir daha deneyin."},RecaptchaStr_it={visual_challenge:"Modalit\u00e0 visiva",audio_challenge:"Modalit\u00e0 auditiva",refresh_btn:"Chiedi due nuove parole",instructions_visual:"Scrivi le due parole:",instructions_context:"",instructions_audio:"Trascrivi ci\u00f2 che senti:",help_btn:"Aiuto",incorrect_try_again:"Scorretto. Riprova."},RecaptchaLangMap={en:RecaptchaStr_en,de:RecaptchaStr_de,es:RecaptchaStr_es,fr:RecaptchaStr_fr,nl:RecaptchaStr_nl,pt:RecaptchaStr_pt,ru:RecaptchaStr_ru,tr:RecaptchaStr_tr,it:RecaptchaStr_it};var RecaptchaStr=RecaptchaStr_en,RecaptchaOptions,RecaptchaDefaultOptions={tabindex:0,theme:"red",callback:null,lang:"en",custom_theme_widget:null,custom_translations:null,includeContext:false},Recaptcha={widget:null,timer_id:-1,style_set:false,theme:null,type:"image",ajax_verify_cb:null,$:function(a){return typeof a=="string"?document.getElementById(a):a},create:function(a,b,c){Recaptcha.destroy();if(b)Recaptcha.widget=Recaptcha.$(b);Recaptcha._init_options(c);Recaptcha._call_challenge(a)},destroy:function(){var a=Recaptcha.$("recaptcha_challenge_field");a&&a.parentNode.removeChild(a);Recaptcha.timer_id!=-1&&clearInterval(Recaptcha.timer_id);Recaptcha.timer_id=-1;if(a=Recaptcha.$("recaptcha_image"))a.innerHTML="";if(Recaptcha.widget){if(Recaptcha.theme!="custom")Recaptcha.widget.innerHTML="";else Recaptcha.widget.style.display="none";Recaptcha.widget=null}},focus_response_field:function(){var a=Recaptcha.$;a=a("recaptcha_response_field");a.focus()},get_challenge:function(){if(typeof RecaptchaState=="undefined")return null;return RecaptchaState.challenge},get_response:function(){var a=Recaptcha.$;a=a("recaptcha_response_field");if(!a)return null;return a.value},ajax_verify:function(a){Recaptcha.ajax_verify_cb=a;a=Recaptcha._get_api_server()+"/ajaxverify?c="+encodeURIComponent(Recaptcha.get_challenge())+"&response="+encodeURIComponent(Recaptcha.get_response());Recaptcha._add_script(a)},_ajax_verify_callback:function(a){Recaptcha.ajax_verify_cb(a)},_get_api_server:function(){var a=window.location.protocol,b;b=typeof _RecaptchaOverrideApiServer!="undefined"?_RecaptchaOverrideApiServer:"www.google.com/recaptcha/api";return a+"//"+b},_call_challenge:function(a){a=Recaptcha._get_api_server()+"/challenge?k="+a+"&ajax=1&cachestop="+Math.random();if(typeof RecaptchaOptions.extra_challenge_params!="undefined")a+="&"+RecaptchaOptions.extra_challenge_params;if(RecaptchaOptions.includeContext)a+="&includeContext=1";Recaptcha._add_script(a)},_add_script:function(a){var b=document.createElement("script");b.type="text/javascript";b.src=a;Recaptcha._get_script_area().appendChild(b)},_get_script_area:function(){var a=document.getElementsByTagName("head");return a=!a||a.length<1?document.body:a[0]},_hash_merge:function(a){var b={};for(var c in a)for(var d in a[c])b[d]=a[c][d];if(b.theme=="context")b.includeContext=true;return b},_init_options:function(a){RecaptchaOptions=Recaptcha._hash_merge([RecaptchaDefaultOptions,a||{}])},challenge_callback:function(){Recaptcha._reset_timer();RecaptchaStr=Recaptcha._hash_merge([RecaptchaStr_en,RecaptchaLangMap[RecaptchaOptions.lang]||{},RecaptchaOptions.custom_translations||{}]);window.addEventListener&&window.addEventListener("unload",function(){Recaptcha.destroy()},false);Recaptcha._is_ie()&&window.attachEvent&&window.attachEvent("onbeforeunload",function(){});if(navigator.userAgent.indexOf("KHTML")>0){var a=document.createElement("iframe");a.src="about:blank";a.style.height="0px";a.style.width="0px";a.style.visibility="hidden";a.style.border="none";var b=document.createTextNode("This frame prevents back/forward cache problems in Safari.");a.appendChild(b);document.body.appendChild(a)}Recaptcha._finish_widget()},_add_css:function(a){var b=document.createElement("style");b.type="text/css";if(b.styleSheet)if(navigator.appVersion.indexOf("MSIE 5")!=-1)document.write("<style type='text/css'>"+a+"</style>");else b.styleSheet.cssText=a;else if(navigator.appVersion.indexOf("MSIE 5")!=-1)document.write("<style type='text/css'>"+a+"</style>");else{a=document.createTextNode(a);b.appendChild(a)}Recaptcha._get_script_area().appendChild(b)},_set_style:function(a){if(!Recaptcha.style_set){Recaptcha.style_set=true;Recaptcha._add_css(a+"\n\n.recaptcha_is_showing_audio .recaptcha_only_if_image,.recaptcha_isnot_showing_audio .recaptcha_only_if_audio,.recaptcha_had_incorrect_sol .recaptcha_only_if_no_incorrect_sol,.recaptcha_nothad_incorrect_sol .recaptcha_only_if_incorrect_sol{display:none !important}")}},_init_builtin_theme:function(){var a=Recaptcha.$,b=RecaptchaStr,c=RecaptchaState,d,e;c=c.server;if(c[c.length-1]=="/")c=c.substring(0,c.length-1);var f=c+"/img/"+Recaptcha.theme;if(Recaptcha.theme=="clean"){c=RecaptchaTemplates.CleanCss;d=RecaptchaTemplates.CleanHtml;e="png"}else{if(Recaptcha.theme=="context"){c=RecaptchaTemplates.VertCss;d=RecaptchaTemplates.ContextHtml}else{c=RecaptchaTemplates.VertCss;d=RecaptchaTemplates.VertHtml}e="gif"}c=c.replace(/IMGROOT/g,f);Recaptcha._set_style(c);Recaptcha.widget.innerHTML="<div id='recaptcha_area'>"+d+"</div>";a("recaptcha_reload").src=f+"/refresh."+e;a("recaptcha_switch_audio").src=f+"/audio."+e;a("recaptcha_switch_img").src=f+"/text."+e;a("recaptcha_whatsthis").src=f+"/help."+e;if(Recaptcha.theme=="clean"){a("recaptcha_logo").src=f+"/logo."+e;a("recaptcha_tagline").src=f+"/tagline."+e}a("recaptcha_reload").alt=b.refresh_btn;a("recaptcha_switch_audio").alt=b.audio_challenge;a("recaptcha_switch_img").alt=b.visual_challenge;a("recaptcha_whatsthis").alt=b.help_btn;a("recaptcha_reload_btn").href="javascript:Recaptcha.reload ();";a("recaptcha_reload_btn").title=b.refresh_btn;a("recaptcha_switch_audio_btn").href="javascript:Recaptcha.switch_type('audio');";a("recaptcha_switch_audio_btn").title=b.audio_challenge;a("recaptcha_switch_img_btn").href="javascript:Recaptcha.switch_type('image');";a("recaptcha_switch_img_btn").title=b.visual_challenge;a("recaptcha_whatsthis_btn").href=Recaptcha._get_help_link();a("recaptcha_whatsthis_btn").target="_blank";a("recaptcha_whatsthis_btn").title=b.help_btn;a("recaptcha_whatsthis_btn").onclick=function(){Recaptcha.showhelp();return false};a("recaptcha_table").className="recaptchatable recaptcha_theme_"+Recaptcha.theme;a("recaptcha_instructions_image")&&a("recaptcha_instructions_image").appendChild(document.createTextNode(b.instructions_visual));a("recaptcha_instructions_context")&&a("recaptcha_instructions_context").appendChild(document.createTextNode(b.instructions_context));a("recaptcha_instructions_audio")&&a("recaptcha_instructions_audio").appendChild(document.createTextNode(b.instructions_audio));a("recaptcha_instructions_error")&&a("recaptcha_instructions_error").appendChild(document.createTextNode(b.incorrect_try_again))},_finish_widget:function(){var a=Recaptcha.$,b=RecaptchaState,c=RecaptchaOptions,d=c.theme;switch(d){case"red":case"white":case"blackglass":case"clean":case"custom":case"context":break;default:d="red";break}if(!Recaptcha.theme)Recaptcha.theme=d;Recaptcha.theme!="custom"?Recaptcha._init_builtin_theme():Recaptcha._set_style("");d=document.createElement("span");d.id="recaptcha_challenge_field_holder";d.style.display="none";a("recaptcha_response_field").parentNode.insertBefore(d,a("recaptcha_response_field"));a("recaptcha_response_field").setAttribute("autocomplete","off");a("recaptcha_image").style.width="300px";a("recaptcha_image").style.height="57px";Recaptcha.should_focus=false;Recaptcha._set_challenge(b.challenge,"image");if(c.tabindex){a("recaptcha_response_field").tabIndex=c.tabindex;if(Recaptcha.theme!="custom"){a("recaptcha_whatsthis_btn").tabIndex=c.tabindex;a("recaptcha_switch_img_btn").tabIndex=c.tabindex;a("recaptcha_switch_audio_btn").tabIndex=c.tabindex;a("recaptcha_reload_btn").tabIndex=c.tabindex}}if(Recaptcha.widget)Recaptcha.widget.style.display="";c.callback&&c.callback()},switch_type:function(a){var b=Recaptcha;b.type=a;b.reload(b.type=="audio"?"a":"v")},reload:function(a){var b=Recaptcha,c=RecaptchaState;if(typeof a=="undefined")a="r";c=c.server+"reload?c="+c.challenge+"&k="+c.site+"&reason="+a+"&type="+b.type+"&lang="+RecaptchaOptions.lang;if(RecaptchaOptions.includeContext)c+="&includeContext=1";if(typeof RecaptchaOptions.extra_challenge_params!="undefined")c+="&"+RecaptchaOptions.extra_challenge_params;if(b.type=="audio")c+=RecaptchaOptions.audio_beta_12_08?"&audio_beta_12_08=1":"&new_audio_default=1";b.should_focus=a!="t";b._add_script(c)},finish_reload:function(a,b){RecaptchaState.is_incorrect=false;Recaptcha._set_challenge(a,b)},_set_challenge:function(a,b){var c=Recaptcha,d=RecaptchaState,e=c.$;d.challenge=a;c.type=b;e("recaptcha_challenge_field_holder").innerHTML="<input type='hidden' name='recaptcha_challenge_field' id='recaptcha_challenge_field' value='"+d.challenge+"'/>";if(b=="audio")e("recaptcha_image").innerHTML=Recaptcha.getAudioCaptchaHtml();else if(b=="image"){var f=d.server+"image?c="+d.challenge;e("recaptcha_image").innerHTML="<img style='display:block;' height='57' width='300' src='"+
f+"'/>"}Recaptcha._css_toggle("recaptcha_had_incorrect_sol","recaptcha_nothad_incorrect_sol",d.is_incorrect);Recaptcha._css_toggle("recaptcha_is_showing_audio","recaptcha_isnot_showing_audio",b=="audio");c._clear_input();c.should_focus&&c.focus_response_field();c._reset_timer()},_reset_timer:function(){var a=RecaptchaState;clearInterval(Recaptcha.timer_id);Recaptcha.timer_id=setInterval("Recaptcha.reload('t');",(a.timeout-300)*1E3)},showhelp:function(){window.open(Recaptcha._get_help_link(),"recaptcha_popup","width=460,height=570,location=no,menubar=no,status=no,toolbar=no,scrollbars=yes,resizable=yes")},_clear_input:function(){var a=Recaptcha.$("recaptcha_response_field");a.value=""},_displayerror:function(a){var b=Recaptcha.$;b("recaptcha_image").innerHTML="";b("recaptcha_image").appendChild(document.createTextNode(a))},reloaderror:function(a){Recaptcha._displayerror(a)},_is_ie:function(){return navigator.userAgent.indexOf("MSIE")>0&&!window.opera},_css_toggle:function(a,b,c){var d=Recaptcha.widget;if(!d)d=document.body;var e=d.className;e=e.replace(RegExp("(^|\\s+)"+a+"(\\s+|$)")," ");e=e.replace(RegExp("(^|\\s+)"+b+"(\\s+|$)")," ");e+=" "+(c?a:b);d.className=e},_get_help_link:function(){var a=RecaptchaOptions.lang;return"http://recaptcha.net/popuphelp/"+(a=="en"?"":a+".html")},playAgain:function(){var a=Recaptcha.$;a("recaptcha_image").innerHTML=Recaptcha.getAudioCaptchaHtml()},getAudioCaptchaHtml:function(){var a=Recaptcha,b=RecaptchaState,c=b.server+"image?c="+b.challenge;if(c.indexOf("https://")==0)c="http://"+c.substring(8);b=b.server+"/img/audiocaptcha.swf?v2";a=a._is_ie()?'<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" id="audiocaptcha" width="0" height="0" codebase="https://fpdownload.macromedia.com/get/flashplayer/current/swflash.cab"><param name="movie" value="'+b+'" /><param name="quality" value="high" /><param name="bgcolor" value="#869ca7" /><param name="allowScriptAccess" value="always" /></object><br/>':'<embed src="'+b+'" quality="high" bgcolor="#869ca7" width="0" height="0" name="audiocaptcha" align="middle" play="true" loop="false" quality="high" allowScriptAccess="always" type="application/x-shockwave-flash" pluginspage="http://www.adobe.com/go/getflashplayer"></embed> ';c=(Recaptcha.checkFlashVer()?'<br/><a class="recaptcha_audio_cant_hear_link" href="#" onclick="Recaptcha.playAgain(); return false;">'+RecaptchaStr.play_again+"</a>":"")+'<br/><a class="recaptcha_audio_cant_hear_link" target="_blank" href="'+c+'">'+RecaptchaStr.cant_hear_this+"</a>";return a+c},gethttpwavurl:function(){var a=RecaptchaState;if(Recaptcha.type=="audio"){a=a.server+"image?c="+a.challenge;if(a.indexOf("https://")==0)a="http://"+a.substring(8);return a}return""},checkFlashVer:function(){var a=navigator.appVersion.indexOf("MSIE")!=-1?true:false,b=navigator.appVersion.toLowerCase().indexOf("win")!=-1?true:false,c=navigator.userAgent.indexOf("Opera")!=-1?true:false,d=-1;if(navigator.plugins!=null&&navigator.plugins.length>0){if(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]){a=navigator.plugins["Shockwave Flash 2.0"]?" 2.0":"";a=navigator.plugins["Shockwave Flash"+a].description;a=a.split(" ");a=a[2].split(".");d=a[0]}}else if(a&&b&&!c)try{var e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7"),f=e.GetVariable("$version");d=f.split(" ")[1].split(",")[0]}catch(g){}return d>=9},getlang:function(){return RecaptchaOptions.lang}};

} /* end modules/sharedaddy/sharing.js */

if ( jpconcat.files['modules/shortcodes/js/audio-shortcode.js'] ) {

(function($){window.audioshortcode={prep:function(player_id,files,titles,volume,loop){var container=$('#wp-as-'+player_id+'-container');if(container.hasClass('wp-as-prepped')){return;}
container.addClass('wp-as-prepped');if(!document.createElement('audio').canPlayType){return;}
var player=$('#wp-as-'+player_id).get(0);if(typeof player==='undefined'){return;}
this[player_id]=[];this[player_id].i=0;this[player_id].files=files;this[player_id].titles=titles;player.volume=volume;var type_map={'mp3':'mpeg','wav':'wav','ogg':'ogg','oga':'ogg','m4a':'mp4','aac':'mp4','webm':'webm'};for(var i=this[player_id].files.length-1;i>=0;i--){var extension=this[player_id].files[i].split('.').pop();var type='audio/'+type_map[extension];if(!player.canPlayType(type)){this.remove_track(player_id,i);}}
if(0===this[player_id].files.length){return;}
player.src=this[player_id].files[0];if(1<this[player_id].files.length){$('#wp-as-'+player_id+'-controls').show();}
player.addEventListener('error',function(){audioshortcode.remove_track(player_id,audioshortcode[player_id].i);if(0<audioshortcode[player_id].files.length){audioshortcode[player_id].i--;audioshortcode.next_track(player_id,false,loop);}},false);player.addEventListener('ended',function(){audioshortcode.next_track(player_id,false,loop);},false);player.addEventListener('play',function(){var i=audioshortcode[player_id].i;var titles=audioshortcode[player_id].titles;$('#wp-as-'+player_id+'-playing').text(' '+titles[i]);},false);player.addEventListener('pause',function(){$('#wp-as-'+player_id+'-playing').text('');},false);},remove_track:function(player_id,index){this[player_id].files.splice(index,1);this[player_id].titles.splice(index,1);if(0===this[player_id].files.length){$('#wp-as-'+player_id+'-container').html($('#wp-as-'+player_id+'-nope').html());$('#wp-as-'+player_id+'-controls').html('');}else if(1===this[player_id].files.length){$('#wp-as-'+player_id+'-controls').html('');}},start_track:function(player_id,file){var player=$('#wp-as-'+player_id).get(0);player.src=file;player.load();player.play();},prev_track:function(player_id){var player=$('#wp-as-'+player_id).get(0);var files=this[player_id].files;if(player.paused||0===this[player_id].i){return;}
player.pause();if(0<this[player_id].i){this[player_id].i--;this.start_track(player_id,files[this[player_id].i]);}},next_track:function(player_id,fromClick,loop){var player=$('#wp-as-'+player_id).get(0);var files=this[player_id].files;if(fromClick&&(player.paused||files.length-1===this[player_id].i)){return;}
player.pause();if(files.length-1>this[player_id].i){this[player_id].i++;this.start_track(player_id,files[this[player_id].i]);}else if(loop){this[player_id].i=0;this.start_track(player_id,0);}else{this[player_id].i=0;player.src=files[0];$('#wp-as-'+player_id+'-playing').text('');}}};})(jQuery);

} /* end modules/shortcodes/js/audio-shortcode.js */

if ( jpconcat.files['modules/shortcodes/js/jmpress.js'] ) {

/*!
 * jmpress.js v0.4.5
 * http://jmpressjs.github.com/jmpress.js
 *
 * A jQuery plugin to build a website on the infinite canvas.
 *
 * Copyright 2013 Kyle Robinson Young @shama & Tobias Koppers @sokra
 * Licensed MIT
 * http://www.opensource.org/licenses/mit-license.php
 *
 * Based on the foundation laid by Bartek Szopka @bartaz
 */
/*!*jmpress.js v0.4.5*http:**A jQuery plugin to build a website on the infinite canvas.**Copyright 2013 Kyle Robinson Young@shama&Tobias Koppers@sokra*Licensed MIT*http:**Based on the foundation laid by Bartek Szopka@bartaz**core.js*The core of jmpress.js*/
(function($,document,window,undefined){'use strict';var pfx=(function(){var style=document.createElement('dummy').style,prefixes='Webkit Moz O ms Khtml'.split(' '),memory={};return function(prop){if(typeof memory[prop]==="undefined"){var ucProp=prop.charAt(0).toUpperCase()+prop.substr(1),props=(prop+' '+prefixes.join(ucProp+' ')+ucProp).split(' ');memory[prop]=null;for(var i in props){if(style[props[i]]!==undefined){memory[prop]=props[i];break;}}}
return memory[prop];};}());function mapProperty(name){if(!name){return;}
var index=1+name.substr(1).search(/[A-Z]/);var prefix=name.substr(0,index).toLowerCase();var postfix=name.substr(index).toLowerCase();return"-"+prefix+"-"+postfix;}
function addComma(attribute){if(!attribute){return"";}
return attribute+",";}
function ifNotEmpty(el){if(el.length>0){return el;}
return null;}
var defaults={stepSelector:'.step',containerClass:'',canvasClass:'',areaClass:'',notSupportedClass:'not-supported',fullscreen:true,animation:{transformOrigin:'top left',transitionProperty:addComma(mapProperty(pfx('transform')))+addComma(mapProperty(pfx('perspective')))+'opacity',transitionDuration:'1s',transitionDelay:'500ms',transitionTimingFunction:'ease-in-out',transformStyle:"preserve-3d"},transitionDuration:1500};var callbacks={'beforeChange':1,'beforeInitStep':1,'initStep':1,'beforeInit':1,'afterInit':1,'beforeDeinit':1,'afterDeinit':1,'applyStep':1,'unapplyStep':1,'setInactive':1,'beforeActive':1,'setActive':1,'selectInitialStep':1,'selectPrev':1,'selectNext':1,'selectHome':1,'selectEnd':1,'idle':1,'applyTarget':1};for(var callbackName in callbacks){defaults[callbackName]=[];}
function init(args){args=$.extend(true,{},args||{});var callbackArgs={};var callbackName=null;for(callbackName in callbacks){callbackArgs[callbackName]=$.isFunction(args[callbackName])?[args[callbackName]]:args[callbackName];args[callbackName]=[];}
var settings=$.extend(true,{},defaults,args);for(callbackName in callbacks){if(callbackArgs[callbackName]){Array.prototype.push.apply(settings[callbackName],callbackArgs[callbackName]);}}
var jmpress=$(this),container=null,area=null,oldStyle={container:"",area:""},canvas=null,current=null,active=false,activeSubstep=null,activeDelegated=false;function doStepInit(element,idx){var data=dataset(element);var step={oldStyle:$(element).attr("style")||""};var callbackData={data:data,stepData:step};callCallback.call(this,'beforeInitStep',$(element),callbackData);step.delegate=data.delegate;callCallback.call(this,'initStep',$(element),callbackData);$(element).data('stepData',step);if(!$(element).attr('id')){$(element).attr('id','step-'+(idx+1));}
callCallback.call(this,'applyStep',$(element),callbackData);}
function doStepDeinit(element){var stepData=$(element).data('stepData');$(element).attr("style",stepData.oldStyle);callCallback.call(this,'unapplyStep',$(element),{stepData:stepData});}
function doStepReapply(element){callCallback.call(this,'unapplyStep',$(element),{stepData:element.data("stepData")});callCallback.call(this,'applyStep',$(element),{stepData:element.data("stepData")});}
function deinit(){if(active){callCallback.call(this,'setInactive',active,{stepData:$(active).data('stepData'),reason:"deinit"});}
if(current.jmpressClass){$(jmpress).removeClass(current.jmpressClass);}
callCallback.call(this,'beforeDeinit',$(this),{});$(settings.stepSelector,jmpress).each(function(idx){doStepDeinit.call(jmpress,this);});container.attr("style",oldStyle.container);if(settings.fullscreen){$("html").attr("style","");}
area.attr("style",oldStyle.area);$(canvas).children().each(function(){jmpress.append($(this));});if(settings.fullscreen){canvas.remove();}else{canvas.remove();area.remove();}
callCallback.call(this,'afterDeinit',$(this),{});$(jmpress).data("jmpressmethods",false);}
function callCallback(callbackName,element,eventData){eventData.settings=settings;eventData.current=current;eventData.container=container;eventData.parents=element?getStepParents(element):null;eventData.current=current;eventData.jmpress=this;var result={};$.each(settings[callbackName],function(idx,callback){result.value=callback.call(jmpress,element,eventData)||result.value;});return result.value;}
function getStepParents(el){return $(el).parentsUntil(jmpress).not(jmpress).filter(settings.stepSelector);}
function reselect(type){return select({step:active,substep:activeSubstep},type);}
function select(el,type){var substep;if($.isPlainObject(el)){substep=el.substep;el=el.step;}
if(typeof el==='string'){el=jmpress.find(el).first();}
if(!el||!$(el).data('stepData')){return false;}
scrollFix.call(this);var step=$(el).data('stepData');var cancelSelect=false;callCallback.call(this,"beforeChange",el,{stepData:step,reason:type,cancel:function(){cancelSelect=true;}});if(cancelSelect){return undefined;}
var target={};var delegated=el;if($(el).data("stepData").delegate){delegated=ifNotEmpty($(el).parentsUntil(jmpress).filter(settings.stepSelector).filter(step.delegate))||ifNotEmpty($(el).near(step.delegate))||ifNotEmpty($(el).near(step.delegate,true))||ifNotEmpty($(step.delegate,jmpress));if(delegated){step=delegated.data("stepData");}else{delegated=el;}}
if(activeDelegated){callCallback.call(this,'setInactive',activeDelegated,{stepData:$(activeDelegated).data('stepData'),delegatedFrom:active,reason:type,target:target,nextStep:delegated,nextSubstep:substep,nextStepData:step});}
var callbackData={stepData:step,delegatedFrom:el,reason:type,target:target,substep:substep,prevStep:activeDelegated,prevSubstep:activeSubstep,prevStepData:activeDelegated&&$(activeDelegated).data('stepData')};callCallback.call(this,'beforeActive',delegated,callbackData);callCallback.call(this,'setActive',delegated,callbackData);if(current.jmpressClass){$(jmpress).removeClass(current.jmpressClass);}
$(jmpress).addClass(current.jmpressClass='step-'+$(delegated).attr('id'));if(current.jmpressDelegatedClass){$(jmpress).removeClass(current.jmpressDelegatedClass);}
$(jmpress).addClass(current.jmpressDelegatedClass='delegating-step-'+$(el).attr('id'));callCallback.call(this,"applyTarget",delegated,$.extend({canvas:canvas,area:area,beforeActive:activeDelegated},callbackData));active=el;activeSubstep=callbackData.substep;activeDelegated=delegated;if(current.idleTimeout){clearTimeout(current.idleTimeout);}
current.idleTimeout=setTimeout(function(){callCallback.call(this,'idle',delegated,callbackData);},Math.max(1,settings.transitionDuration-100));return delegated;}
function scrollFix(){(function fix(){if($(container)[0].tagName==="BODY"){try{window.scrollTo(0,0);}catch(e){}}
$(container).scrollTop(0);$(container).scrollLeft(0);function check(){if($(container).scrollTop()!==0||$(container).scrollLeft()!==0){fix();}}
setTimeout(check,1);setTimeout(check,10);setTimeout(check,100);setTimeout(check,200);setTimeout(check,400);}());}
function goTo(el){return select.call(this,el,"jump");}
function next(){return select.call(this,callCallback.call(this,'selectNext',active,{stepData:$(active).data('stepData'),substep:activeSubstep}),"next");}
function prev(){return select.call(this,callCallback.call(this,'selectPrev',active,{stepData:$(active).data('stepData'),substep:activeSubstep}),"prev");}
function home(){return select.call(this,callCallback.call(this,'selectHome',active,{stepData:$(active).data('stepData')}),"home");}
function end(){return select.call(this,callCallback.call(this,'selectEnd',active,{stepData:$(active).data('stepData')}),"end");}
function canvasMod(props){css(canvas,props||{});return $(canvas);}
function getActive(){return activeDelegated&&$(activeDelegated);}
function fire(callbackName,element,eventData){if(!callbacks[callbackName]){$.error("callback "+callbackName+" is not registered.");}else{return callCallback.call(this,callbackName,element,eventData);}}
jmpress.data("jmpressmethods",{select:select,reselect:reselect,scrollFix:scrollFix,goTo:goTo,next:next,prev:prev,home:home,end:end,canvas:canvasMod,container:function(){return container;},settings:function(){return settings;},active:getActive,current:function(){return current;},fire:fire,init:function(step){doStepInit.call(this,$(step),current.nextIdNumber++);},deinit:function(step){if(step){doStepDeinit.call(this,$(step));}else{deinit.call(this);}},reapply:doStepReapply});function checkSupport(){var ua=navigator.userAgent.toLowerCase();return(ua.search(/(iphone)|(ipod)|(android)/)===-1)||(ua.search(/(chrome)/)!==-1);}
if(checkSupport()===false){if(settings.notSupportedClass){jmpress.addClass(settings.notSupportedClass);}
return;}else{if(settings.notSupportedClass){jmpress.removeClass(settings.notSupportedClass);}}
var steps=$(settings.stepSelector,jmpress);container=jmpress;area=$('<div />');canvas=$('<div />');$(jmpress).children().filter(steps).each(function(){canvas.append($(this));});if(settings.fullscreen){container=$('body');$("html").css({overflow:'hidden'});area=jmpress;}
oldStyle.area=area.attr("style")||"";oldStyle.container=container.attr("style")||"";if(settings.fullscreen){container.css({height:'100%'});jmpress.append(canvas);}else{container.css({position:"relative"});area.append(canvas);jmpress.append(area);}
$(container).addClass(settings.containerClass);$(area).addClass(settings.areaClass);$(canvas).addClass(settings.canvasClass);document.documentElement.style.height="100%";container.css({overflow:'hidden'});var props={position:"absolute",transitionDuration:'0s'};props=$.extend({},settings.animation,props);css(area,props);css(area,{top:'50%',left:'50%',perspective:'1000px'});css(canvas,props);current={};callCallback.call(this,'beforeInit',null,{});steps.each(function(idx){doStepInit.call(jmpress,this,idx);});current.nextIdNumber=steps.length;callCallback.call(this,'afterInit',null,{});select.call(this,callCallback.call(this,'selectInitialStep',"init",{}));if(settings.initClass){$(steps).removeClass(settings.initClass);}}
function getDefaults(){return defaults;}
function register(name,func){if($.isFunction(func)){if(methods[name]){$.error("function "+name+" is already registered.");}else{methods[name]=func;}}else{if(callbacks[name]){$.error("callback "+name+" is already registered.");}else{callbacks[name]=1;defaults[name]=[];}}}
function css(el,props){var key,pkey,cssObj={};for(key in props){if(props.hasOwnProperty(key)){pkey=pfx(key);if(pkey!==null){cssObj[pkey]=props[key];}}}
$(el).css(cssObj);return el;}
function dataset(el){if($(el)[0].dataset){return $.extend({},$(el)[0].dataset);}
function toCamelcase(str){str=str.split('-');for(var i=1;i<str.length;i++){str[i]=str[i].substr(0,1).toUpperCase()+str[i].substr(1);}
return str.join('');}
var returnDataset={};var attrs=$(el)[0].attributes;$.each(attrs,function(idx,attr){if(attr.nodeName.substr(0,5)==="data-"){returnDataset[toCamelcase(attr.nodeName.substr(5))]=attr.nodeValue;}});return returnDataset;}
function initialized(){return!!$(this).data("jmpressmethods");}
var methods={init:init,initialized:initialized,deinit:function(){},css:css,pfx:pfx,defaults:getDefaults,register:register,dataset:dataset};$.fn.jmpress=function(method){function f(){var jmpressmethods=$(this).data("jmpressmethods");if(jmpressmethods&&jmpressmethods[method]){return jmpressmethods[method].apply(this,Array.prototype.slice.call(arguments,1));}else if(methods[method]){return methods[method].apply(this,Array.prototype.slice.call(arguments,1));}else if(callbacks[method]&&jmpressmethods){var settings=jmpressmethods.settings();var func=Array.prototype.slice.call(arguments,1)[0];if($.isFunction(func)){settings[method]=settings[method]||[];settings[method].push(func);}}else if(typeof method==='object'||!method){return init.apply(this,arguments);}else{$.error('Method '+method+' does not exist on jQuery.jmpress');}
return this;}
var args=arguments;var result;$(this).each(function(idx,element){result=f.apply(element,args);});return result;};$.extend({jmpress:function(method){if(methods[method]){return methods[method].apply(this,Array.prototype.slice.call(arguments,1));}else if(callbacks[method]){var func=Array.prototype.slice.call(arguments,1)[0];if($.isFunction(func)){defaults[method].push(func);}else{$.error('Second parameter should be a function: $.jmpress( callbackName, callbackFunction )');}}else{$.error('Method '+method+' does not exist on jQuery.jmpress');}}});}(jQuery,document,window));(function($,document,window,undefined){'use strict';function checkAndGo(elements,func,selector,backwards){var next;elements.each(function(idx,element){if(backwards){next=func(element,selector,backwards);if(next){return false;}}
if($(element).is(selector)){next=element;return false;}
if(!backwards){next=func(element,selector,backwards);if(next){return false;}}});return next;}
function findNextInChildren(item,selector,backwards){var children=$(item).children();if(backwards){children=$(children.get().reverse());}
return checkAndGo(children,findNextInChildren,selector,backwards);}
function findNextInSiblings(item,selector,backwards){return checkAndGo($(item)[backwards?"prevAll":"nextAll"](),findNextInChildren,selector,backwards);}
function findNextInParents(item,selector,backwards){var next;var parents=$(item).parents();parents=$(parents.get());$.each(parents.get(),function(idx,element){if(backwards&&$(element).is(selector)){next=element;return false;}
next=findNextInSiblings(element,selector,backwards);if(next){return false;}});return next;}
$.fn.near=function(selector,backwards){var array=[];$(this).each(function(idx,element){var near=(backwards?false:findNextInChildren(element,selector,backwards))||findNextInSiblings(element,selector,backwards)||findNextInParents(element,selector,backwards);if(near){array.push(near);}});return $(array);};}(jQuery,document,window));(function($,document,window,undefined){'use strict';function toCssNumber(number){return(Math.round(10000*number)/10000)+"";}
var engines={3:{transform:function(el,data){var transform='translate(-50%,-50%)';$.each(data,function(idx,item){var coord=["X","Y","Z"];var i;if(item[0]==="translate"){transform+=" translate3d("+toCssNumber(item[1]||0)+"px,"+toCssNumber(item[2]||0)+"px,"+toCssNumber(item[3]||0)+"px)";}else if(item[0]==="rotate"){var order=item[4]?[1,2,3]:[3,2,1];for(i=0;i<3;i++){transform+=" rotate"+coord[order[i]-1]+"("+toCssNumber(item[order[i]]||0)+"deg)";}}else if(item[0]==="scale"){for(i=0;i<3;i++){transform+=" scale"+coord[i]+"("+toCssNumber(item[i+1]||1)+")";}}});$.jmpress("css",el,$.extend({},{transform:transform}));}},2:{transform:function(el,data){var transform='translate(-50%,-50%)';$.each(data,function(idx,item){var coord=["X","Y"];if(item[0]==="translate"){transform+=" translate("+toCssNumber(item[1]||0)+"px,"+toCssNumber(item[2]||0)+"px)";}else if(item[0]==="rotate"){transform+=" rotate("+toCssNumber(item[3]||0)+"deg)";}else if(item[0]==="scale"){for(var i=0;i<2;i++){transform+=" scale"+coord[i]+"("+toCssNumber(item[i+1]||1)+")";}}});$.jmpress("css",el,$.extend({},{transform:transform}));}},1:{transform:function(el,data){var anitarget={top:0,left:0};$.each(data,function(idx,item){var coord=["X","Y"];if(item[0]==="translate"){anitarget.left=Math.round(item[1]||0)+"px";anitarget.top=Math.round(item[2]||0)+"px";}});el.animate(anitarget,1000);}}};var engine=(function(){if($.jmpress("pfx","perspective")){return engines[3];}else if($.jmpress("pfx","transform")){return engines[2];}else{return engines[1];}}());$.jmpress("defaults").reasonableAnimation={};$.jmpress("initStep",function(step,eventData){var data=eventData.data;var stepData=eventData.stepData;var pf=parseFloat;$.extend(stepData,{x:pf(data.x)||0,y:pf(data.y)||0,z:pf(data.z)||0,r:pf(data.r)||0,phi:pf(data.phi)||0,rotate:pf(data.rotate)||0,rotateX:pf(data.rotateX)||0,rotateY:pf(data.rotateY)||0,rotateZ:pf(data.rotateZ)||0,revertRotate:false,scale:pf(data.scale)||1,scaleX:pf(data.scaleX)||false,scaleY:pf(data.scaleY)||false,scaleZ:pf(data.scaleZ)||1});});$.jmpress("afterInit",function(nil,eventData){var stepSelector=eventData.settings.stepSelector,current=eventData.current;current.perspectiveScale=1;current.maxNestedDepth=0;var nestedSteps=$(eventData.jmpress).find(stepSelector).children(stepSelector);while(nestedSteps.length){current.maxNestedDepth++;nestedSteps=nestedSteps.children(stepSelector);}});$.jmpress("applyStep",function(step,eventData){$.jmpress("css",$(step),{position:"absolute",transformStyle:"preserve-3d"});if(eventData.parents.length>0){$.jmpress("css",$(step),{top:"50%",left:"50%"});}
var sd=eventData.stepData;var transform=[["translate",sd.x||(sd.r*Math.sin(sd.phi*Math.PI/180)),sd.y||(-sd.r*Math.cos(sd.phi*Math.PI/180)),sd.z],["rotate",sd.rotateX,sd.rotateY,sd.rotateZ||sd.rotate,true],["scale",sd.scaleX||sd.scale,sd.scaleY||sd.scale,sd.scaleZ||sd.scale]];engine.transform(step,transform);});$.jmpress("setActive",function(element,eventData){var target=eventData.target;var step=eventData.stepData;var tf=target.transform=[];target.perspectiveScale=1;for(var i=eventData.current.maxNestedDepth;i>(eventData.parents.length||0);i--){tf.push(["scale"],["rotate"],["translate"]);}
tf.push(["scale",1 /(step.scaleX||step.scale),1 /(step.scaleY||step.scale),1 /(step.scaleZ)]);tf.push(["rotate",-step.rotateX,-step.rotateY,-(step.rotateZ||step.rotate)]);tf.push(["translate",-(step.x||(step.r*Math.sin(step.phi*Math.PI/180))),-(step.y||(-step.r*Math.cos(step.phi*Math.PI/180))),-step.z]);target.perspectiveScale*=(step.scaleX||step.scale);$.each(eventData.parents,function(idx,element){var step=$(element).data("stepData");tf.push(["scale",1 /(step.scaleX||step.scale),1 /(step.scaleY||step.scale),1 /(step.scaleZ)]);tf.push(["rotate",-step.rotateX,-step.rotateY,-(step.rotateZ||step.rotate)]);tf.push(["translate",-(step.x||(step.r*Math.sin(step.phi*Math.PI/180))),-(step.y||(-step.r*Math.cos(step.phi*Math.PI/180))),-step.z]);target.perspectiveScale*=(step.scaleX||step.scale);});$.each(tf,function(idx,item){if(item[0]!=="rotate"){return;}
function lowRotate(name){if(eventData.current["rotate"+name+"-"+idx]===undefined){eventData.current["rotate"+name+"-"+idx]=item[name]||0;}
var cur=eventData.current["rotate"+name+"-"+idx],tar=item[name]||0,curmod=cur%360,tarmod=tar%360;if(curmod<0){curmod+=360;}
if(tarmod<0){tarmod+=360;}
var diff=tarmod-curmod;if(diff<-180){diff+=360;}else if(diff>180){diff-=360;}
eventData.current["rotate"+name+"-"+idx]=item[name]=cur+diff;}
lowRotate(1);lowRotate(2);lowRotate(3);});});$.jmpress("applyTarget",function(active,eventData){var target=eventData.target,props,step=eventData.stepData,settings=eventData.settings,zoomin=target.perspectiveScale*1.3<eventData.current.perspectiveScale,zoomout=target.perspectiveScale>eventData.current.perspectiveScale*1.3;var lastScale=-1;$.each(target.transform,function(idx,item){if(item.length<=1){return;}
if(item[0]==="rotate"&&item[1]%360===0&&item[2]%360===0&&item[3]%360===0){return;}
if(item[0]==="scale"){lastScale=idx;}else{return false;}});if(lastScale!==eventData.current.oldLastScale){zoomin=zoomout=false;eventData.current.oldLastScale=lastScale;}
var extracted=[];if(lastScale!==-1){while(lastScale>=0){if(target.transform[lastScale][0]==="scale"){extracted.push(target.transform[lastScale]);target.transform[lastScale]=["scale"];}
lastScale--;}}
var animation=settings.animation;if(settings.reasonableAnimation[eventData.reason]){animation=$.extend({},animation,settings.reasonableAnimation[eventData.reason]);}
props={perspective:Math.round(target.perspectiveScale*1000)+"px"};props=$.extend({},animation,props);if(!zoomin){props.transitionDelay='0s';}
if(!eventData.beforeActive){props.transitionDuration='0s';props.transitionDelay='0s';}
$.jmpress("css",eventData.area,props);engine.transform(eventData.area,extracted);props=$.extend({},animation);if(!zoomout){props.transitionDelay='0s';}
if(!eventData.beforeActive){props.transitionDuration='0s';props.transitionDelay='0s';}
eventData.current.perspectiveScale=target.perspectiveScale;$.jmpress("css",eventData.canvas,props);engine.transform(eventData.canvas,target.transform);});}(jQuery,document,window));(function($,document,window,undefined){'use strict';var $jmpress=$.jmpress;var activeClass='activeClass',nestedActiveClass='nestedActiveClass';var defaults=$jmpress('defaults');defaults[nestedActiveClass]="nested-active";defaults[activeClass]="active";$jmpress('setInactive',function(step,eventData){var settings=eventData.settings,activeClassSetting=settings[activeClass],nestedActiveClassSettings=settings[nestedActiveClass];if(activeClassSetting){$(step).removeClass(activeClassSetting);}
if(nestedActiveClassSettings){$.each(eventData.parents,function(idx,element){$(element).removeClass(nestedActiveClassSettings);});}});$jmpress('setActive',function(step,eventData){var settings=eventData.settings,activeClassSetting=settings[activeClass],nestedActiveClassSettings=settings[nestedActiveClass];if(activeClassSetting){$(step).addClass(activeClassSetting);}
if(nestedActiveClassSettings){$.each(eventData.parents,function(idx,element){$(element).addClass(nestedActiveClassSettings);});}});}(jQuery,document,window));(function($,document,window,undefined){'use strict';var $jmpress=$.jmpress;function firstSlide(step,eventData){return $(this).find(eventData.settings.stepSelector).first();}
function prevOrNext(jmpress,step,eventData,prev){if(!step){return false;}
var stepSelector=eventData.settings.stepSelector;step=$(step);do{var item=step.near(stepSelector,prev);if(item.length===0||item.closest(jmpress).length===0){item=$(jmpress).find(stepSelector)[prev?"last":"first"]();}
if(!item.length){return false;}
step=item;}while(step.data("stepData").exclude);return step;}
$jmpress('initStep',function(step,eventData){eventData.stepData.exclude=eventData.data.exclude&&["false","no"].indexOf(eventData.data.exclude)===-1;});$jmpress('selectInitialStep',firstSlide);$jmpress('selectHome',firstSlide);$jmpress('selectEnd',function(step,eventData){return $(this).find(eventData.settings.stepSelector).last();});$jmpress('selectPrev',function(step,eventData){return prevOrNext(this,step,eventData,true);});$jmpress('selectNext',function(step,eventData){return prevOrNext(this,step,eventData);});}(jQuery,document,window));(function($,document,window,undefined){'use strict';$.jmpress('selectInitialStep',function(nil,eventData){return eventData.settings.start;});}(jQuery,document,window));(function($,document,window,undefined){'use strict';var $jmpress=$.jmpress;function routeFunc(jmpress,route,type){for(var i=0;i<route.length-1;i++){var from=route[i];var to=route[i+1];if($(jmpress).jmpress("initialized")){$(from,jmpress).data("stepData")[type]=to;}else{$(from,jmpress).attr('data-'+type,to);}}}
function selectPrevOrNext(step,eventData,attr,prev){var stepData=eventData.stepData;if(stepData[attr]){var near=$(step).near(stepData[attr],prev);if(near&&near.length){return near;}
near=$(stepData[attr],this)[prev?"last":"first"]();if(near&&near.length){return near;}}}
$jmpress('register','route',function(route,unidirectional,reversedRoute){if(typeof route==="string"){route=[route,route];}
routeFunc(this,route,reversedRoute?"prev":"next");if(!unidirectional){routeFunc(this,route.reverse(),reversedRoute?"next":"prev");}});$jmpress('initStep',function(step,eventData){for(var attr in{next:1,prev:1}){eventData.stepData[attr]=eventData.data[attr];}});$jmpress('selectNext',function(step,eventData){return selectPrevOrNext.call(this,step,eventData,"next");});$jmpress('selectPrev',function(step,eventData){return selectPrevOrNext.call(this,step,eventData,"prev",true);});}(jQuery,document,window));(function($,document,window,undefined){'use strict';var $jmpress=$.jmpress;var afterStepLoaded='ajax:afterStepLoaded',loadStep='ajax:loadStep';$jmpress('register',loadStep);$jmpress('register',afterStepLoaded);$jmpress('defaults').ajaxLoadedClass="loaded";$jmpress('initStep',function(step,eventData){eventData.stepData.src=$(step).attr('href')||eventData.data.src||false;eventData.stepData.srcLoaded=false;});$jmpress(loadStep,function(step,eventData){var stepData=eventData.stepData,href=stepData&&stepData.src,settings=eventData.settings;if(href){$(step).addClass(settings.ajaxLoadedClass);stepData.srcLoaded=true;$(step).load(href,function(response,status,xhr){$(eventData.jmpress).jmpress('fire',afterStepLoaded,step,$.extend({},eventData,{response:response,status:status,xhr:xhr}));});}});$jmpress('idle',function(step,eventData){if(!step){return;}
var settings=eventData.settings,jmpress=$(this),stepData=eventData.stepData;var siblings=$(step).add($(step).near(settings.stepSelector)).add($(step).near(settings.stepSelector,true)).add(jmpress.jmpress('fire','selectPrev',step,{stepData:$(step).data('stepData')})).add(jmpress.jmpress('fire','selectNext',step,{stepData:$(step).data('stepData')}));siblings.each(function(){var step=this,stepData=$(step).data("stepData");if(!stepData.src||stepData.srcLoaded){return;}
jmpress.jmpress('fire',loadStep,step,{stepData:$(step).data('stepData')});});});$jmpress("setActive",function(step,eventData){var stepData=$(step).data("stepData");if(!stepData.src||stepData.srcLoaded){return;}
$(this).jmpress('fire',loadStep,step,{stepData:$(step).data('stepData')});});}(jQuery,document,window));(function($,document,window,undefined){'use strict';var $jmpress=$.jmpress,hashLink="a[href^=#]";function randomString(){return""+Math.round(Math.random()*100000,0);}
function getElementFromUrl(settings){try{var el=$('#'+window.location.hash.replace(/^#\/?/,""));return el.length>0&&el.is(settings.stepSelector)?el:undefined;}catch(e){}}
function setHash(stepid){var shouldBeHash="#/"+stepid;if(window.history&&window.history.pushState){if(window.location.hash!==shouldBeHash){window.history.pushState({},'',shouldBeHash);}}else{if(window.location.hash!==shouldBeHash){window.location.hash=shouldBeHash;}}}
$jmpress('defaults').hash={use:true,update:true,bindChange:true};$jmpress('selectInitialStep',function(step,eventData){var settings=eventData.settings,hashSettings=settings.hash,current=eventData.current,jmpress=$(this);eventData.current.hashNamespace=".jmpress-"+randomString();if(hashSettings.use){if(hashSettings.bindChange){$(window).bind('hashchange'+current.hashNamespace,function(event){var urlItem=getElementFromUrl(settings);if(jmpress.jmpress('initialized')){jmpress.jmpress("scrollFix");}
if(urlItem&&urlItem.length){if(urlItem.attr("id")!==jmpress.jmpress("active").attr("id")){jmpress.jmpress('select',urlItem);}
setHash(urlItem.attr("id"));}
event.preventDefault();});$(hashLink).on("click"+current.hashNamespace,function(event){var href=$(this).attr("href");try{if($(href).is(settings.stepSelector)){jmpress.jmpress("select",href);event.preventDefault();event.stopPropagation();}}catch(e){}});}
return getElementFromUrl(settings);}});$jmpress('afterDeinit',function(nil,eventData){$(hashLink).off(eventData.current.hashNamespace);$(window).unbind(eventData.current.hashNamespace);});$jmpress('setActive',function(step,eventData){var settings=eventData.settings,current=eventData.current;if(settings.hash.use&&settings.hash.update){clearTimeout(current.hashtimeout);current.hashtimeout=setTimeout(function(){setHash($(eventData.delegatedFrom).attr('id'));},settings.transitionDuration+200);}});}(jQuery,document,window));(function($,document,window,undefined){'use strict';var $jmpress=$.jmpress,jmpressNext="next",jmpressPrev="prev";function randomString(){return""+Math.round(Math.random()*100000,0);}
function stopEvent(event){event.preventDefault();event.stopPropagation();}
$jmpress('defaults').keyboard={use:true,keys:{33:jmpressPrev,37:jmpressPrev,38:jmpressPrev,9:jmpressNext+":"+jmpressPrev,32:jmpressNext,34:jmpressNext,39:jmpressNext,40:jmpressNext,36:"home",35:"end"},ignore:{"INPUT":[32,37,38,39,40],"TEXTAREA":[32,37,38,39,40],"SELECT":[38,40]},tabSelector:"a[href]:visible, :input:visible"};$jmpress('afterInit',function(nil,eventData){var settings=eventData.settings,keyboardSettings=settings.keyboard,ignoreKeyboardSettings=keyboardSettings.ignore,current=eventData.current,jmpress=$(this);if(!settings.fullscreen){jmpress.attr("tabindex",0);}
current.keyboardNamespace=".jmpress-"+randomString();$(settings.fullscreen?document:jmpress).bind("keypress"+current.keyboardNamespace,function(event){for(var nodeName in ignoreKeyboardSettings){if(event.target.nodeName===nodeName&&ignoreKeyboardSettings[nodeName].indexOf(event.which)!==-1){return;}}
if(event.which>=37&&event.which<=40||event.which===32){stopEvent(event);}});$(settings.fullscreen?document:jmpress).bind("keydown"+current.keyboardNamespace,function(event){var eventTarget=$(event.target);if(!settings.fullscreen&&!eventTarget.closest(jmpress).length||!keyboardSettings.use){return;}
for(var nodeName in ignoreKeyboardSettings){if(eventTarget[0].nodeName===nodeName&&ignoreKeyboardSettings[nodeName].indexOf(event.which)!==-1){return;}}
var reverseSelect=false;var nextFocus;if(event.which===9){if(!eventTarget.closest(jmpress.jmpress('active')).length){if(!event.shiftKey){nextFocus=jmpress.jmpress('active').find("a[href], :input").filter(":visible").first();}else{reverseSelect=true;}}else{nextFocus=eventTarget.near(keyboardSettings.tabSelector,event.shiftKey);if(!$(nextFocus).closest(settings.stepSelector).is(jmpress.jmpress('active'))){nextFocus=undefined;}}
if(nextFocus&&nextFocus.length>0){nextFocus.focus();jmpress.jmpress("scrollFix");stopEvent(event);return;}else{if(event.shiftKey){reverseSelect=true;}}}
var action=keyboardSettings.keys[event.which];if(typeof action==="string"){if(action.indexOf(":")!==-1){action=action.split(":");action=event.shiftKey?action[1]:action[0];}
jmpress.jmpress(action);stopEvent(event);}else if($.isFunction(action)){action.call(jmpress,event);}else if(action){jmpress.jmpress.apply(jmpress,action);stopEvent(event);}
if(reverseSelect){nextFocus=jmpress.jmpress('active').find("a[href], :input").filter(":visible").last();nextFocus.focus();jmpress.jmpress("scrollFix");}});});$jmpress('afterDeinit',function(nil,eventData){$(document).unbind(eventData.current.keyboardNamespace);});}(jQuery,document,window));(function($,document,window,undefined){'use strict';function randomString(){return""+Math.round(Math.random()*100000,0);}
var browser=(function(){var ua=navigator.userAgent.toLowerCase();var match=/(chrome)[ \/]([\w.]+)/.exec(ua)||/(webkit)[ \/]([\w.]+)/.exec(ua)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(ua)||/(msie) ([\w.]+)/.exec(ua)||ua.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(ua)||[];return match[1]||"";}());var defaults=$.jmpress("defaults");defaults.viewPort={width:false,height:false,maxScale:0,minScale:0,zoomable:0,zoomBindMove:true,zoomBindWheel:true};var keys=defaults.keyboard.keys;keys[browser==='mozilla'?107:187]="zoomIn";keys[browser==='mozilla'?109:189]="zoomOut";defaults.reasonableAnimation.resize={transitionDuration:'0s',transitionDelay:'0ms'};defaults.reasonableAnimation.zoom={transitionDuration:'0s',transitionDelay:'0ms'};$.jmpress("initStep",function(step,eventData){for(var variable in{"viewPortHeight":1,"viewPortWidth":1,"viewPortMinScale":1,"viewPortMaxScale":1,"viewPortZoomable":1}){eventData.stepData[variable]=eventData.data[variable]&&parseFloat(eventData.data[variable]);}});$.jmpress("afterInit",function(nil,eventData){var jmpress=this;eventData.current.viewPortNamespace=".jmpress-"+randomString();$(window).bind("resize"+eventData.current.viewPortNamespace,function(event){$(jmpress).jmpress("reselect","resize");});eventData.current.userZoom=0;eventData.current.userTranslateX=0;eventData.current.userTranslateY=0;if(eventData.settings.viewPort.zoomBindWheel){$(eventData.settings.fullscreen?document:this).bind("mousewheel"+eventData.current.viewPortNamespace+" DOMMouseScroll"+eventData.current.viewPortNamespace,function(event,delta){delta=delta||event.originalEvent.wheelDelta||-event.originalEvent.detail;var direction=(delta / Math.abs(delta));if(direction<0){$(eventData.jmpress).jmpress("zoomOut",event.originalEvent.x,event.originalEvent.y);}else if(direction>0){$(eventData.jmpress).jmpress("zoomIn",event.originalEvent.x,event.originalEvent.y);}
return false;});}
if(eventData.settings.viewPort.zoomBindMove){$(eventData.settings.fullscreen?document:this).bind("mousedown"+eventData.current.viewPortNamespace,function(event){if(eventData.current.userZoom){eventData.current.userTranslating={x:event.clientX,y:event.clientY};event.preventDefault();event.stopImmediatePropagation();}}).bind("mousemove"+eventData.current.viewPortNamespace,function(event){var userTranslating=eventData.current.userTranslating;if(userTranslating){$(jmpress).jmpress("zoomTranslate",event.clientX-userTranslating.x,event.clientY-userTranslating.y);userTranslating.x=event.clientX;userTranslating.y=event.clientY;event.preventDefault();event.stopImmediatePropagation();}}).bind("mouseup"+eventData.current.viewPortNamespace,function(event){if(eventData.current.userTranslating){eventData.current.userTranslating=undefined;event.preventDefault();event.stopImmediatePropagation();}});}});function maxAbs(value,range){return Math.max(Math.min(value,range),-range);}
function zoom(x,y,direction){var current=$(this).jmpress("current"),settings=$(this).jmpress("settings"),stepData=$(this).jmpress("active").data("stepData"),container=$(this).jmpress("container");if(current.userZoom===0&&direction<0){return;}
var zoomableSteps=stepData.viewPortZoomable||settings.viewPort.zoomable;if(current.userZoom===zoomableSteps&&direction>0){return;}
current.userZoom+=direction;var halfWidth=$(container).innerWidth()/2,halfHeight=$(container).innerHeight()/2;x=x?x-halfWidth:x;y=y?y-halfHeight:y;current.userTranslateX=maxAbs(current.userTranslateX-direction*x / current.zoomOriginWindowScale / zoomableSteps,halfWidth*current.userZoom*current.userZoom / zoomableSteps);current.userTranslateY=maxAbs(current.userTranslateY-direction*y / current.zoomOriginWindowScale / zoomableSteps,halfHeight*current.userZoom*current.userZoom / zoomableSteps);$(this).jmpress("reselect","zoom");}
$.jmpress("register","zoomIn",function(x,y){zoom.call(this,x||0,y||0,1);});$.jmpress("register","zoomOut",function(x,y){zoom.call(this,x||0,y||0,-1);});$.jmpress("register","zoomTranslate",function(x,y){var current=$(this).jmpress("current"),settings=$(this).jmpress("settings"),stepData=$(this).jmpress("active").data("stepData"),container=$(this).jmpress("container");var zoomableSteps=stepData.viewPortZoomable||settings.viewPort.zoomable;var halfWidth=$(container).innerWidth(),halfHeight=$(container).innerHeight();current.userTranslateX=maxAbs(current.userTranslateX+x / current.zoomOriginWindowScale,halfWidth*current.userZoom*current.userZoom / zoomableSteps);current.userTranslateY=maxAbs(current.userTranslateY+y / current.zoomOriginWindowScale,halfHeight*current.userZoom*current.userZoom / zoomableSteps);$(this).jmpress("reselect","zoom");});$.jmpress('afterDeinit',function(nil,eventData){$(eventData.settings.fullscreen?document:this).unbind(eventData.current.viewPortNamespace);$(window).unbind(eventData.current.viewPortNamespace);});$.jmpress("setActive",function(step,eventData){var viewPort=eventData.settings.viewPort;var viewPortHeight=eventData.stepData.viewPortHeight||viewPort.height;var viewPortWidth=eventData.stepData.viewPortWidth||viewPort.width;var viewPortMaxScale=eventData.stepData.viewPortMaxScale||viewPort.maxScale;var viewPortMinScale=eventData.stepData.viewPortMinScale||viewPort.minScale;var windowScaleY=viewPortHeight&&$(eventData.container).innerHeight()/viewPortHeight;var windowScaleX=viewPortWidth&&$(eventData.container).innerWidth()/viewPortWidth;var windowScale=(windowScaleX||windowScaleY)&&Math.min(windowScaleX||windowScaleY,windowScaleY||windowScaleX);if(windowScale){windowScale=windowScale||1;if(viewPortMaxScale){windowScale=Math.min(windowScale,viewPortMaxScale);}
if(viewPortMinScale){windowScale=Math.max(windowScale,viewPortMinScale);}
var zoomableSteps=eventData.stepData.viewPortZoomable||eventData.settings.viewPort.zoomable;if(zoomableSteps){var diff=(1/windowScale)-(1/viewPortMaxScale);diff /=zoomableSteps;windowScale=1/((1/windowScale)-diff*eventData.current.userZoom);}
eventData.target.transform.reverse();if(eventData.current.userTranslateX&&eventData.current.userTranslateY){eventData.target.transform.push(["translate",eventData.current.userTranslateX,eventData.current.userTranslateY,0]);}else{eventData.target.transform.push(["translate"]);}
eventData.target.transform.push(["scale",windowScale,windowScale,1]);eventData.target.transform.reverse();eventData.target.perspectiveScale /=windowScale;}
eventData.current.zoomOriginWindowScale=windowScale;});$.jmpress("setInactive",function(step,eventData){if(!eventData.nextStep||!step||$(eventData.nextStep).attr("id")!==$(step).attr("id")){eventData.current.userZoom=0;eventData.current.userTranslateX=0;eventData.current.userTranslateY=0;}});}(jQuery,document,window));(function($,document,window,undefined){'use strict';var $jmpress=$.jmpress;function randomString(){return""+Math.round(Math.random()*100000,0);}
$jmpress("defaults").mouse={clickSelects:true};$jmpress("afterInit",function(nil,eventData){var settings=eventData.settings,stepSelector=settings.stepSelector,current=eventData.current,jmpress=$(this);current.clickableStepsNamespace=".jmpress-"+randomString();jmpress.bind("click"+current.clickableStepsNamespace,function(event){if(!settings.mouse.clickSelects||current.userZoom){return;}
var clickedStep=$(event.target).closest(stepSelector);if(clickedStep.is(jmpress.jmpress("active"))){return;}
if(clickedStep.length){jmpress.jmpress("select",clickedStep[0],"click");event.preventDefault();event.stopPropagation();}});});$jmpress('afterDeinit',function(nil,eventData){$(this).unbind(eventData.current.clickableStepsNamespace);});}(jQuery,document,window));(function($,document,window,undefined){'use strict';var $jmpress=$.jmpress;function randomString(){return""+Math.round(Math.random()*100000,0);}
$jmpress('afterInit',function(step,eventData){var settings=eventData.settings,current=eventData.current,jmpress=eventData.jmpress;current.mobileNamespace=".jmpress-"+randomString();var data,start=[0,0];$(settings.fullscreen?document:jmpress).bind("touchstart"+current.mobileNamespace,function(event){data=event.originalEvent.touches[0];start=[data.pageX,data.pageY];}).bind("touchmove"+current.mobileNamespace,function(event){data=event.originalEvent.touches[0];event.preventDefault();return false;}).bind("touchend"+current.mobileNamespace,function(event){var end=[data.pageX,data.pageY],diff=[end[0]-start[0],end[1]-start[1]];if(Math.max(Math.abs(diff[0]),Math.abs(diff[1]))>50){diff=Math.abs(diff[0])>Math.abs(diff[1])?diff[0]:diff[1];$(jmpress).jmpress(diff>0?"prev":"next");event.preventDefault();return false;}});});$jmpress('afterDeinit',function(nil,eventData){var settings=eventData.settings,current=eventData.current,jmpress=eventData.jmpress;$(settings.fullscreen?document:jmpress).unbind(current.mobileNamespace);});}(jQuery,document,window));(function($,document,window,undefined){'use strict';var $jmpress=$.jmpress,templateFromParentIdent="_template_",templateFromApplyIdent="_applied_template_";var templates={};function addUndefined(target,values,prefix){for(var name in values){var targetName=name;if(prefix){targetName=prefix+targetName.substr(0,1).toUpperCase()+targetName.substr(1);}
if($.isPlainObject(values[name])){addUndefined(target,values[name],targetName);}else if(target[targetName]===undefined){target[targetName]=values[name];}}}
function applyChildrenTemplates(children,templateChildren){if($.isArray(templateChildren)){if(templateChildren.length<children.length){$.error("more nested steps than children in template");}else{children.each(function(idx,child){child=$(child);var tmpl=child.data(templateFromParentIdent)||{};addUndefined(tmpl,templateChildren[idx]);child.data(templateFromParentIdent,tmpl);});}}else if($.isFunction(templateChildren)){children.each(function(idx,child){child=$(child);var tmpl=child.data(templateFromParentIdent)||{};addUndefined(tmpl,templateChildren(idx,child,children));child.data(templateFromParentIdent,tmpl);});}}
function applyTemplate(data,element,template,eventData){if(template.children){var children=element.children(eventData.settings.stepSelector);applyChildrenTemplates(children,template.children);}
applyTemplateData(data,template);}
function applyTemplateData(data,template){addUndefined(data,template);}
$jmpress("beforeInitStep",function(step,eventData){step=$(step);var data=eventData.data,templateFromAttr=data.template,templateFromApply=step.data(templateFromApplyIdent),templateFromParent=step.data(templateFromParentIdent);if(templateFromAttr){$.each(templateFromAttr.split(" "),function(idx,tmpl){var template=templates[tmpl];applyTemplate(data,step,template,eventData);});}
if(templateFromApply){applyTemplate(data,step,templateFromApply,eventData);}
if(templateFromParent){applyTemplate(data,step,templateFromParent,eventData);step.data(templateFromParentIdent,null);if(templateFromParent.template){$.each(templateFromParent.template.split(" "),function(idx,tmpl){var template=templates[tmpl];applyTemplate(data,step,template,eventData);});}}});$jmpress("beforeInit",function(nil,eventData){var data=$jmpress("dataset",this),dataTemplate=data.template,stepSelector=eventData.settings.stepSelector;if(dataTemplate){var template=templates[dataTemplate];applyChildrenTemplates($(this).find(stepSelector).filter(function(){return!$(this).parent().is(stepSelector);}),template.children);}});$jmpress("register","template",function(name,tmpl){if(templates[name]){templates[name]=$.extend(true,{},templates[name],tmpl);}else{templates[name]=$.extend(true,{},tmpl);}});$jmpress("register","apply",function(selector,tmpl){if(!tmpl){var stepSelector=$(this).jmpress("settings").stepSelector;applyChildrenTemplates($(this).find(stepSelector).filter(function(){return!$(this).parent().is(stepSelector);}),selector);}else if($.isArray(tmpl)){applyChildrenTemplates($(selector),tmpl);}else{var template;if(typeof tmpl==="string"){template=templates[tmpl];}else{template=$.extend(true,{},tmpl);}
$(selector).each(function(idx,element){element=$(element);var tmpl=element.data(templateFromApplyIdent)||{};addUndefined(tmpl,template);element.data(templateFromApplyIdent,tmpl);});}});}(jQuery,document,window));(function($,document,window,undefined){'use strict';$.jmpress("setActive",function(step,eventData){if(eventData.prevStep!==step){$(step).triggerHandler("enterStep");}});$.jmpress("setInactive",function(step,eventData){if(eventData.nextStep!==step){$(step).triggerHandler("leaveStep");}});}(jQuery,document,window));(function($,document,window,undefined){'use strict';function parseSubstepInfo(str){var arr=str.split(" ");var className=arr[0];var config={willClass:"will-"+className,doClass:"do-"+className,hasClass:"has-"+className};var state="";for(var i=1;i<arr.length;i++){var s=arr[i];switch(state){case"":if(s==="after"){state="after";}else{$.warn("unknown keyword in '"+str+"'. '"+s+"' unknown.");}
break;case"after":if(s.match(/^[1-9][0-9]*m?s?/)){var value=parseFloat(s);if(s.indexOf("ms")!==-1){value*=1;}else if(s.indexOf("s")!==-1){value*=1000;}else if(s.indexOf("m")!==-1){value*=60000;}
config.delay=value;}else{config.after=Array.prototype.slice.call(arr,i).join(" ");i=arr.length;}}}
return config;}
function find(array,selector,start,end){end=end||(array.length-1);start=start||0;for(var i=start;i<end+1;i++){if($(array[i].element).is(selector)){return i;}}}
function addOn(list,substep,delay){$.each(substep._on,function(idx,child){list.push({substep:child.substep,delay:child.delay+delay});addOn(list,child.substep,child.delay+delay);});}
$.jmpress("defaults").customAnimationDataAttribute="jmpress";$.jmpress("afterInit",function(nil,eventData){eventData.current.animationTimeouts=[];eventData.current.animationCleanupWaiting=[];});$.jmpress("applyStep",function(step,eventData){var substepsData={};var listOfSubsteps=[];$(step).find("[data-"+eventData.settings.customAnimationDataAttribute+"]").each(function(idx,element){if($(element).closest(eventData.settings.stepSelector).is(step)){listOfSubsteps.push({element:element});}});if(listOfSubsteps.length===0){return;}
$.each(listOfSubsteps,function(idx,substep){substep.info=parseSubstepInfo($(substep.element).data(eventData.settings.customAnimationDataAttribute));$(substep.element).addClass(substep.info.willClass);substep._on=[];substep._after=null;});var current={_after:undefined,_on:[],info:{}};$.each(listOfSubsteps,function(idx,substep){var other=substep.info.after;if(other){if(other==="step"){other=current;}else if(other==="prev"){other=listOfSubsteps[idx-1];}else{var index=find(listOfSubsteps,other,0,idx-1);if(index===undefined){index=find(listOfSubsteps,other);}
other=(index===undefined||index===idx)?listOfSubsteps[idx-1]:listOfSubsteps[index];}}else{other=listOfSubsteps[idx-1];}
if(other){if(!substep.info.delay){if(!other._after){other._after=substep;return;}
other=other._after;}
other._on.push({substep:substep,delay:substep.info.delay||0});}});if(current._after===undefined&&current._on.length===0){var startStep=find(listOfSubsteps,eventData.stepData.startSubstep)||0;current._after=listOfSubsteps[startStep];}
var substepsInOrder=[];function findNextFunc(idx,item){if(item.substep._after){current=item.substep._after;return false;}}
do{var substepList=[{substep:current,delay:0}];addOn(substepList,current,0);substepsInOrder.push(substepList);current=null;$.each(substepList,findNextFunc);}while(current);substepsData.list=substepsInOrder;$(step).data("substepsData",substepsData);});$.jmpress("unapplyStep",function(step,eventData){var substepsData=$(step).data("substepsData");if(substepsData){$.each(substepsData.list,function(idx,activeSubsteps){$.each(activeSubsteps,function(idx,substep){if(substep.substep.info.willClass){$(substep.substep.element).removeClass(substep.substep.info.willClass);}
if(substep.substep.info.hasClass){$(substep.substep.element).removeClass(substep.substep.info.hasClass);}
if(substep.substep.info.doClass){$(substep.substep.element).removeClass(substep.substep.info.doClass);}});});}});$.jmpress("setActive",function(step,eventData){var substepsData=$(step).data("substepsData");if(!substepsData){return;}
if(eventData.substep===undefined){eventData.substep=(eventData.reason==="prev"?substepsData.list.length-1:0);}
var substep=eventData.substep;$.each(eventData.current.animationTimeouts,function(idx,timeout){clearTimeout(timeout);});eventData.current.animationTimeouts=[];$.each(substepsData.list,function(idx,activeSubsteps){var applyHas=idx<substep;var applyDo=idx<=substep;$.each(activeSubsteps,function(idx,substep){if(substep.substep.info.hasClass){$(substep.substep.element)[(applyHas?"add":"remove")+"Class"](substep.substep.info.hasClass);}
function applyIt(){$(substep.substep.element).addClass(substep.substep.info.doClass);}
if(applyDo&&!applyHas&&substep.delay&&eventData.reason!=="prev"){if(substep.substep.info.doClass){$(substep.substep.element).removeClass(substep.substep.info.doClass);eventData.current.animationTimeouts.push(setTimeout(applyIt,substep.delay));}}else{if(substep.substep.info.doClass){$(substep.substep.element)[(applyDo?"add":"remove")+"Class"](substep.substep.info.doClass);}}});});});$.jmpress("setInactive",function(step,eventData){if(eventData.nextStep===step){return;}
function cleanupAnimation(substepsData){$.each(substepsData.list,function(idx,activeSubsteps){$.each(activeSubsteps,function(idx,substep){if(substep.substep.info.hasClass){$(substep.substep.element).removeClass(substep.substep.info.hasClass);}
if(substep.substep.info.doClass){$(substep.substep.element).removeClass(substep.substep.info.doClass);}});});}
$.each(eventData.current.animationCleanupWaiting,function(idx,item){cleanupAnimation(item);});eventData.current.animationCleanupWaiting=[];var substepsData=$(step).data("substepsData");if(substepsData){eventData.current.animationCleanupWaiting.push(substepsData);}});$.jmpress("selectNext",function(step,eventData){if(eventData.substep===undefined){return;}
var substepsData=$(step).data("substepsData");if(!substepsData){return;}
if(eventData.substep<substepsData.list.length-1){return{step:step,substep:eventData.substep+1};}});$.jmpress("selectPrev",function(step,eventData){if(eventData.substep===undefined){return;}
var substepsData=$(step).data("substepsData");if(!substepsData){return;}
if(eventData.substep>0){return{step:step,substep:eventData.substep-1};}});}(jQuery,document,window));
/*!
 * plugin for jmpress.js v0.4.5
 *
 * Copyright 2013 Kyle Robinson Young @shama & Tobias Koppers @sokra
 * Licensed MIT
 * http://www.opensource.org/licenses/mit-license.php
 */ /**jmpress.toggle plugin*For binding a key to toggle de/initialization of jmpress.js.*/
(function($,document,window,undefined){'use strict';$.jmpress("register","toggle",function(key,config,initial){var jmpress=this;$(document).bind("keydown",function(event){if(event.keyCode===key){if($(jmpress).jmpress("initialized")){$(jmpress).jmpress("deinit");}else{$(jmpress).jmpress(config);}}});if(initial){$(jmpress).jmpress(config);}});}(jQuery,document,window));(function($,document,window,undefined){'use strict';$.jmpress("initStep",function(step,eventData){for(var name in eventData.data){if(name.indexOf("secondary")===0){eventData.stepData[name]=eventData.data[name];}}});function exchangeIf(childStepData,condition,step){if(childStepData.secondary&&childStepData.secondary.split(" ").indexOf(condition)!==-1){for(var name in childStepData){if(name.length>9&&name.indexOf("secondary")===0){var tmp=childStepData[name];var normal=name.substr(9);normal=normal.substr(0,1).toLowerCase()+normal.substr(1);childStepData[name]=childStepData[normal];childStepData[normal]=tmp;}}
$(this).jmpress("reapply",$(step));}}
$.jmpress("beforeActive",function(step,eventData){exchangeIf.call(eventData.jmpress,$(step).data("stepData"),"self",step);var parent=$(step).parent();$(parent).children(eventData.settings.stepSelector).each(function(idx,child){var childStepData=$(child).data("stepData");exchangeIf.call(eventData.jmpress,childStepData,"siblings",child);});function grandchildrenFunc(idx,child){var childStepData=$(child).data("stepData");exchangeIf.call(eventData.jmpress,childStepData,"grandchildren",child);}
for(var i=1;i<eventData.parents.length;i++){$(eventData.parents[i]).children(eventData.settings.stepSelector).each();}});$.jmpress("setInactive",function(step,eventData){exchangeIf.call(eventData.jmpress,$(step).data("stepData"),"self",step);var parent=$(step).parent();$(parent).children(eventData.settings.stepSelector).each(function(idx,child){var childStepData=$(child).data("stepData");exchangeIf.call(eventData.jmpress,childStepData,"siblings",child);});function grandchildrenFunc(idx,child){var childStepData=$(child).data("stepData");exchangeIf.call(eventData.jmpress,childStepData,"grandchildren",child);}
for(var i=1;i<eventData.parents.length;i++){$(eventData.parents[i]).children(eventData.settings.stepSelector).each(grandchildrenFunc);}});}(jQuery,document,window));(function($,document,window,undefined){'use strict';$.jmpress("defaults").duration={defaultValue:-1,defaultAction:"next",barSelector:undefined,barProperty:"width",barPropertyStart:"0",barPropertyEnd:"100%"};$.jmpress("initStep",function(step,eventData){eventData.stepData.duration=eventData.data.duration&&parseInt(eventData.data.duration,10);eventData.stepData.durationAction=eventData.data.durationAction;});$.jmpress("setInactive",function(step,eventData){var settings=eventData.settings,durationSettings=settings.duration,current=eventData.current;var dur=eventData.stepData.duration||durationSettings.defaultValue;if(current.durationTimeout){if(durationSettings.barSelector){var css={transitionProperty:durationSettings.barProperty,transitionDuration:'0',transitionDelay:'0',transitionTimingFunction:'linear'};css[durationSettings.barProperty]=durationSettings.barPropertyStart;var bars=$(durationSettings.barSelector);$.jmpress("css",bars,css);bars.each(function(idx,element){var next=$(element).next();var parent=$(element).parent();$(element).detach();if(next.length){next.insertBefore(element);}else{parent.append(element);}});}
clearTimeout(current.durationTimeout);delete current.durationTimeout;}});$.jmpress("setActive",function(step,eventData){var settings=eventData.settings,durationSettings=settings.duration,current=eventData.current;var dur=eventData.stepData.duration||durationSettings.defaultValue;if(dur&&dur>0){if(durationSettings.barSelector){var css={transitionProperty:durationSettings.barProperty,transitionDuration:(dur-settings.transitionDuration*2/3-100)+"ms",transitionDelay:(settings.transitionDuration*2/3)+'ms',transitionTimingFunction:'linear'};css[durationSettings.barProperty]=durationSettings.barPropertyEnd;$.jmpress("css",$(durationSettings.barSelector),css);}
var jmpress=this;if(current.durationTimeout){clearTimeout(current.durationTimeout);current.durationTimeout=undefined;}
current.durationTimeout=setTimeout(function(){var action=eventData.stepData.durationAction||durationSettings.defaultAction;$(jmpress).jmpress(action);},dur);}});}(jQuery,document,window));(function($,document,window,undefined){'use strict';var $jmpress=$.jmpress;var PREFIX="jmpress-presentation-";function randomString(){return""+Math.round(Math.random()*100000,0);}
$jmpress("defaults").presentationMode={use:true,url:"presentation-screen.html",notesUrl:false,transferredValues:["userZoom","userTranslateX","userTranslateY"]};$jmpress("defaults").keyboard.keys[80]="presentationPopup";$jmpress("afterInit",function(nil,eventData){var current=eventData.current;current.selectMessageListeners=[];if(eventData.settings.presentationMode.use){window.addEventListener("message",function(event){try{if(typeof event.data!=="string"||event.data.indexOf(PREFIX)!==0){return;}
var json=JSON.parse(event.data.slice(PREFIX.length));switch(json.type){case"select":$.each(eventData.settings.presentationMode.transferredValues,function(idx,name){eventData.current[name]=json[name];});if(/[a-z0-9\-]+/i.test(json.targetId)&&typeof json.substep in{number:1,undefined:1}){$(eventData.jmpress).jmpress("select",{step:"#"+json.targetId,substep:json.substep},json.reason);}else{$.error("For security reasons the targetId must match /[a-z0-9\\-]+/i and substep must be a number.");}
break;case"listen":current.selectMessageListeners.push(event.source);break;case"ok":clearTimeout(current.presentationPopupTimeout);break;case"read":try{event.source.postMessage(PREFIX+JSON.stringify({type:"url",url:window.location.href,notesUrl:eventData.settings.presentationMode.notesUrl}),"*");}catch(e){$.error("Cannot post message to source: "+e);}
break;default:throw"Unknown message type: "+json.type;}}catch(e){$.error("Received message is malformed: "+e);}});try{if(window.parent&&window.parent!==window){window.parent.postMessage(PREFIX+JSON.stringify({"type":"afterInit"}),"*");}}catch(e){$.error("Cannot post message to parent: "+e);}}});$jmpress("afterDeinit",function(nil,eventData){if(eventData.settings.presentationMode.use){try{if(window.parent&&window.parent!==window){window.parent.postMessage(PREFIX+JSON.stringify({"type":"afterDeinit"}),"*");}}catch(e){$.error("Cannot post message to parent: "+e);}}});$jmpress("setActive",function(step,eventData){var stepId=$(eventData.delegatedFrom).attr("id"),substep=eventData.substep,reason=eventData.reason;$.each(eventData.current.selectMessageListeners,function(idx,listener){try{var msg={"type":"select","targetId":stepId,"substep":substep,"reason":reason};$.each(eventData.settings.presentationMode.transferredValues,function(idx,name){msg[name]=eventData.current[name];});listener.postMessage(PREFIX+JSON.stringify(msg),"*");}catch(e){$.error("Cannot post message to listener: "+e);}});});$jmpress("register","presentationPopup",function(){function trySend(){jmpress.jmpress("current").presentationPopupTimeout=setTimeout(trySend,100);try{popup.postMessage(PREFIX+JSON.stringify({type:"url",url:window.location.href,notesUrl:jmpress.jmpress("settings").presentationMode.notesUrl}),"*");}catch(e){}}
var jmpress=$(this),popup;if(jmpress.jmpress("settings").presentationMode.use){popup=window.open($(this).jmpress("settings").presentationMode.url);jmpress.jmpress("current").presentationPopupTimeout=setTimeout(trySend,100);}});}(jQuery,document,window));

} /* end modules/shortcodes/js/jmpress.js */

if ( jpconcat.files['modules/shortcodes/js/jmpress.min.js'] ) {

/*!
 * jmpress.js v0.4.5
 * http://jmpressjs.github.com/jmpress.js
 *
 * A jQuery plugin to build a website on the infinite canvas.
 *
 * Copyright 2013 Kyle Robinson Young @shama & Tobias Koppers @sokra
 * Licensed MIT
 * http://www.opensource.org/licenses/mit-license.php
 *
 * Based on the foundation laid by Bartek Szopka @bartaz
 */
(function(e,t,s,a){"use strict";function r(e){if(e){var t=1+e.substr(1).search(/[A-Z]/),s=e.substr(0,t).toLowerCase(),a=e.substr(t).toLowerCase();return"-"+s+"-"+a}}function n(e){return e?e+",":""}function i(e){return e.length>0?e:null}function o(r){function n(t,s){var a=p(t),r={oldStyle:e(t).attr("style")||""},n={data:a,stepData:r};f.call(this,"beforeInitStep",e(t),n),r.delegate=a.delegate,f.call(this,"initStep",e(t),n),e(t).data("stepData",r),e(t).attr("id")||e(t).attr("id","step-"+(s+1)),f.call(this,"applyStep",e(t),n)}function o(t){var s=e(t).data("stepData");e(t).attr("style",s.oldStyle),f.call(this,"unapplyStep",e(t),{stepData:s})}function c(t){f.call(this,"unapplyStep",e(t),{stepData:t.data("stepData")}),f.call(this,"applyStep",e(t),{stepData:t.data("stepData")})}function l(){O&&f.call(this,"setInactive",O,{stepData:e(O).data("stepData"),reason:"deinit"}),Y.jmpressClass&&e(I).removeClass(Y.jmpressClass),f.call(this,"beforeDeinit",e(this),{}),e(A.stepSelector,I).each(function(){o.call(I,this)}),k.attr("style",Z.container),A.fullscreen&&e("html").attr("style",""),z.attr("style",Z.area),e(X).children().each(function(){I.append(e(this))}),A.fullscreen?X.remove():(X.remove(),z.remove()),f.call(this,"afterDeinit",e(this),{}),e(I).data("jmpressmethods",!1)}function f(t,s,a){a.settings=A,a.current=Y,a.container=k,a.parents=s?d(s):null,a.current=Y,a.jmpress=this;var r={};return e.each(A[t],function(e,t){r.value=t.call(I,s,a)||r.value}),r.value}function d(t){return e(t).parentsUntil(I).not(I).filter(A.stepSelector)}function v(e){return g({step:O,substep:F},e)}function g(t,s){var r;if(e.isPlainObject(t)&&(r=t.substep,t=t.step),"string"==typeof t&&(t=I.find(t).first()),!t||!e(t).data("stepData"))return!1;b.call(this);var n=e(t).data("stepData"),o=!1;if(f.call(this,"beforeChange",t,{stepData:n,reason:s,cancel:function(){o=!0}}),o)return a;var c={},l=t;e(t).data("stepData").delegate&&(l=i(e(t).parentsUntil(I).filter(A.stepSelector).filter(n.delegate))||i(e(t).near(n.delegate))||i(e(t).near(n.delegate,!0))||i(e(n.delegate,I)),l?n=l.data("stepData"):l=t),Q&&f.call(this,"setInactive",Q,{stepData:e(Q).data("stepData"),delegatedFrom:O,reason:s,target:c,nextStep:l,nextSubstep:r,nextStepData:n});var u={stepData:n,delegatedFrom:t,reason:s,target:c,substep:r,prevStep:Q,prevSubstep:F,prevStepData:Q&&e(Q).data("stepData")};return f.call(this,"beforeActive",l,u),f.call(this,"setActive",l,u),Y.jmpressClass&&e(I).removeClass(Y.jmpressClass),e(I).addClass(Y.jmpressClass="step-"+e(l).attr("id")),Y.jmpressDelegatedClass&&e(I).removeClass(Y.jmpressDelegatedClass),e(I).addClass(Y.jmpressDelegatedClass="delegating-step-"+e(t).attr("id")),f.call(this,"applyTarget",l,e.extend({canvas:X,area:z,beforeActive:Q},u)),O=t,F=u.substep,Q=l,Y.idleTimeout&&clearTimeout(Y.idleTimeout),Y.idleTimeout=setTimeout(function(){f.call(this,"idle",l,u)},Math.max(1,A.transitionDuration-100)),l}function b(){(function t(){function a(){(0!==e(k).scrollTop()||0!==e(k).scrollLeft())&&t()}if("BODY"===e(k)[0].tagName)try{s.scrollTo(0,0)}catch(r){}e(k).scrollTop(0),e(k).scrollLeft(0),setTimeout(a,1),setTimeout(a,10),setTimeout(a,100),setTimeout(a,200),setTimeout(a,400)})()}function y(e){return g.call(this,e,"jump")}function j(){return g.call(this,f.call(this,"selectNext",O,{stepData:e(O).data("stepData"),substep:F}),"next")}function D(){return g.call(this,f.call(this,"selectPrev",O,{stepData:e(O).data("stepData"),substep:F}),"prev")}function S(){return g.call(this,f.call(this,"selectHome",O,{stepData:e(O).data("stepData")}),"home")}function x(){return g.call(this,f.call(this,"selectEnd",O,{stepData:e(O).data("stepData")}),"end")}function w(t){return u(X,t||{}),e(X)}function C(){return Q&&e(Q)}function T(t,s,r){return h[t]?f.call(this,t,s,r):(e.error("callback "+t+" is not registered."),a)}function M(){var e=navigator.userAgent.toLowerCase();return-1===e.search(/(iphone)|(ipod)|(android)/)||-1!==e.search(/(chrome)/)}r=e.extend(!0,{},r||{});var P={},N=null;for(N in h)P[N]=e.isFunction(r[N])?[r[N]]:r[N],r[N]=[];var A=e.extend(!0,{},m,r);for(N in h)P[N]&&Array.prototype.push.apply(A[N],P[N]);var I=e(this),k=null,z=null,Z={container:"",area:""},X=null,Y=null,O=!1,F=null,Q=!1;if(I.data("jmpressmethods",{select:g,reselect:v,scrollFix:b,goTo:y,next:j,prev:D,home:S,end:x,canvas:w,container:function(){return k},settings:function(){return A},active:C,current:function(){return Y},fire:T,init:function(t){n.call(this,e(t),Y.nextIdNumber++)},deinit:function(t){t?o.call(this,e(t)):l.call(this)},reapply:c}),M()===!1)return A.notSupportedClass&&I.addClass(A.notSupportedClass),a;A.notSupportedClass&&I.removeClass(A.notSupportedClass);var E=e(A.stepSelector,I);k=I,z=e("<div />"),X=e("<div />"),e(I).children().filter(E).each(function(){X.append(e(this))}),A.fullscreen&&(k=e("body"),e("html").css({overflow:"hidden"}),z=I),Z.area=z.attr("style")||"",Z.container=k.attr("style")||"",A.fullscreen?(k.css({height:"100%"}),I.append(X)):(k.css({position:"relative"}),z.append(X),I.append(z)),e(k).addClass(A.containerClass),e(z).addClass(A.areaClass),e(X).addClass(A.canvasClass),t.documentElement.style.height="100%",k.css({overflow:"hidden"});var L={position:"absolute",transitionDuration:"0s"};L=e.extend({},A.animation,L),u(z,L),u(z,{top:"50%",left:"50%",perspective:"1000px"}),u(X,L),Y={},f.call(this,"beforeInit",null,{}),E.each(function(e){n.call(I,this,e)}),Y.nextIdNumber=E.length,f.call(this,"afterInit",null,{}),g.call(this,f.call(this,"selectInitialStep","init",{})),A.initClass&&e(E).removeClass(A.initClass)}function c(){return m}function l(t,s){e.isFunction(s)?g[t]?e.error("function "+t+" is already registered."):g[t]=s:h[t]?e.error("callback "+t+" is already registered."):(h[t]=1,m[t]=[])}function u(t,s){var a,r,n={};for(a in s)s.hasOwnProperty(a)&&(r=d(a),null!==r&&(n[r]=s[a]));return e(t).css(n),t}function p(t){function s(e){e=e.split("-");for(var t=1;e.length>t;t++)e[t]=e[t].substr(0,1).toUpperCase()+e[t].substr(1);return e.join("")}if(e(t)[0].dataset)return e.extend({},e(t)[0].dataset);var a={},r=e(t)[0].attributes;return e.each(r,function(e,t){"data-"===t.nodeName.substr(0,5)&&(a[s(t.nodeName.substr(5))]=t.nodeValue)}),a}function f(){return!!e(this).data("jmpressmethods")}var d=function(){var e=t.createElement("dummy").style,s="Webkit Moz O ms Khtml".split(" "),r={};return function(t){if(r[t]===a){var n=t.charAt(0).toUpperCase()+t.substr(1),i=(t+" "+s.join(n+" ")+n).split(" ");r[t]=null;for(var o in i)if(e[i[o]]!==a){r[t]=i[o];break}}return r[t]}}(),m={stepSelector:".step",containerClass:"",canvasClass:"",areaClass:"",notSupportedClass:"not-supported",fullscreen:!0,animation:{transformOrigin:"top left",transitionProperty:n(r(d("transform")))+n(r(d("perspective")))+"opacity",transitionDuration:"1s",transitionDelay:"500ms",transitionTimingFunction:"ease-in-out",transformStyle:"preserve-3d"},transitionDuration:1500},h={beforeChange:1,beforeInitStep:1,initStep:1,beforeInit:1,afterInit:1,beforeDeinit:1,afterDeinit:1,applyStep:1,unapplyStep:1,setInactive:1,beforeActive:1,setActive:1,selectInitialStep:1,selectPrev:1,selectNext:1,selectHome:1,selectEnd:1,idle:1,applyTarget:1};for(var v in h)m[v]=[];var g={init:o,initialized:f,deinit:function(){},css:u,pfx:d,defaults:c,register:l,dataset:p};e.fn.jmpress=function(t){function s(){var s=e(this).data("jmpressmethods");if(s&&s[t])return s[t].apply(this,Array.prototype.slice.call(arguments,1));if(g[t])return g[t].apply(this,Array.prototype.slice.call(arguments,1));if(h[t]&&s){var a=s.settings(),r=Array.prototype.slice.call(arguments,1)[0];e.isFunction(r)&&(a[t]=a[t]||[],a[t].push(r))}else{if("object"==typeof t||!t)return o.apply(this,arguments);e.error("Method "+t+" does not exist on jQuery.jmpress")}return this}var a,r=arguments;return e(this).each(function(e,t){a=s.apply(t,r)}),a},e.extend({jmpress:function(t){if(g[t])return g[t].apply(this,Array.prototype.slice.call(arguments,1));if(h[t]){var s=Array.prototype.slice.call(arguments,1)[0];e.isFunction(s)?m[t].push(s):e.error("Second parameter should be a function: $.jmpress( callbackName, callbackFunction )")}else e.error("Method "+t+" does not exist on jQuery.jmpress")}})})(jQuery,document,window),function(e){"use strict";function t(t,s,a,r){var n;return t.each(function(t,i){return r&&(n=s(i,a,r))?!1:e(i).is(a)?(n=i,!1):!r&&(n=s(i,a,r))?!1:undefined}),n}function s(a,r,n){var i=e(a).children();return n&&(i=e(i.get().reverse())),t(i,s,r,n)}function a(a,r,n){return t(e(a)[n?"prevAll":"nextAll"](),s,r,n)}function r(t,s,r){var n,i=e(t).parents();return i=e(i.get()),e.each(i.get(),function(t,i){return r&&e(i).is(s)?(n=i,!1):(n=a(i,s,r),n?!1:undefined)}),n}e.fn.near=function(t,n){var i=[];return e(this).each(function(e,o){var c=(n?!1:s(o,t,n))||a(o,t,n)||r(o,t,n);c&&i.push(c)}),e(i)}}(jQuery,document,window),function(e,t,s,a){"use strict";function r(e){return Math.round(1e4*e)/1e4+""}var n={3:{transform:function(t,s){var a="translate(-50%,-50%)";e.each(s,function(e,t){var s,n=["X","Y","Z"];if("translate"===t[0])a+=" translate3d("+r(t[1]||0)+"px,"+r(t[2]||0)+"px,"+r(t[3]||0)+"px)";else if("rotate"===t[0]){var i=t[4]?[1,2,3]:[3,2,1];for(s=0;3>s;s++)a+=" rotate"+n[i[s]-1]+"("+r(t[i[s]]||0)+"deg)"}else if("scale"===t[0])for(s=0;3>s;s++)a+=" scale"+n[s]+"("+r(t[s+1]||1)+")"}),e.jmpress("css",t,e.extend({},{transform:a}))}},2:{transform:function(t,s){var a="translate(-50%,-50%)";e.each(s,function(e,t){var s=["X","Y"];if("translate"===t[0])a+=" translate("+r(t[1]||0)+"px,"+r(t[2]||0)+"px)";else if("rotate"===t[0])a+=" rotate("+r(t[3]||0)+"deg)";else if("scale"===t[0])for(var n=0;2>n;n++)a+=" scale"+s[n]+"("+r(t[n+1]||1)+")"}),e.jmpress("css",t,e.extend({},{transform:a}))}},1:{transform:function(t,s){var a={top:0,left:0};e.each(s,function(e,t){"translate"===t[0]&&(a.left=Math.round(t[1]||0)+"px",a.top=Math.round(t[2]||0)+"px")}),t.animate(a,1e3)}}},i=function(){return e.jmpress("pfx","perspective")?n[3]:e.jmpress("pfx","transform")?n[2]:n[1]}();e.jmpress("defaults").reasonableAnimation={},e.jmpress("initStep",function(t,s){var a=s.data,r=s.stepData,n=parseFloat;e.extend(r,{x:n(a.x)||0,y:n(a.y)||0,z:n(a.z)||0,r:n(a.r)||0,phi:n(a.phi)||0,rotate:n(a.rotate)||0,rotateX:n(a.rotateX)||0,rotateY:n(a.rotateY)||0,rotateZ:n(a.rotateZ)||0,revertRotate:!1,scale:n(a.scale)||1,scaleX:n(a.scaleX)||!1,scaleY:n(a.scaleY)||!1,scaleZ:n(a.scaleZ)||1})}),e.jmpress("afterInit",function(t,s){var a=s.settings.stepSelector,r=s.current;r.perspectiveScale=1,r.maxNestedDepth=0;for(var n=e(s.jmpress).find(a).children(a);n.length;)r.maxNestedDepth++,n=n.children(a)}),e.jmpress("applyStep",function(t,s){e.jmpress("css",e(t),{position:"absolute",transformStyle:"preserve-3d"}),s.parents.length>0&&e.jmpress("css",e(t),{top:"50%",left:"50%"});var a=s.stepData,r=[["translate",a.x||a.r*Math.sin(a.phi*Math.PI/180),a.y||-a.r*Math.cos(a.phi*Math.PI/180),a.z],["rotate",a.rotateX,a.rotateY,a.rotateZ||a.rotate,!0],["scale",a.scaleX||a.scale,a.scaleY||a.scale,a.scaleZ||a.scale]];i.transform(t,r)}),e.jmpress("setActive",function(t,s){var r=s.target,n=s.stepData,i=r.transform=[];r.perspectiveScale=1;for(var o=s.current.maxNestedDepth;o>(s.parents.length||0);o--)i.push(["scale"],["rotate"],["translate"]);i.push(["scale",1/(n.scaleX||n.scale),1/(n.scaleY||n.scale),1/n.scaleZ]),i.push(["rotate",-n.rotateX,-n.rotateY,-(n.rotateZ||n.rotate)]),i.push(["translate",-(n.x||n.r*Math.sin(n.phi*Math.PI/180)),-(n.y||-n.r*Math.cos(n.phi*Math.PI/180)),-n.z]),r.perspectiveScale*=n.scaleX||n.scale,e.each(s.parents,function(t,s){var a=e(s).data("stepData");i.push(["scale",1/(a.scaleX||a.scale),1/(a.scaleY||a.scale),1/a.scaleZ]),i.push(["rotate",-a.rotateX,-a.rotateY,-(a.rotateZ||a.rotate)]),i.push(["translate",-(a.x||a.r*Math.sin(a.phi*Math.PI/180)),-(a.y||-a.r*Math.cos(a.phi*Math.PI/180)),-a.z]),r.perspectiveScale*=a.scaleX||a.scale}),e.each(i,function(e,t){function r(r){s.current["rotate"+r+"-"+e]===a&&(s.current["rotate"+r+"-"+e]=t[r]||0);var n=s.current["rotate"+r+"-"+e],i=t[r]||0,o=n%360,c=i%360;0>o&&(o+=360),0>c&&(c+=360);var l=c-o;-180>l?l+=360:l>180&&(l-=360),s.current["rotate"+r+"-"+e]=t[r]=n+l}"rotate"===t[0]&&(r(1),r(2),r(3))})}),e.jmpress("applyTarget",function(t,s){var r,n=s.target,o=(s.stepData,s.settings),c=1.3*n.perspectiveScale<s.current.perspectiveScale,l=n.perspectiveScale>1.3*s.current.perspectiveScale,u=-1;e.each(n.transform,function(e,t){return 1>=t.length||"rotate"===t[0]&&0===t[1]%360&&0===t[2]%360&&0===t[3]%360?a:"scale"!==t[0]?!1:(u=e,a)}),u!==s.current.oldLastScale&&(c=l=!1,s.current.oldLastScale=u);var p=[];if(-1!==u)for(;u>=0;)"scale"===n.transform[u][0]&&(p.push(n.transform[u]),n.transform[u]=["scale"]),u--;var f=o.animation;o.reasonableAnimation[s.reason]&&(f=e.extend({},f,o.reasonableAnimation[s.reason])),r={perspective:Math.round(1e3*n.perspectiveScale)+"px"},r=e.extend({},f,r),c||(r.transitionDelay="0s"),s.beforeActive||(r.transitionDuration="0s",r.transitionDelay="0s"),e.jmpress("css",s.area,r),i.transform(s.area,p),r=e.extend({},f),l||(r.transitionDelay="0s"),s.beforeActive||(r.transitionDuration="0s",r.transitionDelay="0s"),s.current.perspectiveScale=n.perspectiveScale,e.jmpress("css",s.canvas,r),i.transform(s.canvas,n.transform)})}(jQuery,document,window),function(e){"use strict";var t=e.jmpress,s="activeClass",a="nestedActiveClass",r=t("defaults");r[a]="nested-active",r[s]="active",t("setInactive",function(t,r){var n=r.settings,i=n[s],o=n[a];i&&e(t).removeClass(i),o&&e.each(r.parents,function(t,s){e(s).removeClass(o)})}),t("setActive",function(t,r){var n=r.settings,i=n[s],o=n[a];i&&e(t).addClass(i),o&&e.each(r.parents,function(t,s){e(s).addClass(o)})})}(jQuery,document,window),function(e){"use strict";function t(t,s){return e(this).find(s.settings.stepSelector).first()}function s(t,s,a,r){if(!s)return!1;var n=a.settings.stepSelector;s=e(s);do{var i=s.near(n,r);if((0===i.length||0===i.closest(t).length)&&(i=e(t).find(n)[r?"last":"first"]()),!i.length)return!1;s=i}while(s.data("stepData").exclude);return s}var a=e.jmpress;a("initStep",function(e,t){t.stepData.exclude=t.data.exclude&&-1===["false","no"].indexOf(t.data.exclude)}),a("selectInitialStep",t),a("selectHome",t),a("selectEnd",function(t,s){return e(this).find(s.settings.stepSelector).last()}),a("selectPrev",function(e,t){return s(this,e,t,!0)}),a("selectNext",function(e,t){return s(this,e,t)})}(jQuery,document,window),function(e){"use strict";e.jmpress("selectInitialStep",function(e,t){return t.settings.start})}(jQuery,document,window),function(e){"use strict";function t(t,s,a){for(var r=0;s.length-1>r;r++){var n=s[r],i=s[r+1];e(t).jmpress("initialized")?e(n,t).data("stepData")[a]=i:e(n,t).attr("data-"+a,i)}}function s(t,s,a,r){var n=s.stepData;if(n[a]){var i=e(t).near(n[a],r);if(i&&i.length)return i;if(i=e(n[a],this)[r?"last":"first"](),i&&i.length)return i}}var a=e.jmpress;a("register","route",function(e,s,a){"string"==typeof e&&(e=[e,e]),t(this,e,a?"prev":"next"),s||t(this,e.reverse(),a?"next":"prev")}),a("initStep",function(e,t){for(var s in{next:1,prev:1})t.stepData[s]=t.data[s]}),a("selectNext",function(e,t){return s.call(this,e,t,"next")}),a("selectPrev",function(e,t){return s.call(this,e,t,"prev",!0)})}(jQuery,document,window),function(e){"use strict";var t=e.jmpress,s="ajax:afterStepLoaded",a="ajax:loadStep";t("register",a),t("register",s),t("defaults").ajaxLoadedClass="loaded",t("initStep",function(t,s){s.stepData.src=e(t).attr("href")||s.data.src||!1,s.stepData.srcLoaded=!1}),t(a,function(t,a){var r=a.stepData,n=r&&r.src,i=a.settings;n&&(e(t).addClass(i.ajaxLoadedClass),r.srcLoaded=!0,e(t).load(n,function(r,n,i){e(a.jmpress).jmpress("fire",s,t,e.extend({},a,{response:r,status:n,xhr:i}))}))}),t("idle",function(t,s){if(t){var r=s.settings,n=e(this);s.stepData;var i=e(t).add(e(t).near(r.stepSelector)).add(e(t).near(r.stepSelector,!0)).add(n.jmpress("fire","selectPrev",t,{stepData:e(t).data("stepData")})).add(n.jmpress("fire","selectNext",t,{stepData:e(t).data("stepData")}));i.each(function(){var t=this,s=e(t).data("stepData");s.src&&!s.srcLoaded&&n.jmpress("fire",a,t,{stepData:e(t).data("stepData")})})}}),t("setActive",function(t){var s=e(t).data("stepData");s.src&&!s.srcLoaded&&e(this).jmpress("fire",a,t,{stepData:e(t).data("stepData")})})}(jQuery,document,window),function(e,t,s,a){"use strict";function r(){return""+Math.round(1e5*Math.random(),0)}function n(t){try{var r=e("#"+s.location.hash.replace(/^#\/?/,""));return r.length>0&&r.is(t.stepSelector)?r:a}catch(n){}}function i(e){var t="#/"+e;s.history&&s.history.pushState?s.location.hash!==t&&s.history.pushState({},"",t):s.location.hash!==t&&(s.location.hash=t)}var o=e.jmpress,c="a[href^=#]";o("defaults").hash={use:!0,update:!0,bindChange:!0},o("selectInitialStep",function(t,o){var l=o.settings,u=l.hash,p=o.current,f=e(this);return o.current.hashNamespace=".jmpress-"+r(),u.use?(u.bindChange&&(e(s).bind("hashchange"+p.hashNamespace,function(e){var t=n(l);f.jmpress("initialized")&&f.jmpress("scrollFix"),t&&t.length&&(t.attr("id")!==f.jmpress("active").attr("id")&&f.jmpress("select",t),i(t.attr("id"))),e.preventDefault()}),e(c).on("click"+p.hashNamespace,function(t){var s=e(this).attr("href");try{e(s).is(l.stepSelector)&&(f.jmpress("select",s),t.preventDefault(),t.stopPropagation())}catch(a){}})),n(l)):a}),o("afterDeinit",function(t,a){e(c).off(a.current.hashNamespace),e(s).unbind(a.current.hashNamespace)}),o("setActive",function(t,s){var a=s.settings,r=s.current;a.hash.use&&a.hash.update&&(clearTimeout(r.hashtimeout),r.hashtimeout=setTimeout(function(){i(e(s.delegatedFrom).attr("id"))},a.transitionDuration+200))})}(jQuery,document,window),function(e,t,s,a){"use strict";function r(){return""+Math.round(1e5*Math.random(),0)}function n(e){e.preventDefault(),e.stopPropagation()}var i=e.jmpress,o="next",c="prev";i("defaults").keyboard={use:!0,keys:{33:c,37:c,38:c,9:o+":"+c,32:o,34:o,39:o,40:o,36:"home",35:"end"},ignore:{INPUT:[32,37,38,39,40],TEXTAREA:[32,37,38,39,40],SELECT:[38,40]},tabSelector:"a[href]:visible, :input:visible"},i("afterInit",function(s,i){var o=i.settings,c=o.keyboard,l=c.ignore,u=i.current,p=e(this);o.fullscreen||p.attr("tabindex",0),u.keyboardNamespace=".jmpress-"+r(),e(o.fullscreen?t:p).bind("keypress"+u.keyboardNamespace,function(e){for(var t in l)if(e.target.nodeName===t&&-1!==l[t].indexOf(e.which))return;(e.which>=37&&40>=e.which||32===e.which)&&n(e)}),e(o.fullscreen?t:p).bind("keydown"+u.keyboardNamespace,function(t){var s=e(t.target);if((o.fullscreen||s.closest(p).length)&&c.use){for(var r in l)if(s[0].nodeName===r&&-1!==l[r].indexOf(t.which))return;var i,u=!1;if(9===t.which){if(s.closest(p.jmpress("active")).length?(i=s.near(c.tabSelector,t.shiftKey),e(i).closest(o.stepSelector).is(p.jmpress("active"))||(i=a)):t.shiftKey?u=!0:i=p.jmpress("active").find("a[href], :input").filter(":visible").first(),i&&i.length>0)return i.focus(),p.jmpress("scrollFix"),n(t),a;t.shiftKey&&(u=!0)}var f=c.keys[t.which];"string"==typeof f?(-1!==f.indexOf(":")&&(f=f.split(":"),f=t.shiftKey?f[1]:f[0]),p.jmpress(f),n(t)):e.isFunction(f)?f.call(p,t):f&&(p.jmpress.apply(p,f),n(t)),u&&(i=p.jmpress("active").find("a[href], :input").filter(":visible").last(),i.focus(),p.jmpress("scrollFix"))}})}),i("afterDeinit",function(s,a){e(t).unbind(a.current.keyboardNamespace)})}(jQuery,document,window),function(e,t,s,a){"use strict";function r(){return""+Math.round(1e5*Math.random(),0)}function n(e,t){return Math.max(Math.min(e,t),-t)}function i(t,s,a){var r=e(this).jmpress("current"),i=e(this).jmpress("settings"),o=e(this).jmpress("active").data("stepData"),c=e(this).jmpress("container");if(!(0===r.userZoom&&0>a)){var l=o.viewPortZoomable||i.viewPort.zoomable;if(!(r.userZoom===l&&a>0)){r.userZoom+=a;var u=e(c).innerWidth()/2,p=e(c).innerHeight()/2;t=t?t-u:t,s=s?s-p:s,r.userTranslateX=n(r.userTranslateX-a*t/r.zoomOriginWindowScale/l,u*r.userZoom*r.userZoom/l),r.userTranslateY=n(r.userTranslateY-a*s/r.zoomOriginWindowScale/l,p*r.userZoom*r.userZoom/l),e(this).jmpress("reselect","zoom")}}}var o=function(){var e=navigator.userAgent.toLowerCase(),t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||0>e.indexOf("compatible")&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return t[1]||""}(),c=e.jmpress("defaults");c.viewPort={width:!1,height:!1,maxScale:0,minScale:0,zoomable:0,zoomBindMove:!0,zoomBindWheel:!0};var l=c.keyboard.keys;l["mozilla"===o?107:187]="zoomIn",l["mozilla"===o?109:189]="zoomOut",c.reasonableAnimation.resize={transitionDuration:"0s",transitionDelay:"0ms"},c.reasonableAnimation.zoom={transitionDuration:"0s",transitionDelay:"0ms"},e.jmpress("initStep",function(e,t){for(var s in{viewPortHeight:1,viewPortWidth:1,viewPortMinScale:1,viewPortMaxScale:1,viewPortZoomable:1})t.stepData[s]=t.data[s]&&parseFloat(t.data[s])}),e.jmpress("afterInit",function(n,i){var o=this;i.current.viewPortNamespace=".jmpress-"+r(),e(s).bind("resize"+i.current.viewPortNamespace,function(){e(o).jmpress("reselect","resize")}),i.current.userZoom=0,i.current.userTranslateX=0,i.current.userTranslateY=0,i.settings.viewPort.zoomBindWheel&&e(i.settings.fullscreen?t:this).bind("mousewheel"+i.current.viewPortNamespace+" DOMMouseScroll"+i.current.viewPortNamespace,function(t,s){s=s||t.originalEvent.wheelDelta||-t.originalEvent.detail;var a=s/Math.abs(s);return 0>a?e(i.jmpress).jmpress("zoomOut",t.originalEvent.x,t.originalEvent.y):a>0&&e(i.jmpress).jmpress("zoomIn",t.originalEvent.x,t.originalEvent.y),!1}),i.settings.viewPort.zoomBindMove&&e(i.settings.fullscreen?t:this).bind("mousedown"+i.current.viewPortNamespace,function(e){i.current.userZoom&&(i.current.userTranslating={x:e.clientX,y:e.clientY},e.preventDefault(),e.stopImmediatePropagation())}).bind("mousemove"+i.current.viewPortNamespace,function(t){var s=i.current.userTranslating;s&&(e(o).jmpress("zoomTranslate",t.clientX-s.x,t.clientY-s.y),s.x=t.clientX,s.y=t.clientY,t.preventDefault(),t.stopImmediatePropagation())}).bind("mouseup"+i.current.viewPortNamespace,function(e){i.current.userTranslating&&(i.current.userTranslating=a,e.preventDefault(),e.stopImmediatePropagation())})}),e.jmpress("register","zoomIn",function(e,t){i.call(this,e||0,t||0,1)}),e.jmpress("register","zoomOut",function(e,t){i.call(this,e||0,t||0,-1)}),e.jmpress("register","zoomTranslate",function(t,s){var a=e(this).jmpress("current"),r=e(this).jmpress("settings"),i=e(this).jmpress("active").data("stepData"),o=e(this).jmpress("container"),c=i.viewPortZoomable||r.viewPort.zoomable,l=e(o).innerWidth(),u=e(o).innerHeight();a.userTranslateX=n(a.userTranslateX+t/a.zoomOriginWindowScale,l*a.userZoom*a.userZoom/c),a.userTranslateY=n(a.userTranslateY+s/a.zoomOriginWindowScale,u*a.userZoom*a.userZoom/c),e(this).jmpress("reselect","zoom")}),e.jmpress("afterDeinit",function(a,r){e(r.settings.fullscreen?t:this).unbind(r.current.viewPortNamespace),e(s).unbind(r.current.viewPortNamespace)}),e.jmpress("setActive",function(t,s){var a=s.settings.viewPort,r=s.stepData.viewPortHeight||a.height,n=s.stepData.viewPortWidth||a.width,i=s.stepData.viewPortMaxScale||a.maxScale,o=s.stepData.viewPortMinScale||a.minScale,c=r&&e(s.container).innerHeight()/r,l=n&&e(s.container).innerWidth()/n,u=(l||c)&&Math.min(l||c,c||l);if(u){u=u||1,i&&(u=Math.min(u,i)),o&&(u=Math.max(u,o));var p=s.stepData.viewPortZoomable||s.settings.viewPort.zoomable;if(p){var f=1/u-1/i;f/=p,u=1/(1/u-f*s.current.userZoom)}s.target.transform.reverse(),s.current.userTranslateX&&s.current.userTranslateY?s.target.transform.push(["translate",s.current.userTranslateX,s.current.userTranslateY,0]):s.target.transform.push(["translate"]),s.target.transform.push(["scale",u,u,1]),s.target.transform.reverse(),s.target.perspectiveScale/=u}s.current.zoomOriginWindowScale=u}),e.jmpress("setInactive",function(t,s){s.nextStep&&t&&e(s.nextStep).attr("id")===e(t).attr("id")||(s.current.userZoom=0,s.current.userTranslateX=0,s.current.userTranslateY=0)})}(jQuery,document,window),function(e){"use strict";function t(){return""+Math.round(1e5*Math.random(),0)}var s=e.jmpress;s("defaults").mouse={clickSelects:!0},s("afterInit",function(s,a){var r=a.settings,n=r.stepSelector,i=a.current,o=e(this);i.clickableStepsNamespace=".jmpress-"+t(),o.bind("click"+i.clickableStepsNamespace,function(t){if(r.mouse.clickSelects&&!i.userZoom){var s=e(t.target).closest(n);s.is(o.jmpress("active"))||s.length&&(o.jmpress("select",s[0],"click"),t.preventDefault(),t.stopPropagation())}})}),s("afterDeinit",function(t,s){e(this).unbind(s.current.clickableStepsNamespace)})}(jQuery,document,window),function(e,t){"use strict";function s(){return""+Math.round(1e5*Math.random(),0)}var a=e.jmpress;a("afterInit",function(a,r){var n=r.settings,i=r.current,o=r.jmpress;i.mobileNamespace=".jmpress-"+s();var c,l=[0,0];e(n.fullscreen?t:o).bind("touchstart"+i.mobileNamespace,function(e){c=e.originalEvent.touches[0],l=[c.pageX,c.pageY]}).bind("touchmove"+i.mobileNamespace,function(e){return c=e.originalEvent.touches[0],e.preventDefault(),!1}).bind("touchend"+i.mobileNamespace,function(t){var s=[c.pageX,c.pageY],a=[s[0]-l[0],s[1]-l[1]];return Math.max(Math.abs(a[0]),Math.abs(a[1]))>50?(a=Math.abs(a[0])>Math.abs(a[1])?a[0]:a[1],e(o).jmpress(a>0?"prev":"next"),t.preventDefault(),!1):undefined})}),a("afterDeinit",function(s,a){var r=a.settings,n=a.current,i=a.jmpress;e(r.fullscreen?t:i).unbind(n.mobileNamespace)})}(jQuery,document,window),function(e,t,s,a){"use strict";function r(t,s,n){for(var i in s){var o=i;n&&(o=n+o.substr(0,1).toUpperCase()+o.substr(1)),e.isPlainObject(s[i])?r(t,s[i],o):t[o]===a&&(t[o]=s[i])}}function n(t,s){e.isArray(s)?s.length<t.length?e.error("more nested steps than children in template"):t.each(function(t,a){a=e(a);var n=a.data(l)||{};r(n,s[t]),a.data(l,n)}):e.isFunction(s)&&t.each(function(a,n){n=e(n);var i=n.data(l)||{};r(i,s(a,n,t)),n.data(l,i)})}function i(e,t,s,a){if(s.children){var r=t.children(a.settings.stepSelector);n(r,s.children)}o(e,s)}function o(e,t){r(e,t)}var c=e.jmpress,l="_template_",u="_applied_template_",p={};c("beforeInitStep",function(t,s){t=e(t);var a=s.data,r=a.template,n=t.data(u),o=t.data(l);r&&e.each(r.split(" "),function(e,r){var n=p[r];i(a,t,n,s)}),n&&i(a,t,n,s),o&&(i(a,t,o,s),t.data(l,null),o.template&&e.each(o.template.split(" "),function(e,r){var n=p[r];i(a,t,n,s)}))}),c("beforeInit",function(t,s){var a=c("dataset",this),r=a.template,i=s.settings.stepSelector;if(r){var o=p[r];n(e(this).find(i).filter(function(){return!e(this).parent().is(i)}),o.children)}}),c("register","template",function(t,s){p[t]=p[t]?e.extend(!0,{},p[t],s):e.extend(!0,{},s)}),c("register","apply",function(t,s){if(s)if(e.isArray(s))n(e(t),s);else{var a;a="string"==typeof s?p[s]:e.extend(!0,{},s),e(t).each(function(t,s){s=e(s);var n=s.data(u)||{};r(n,a),s.data(u,n)})}else{var i=e(this).jmpress("settings").stepSelector;n(e(this).find(i).filter(function(){return!e(this).parent().is(i)}),t)}})}(jQuery,document,window),function(e){"use strict";e.jmpress("setActive",function(t,s){s.prevStep!==t&&e(t).triggerHandler("enterStep")}),e.jmpress("setInactive",function(t,s){s.nextStep!==t&&e(t).triggerHandler("leaveStep")})}(jQuery,document,window),function(e,t,s,a){"use strict";function r(t){for(var s=t.split(" "),a=s[0],r={willClass:"will-"+a,doClass:"do-"+a,hasClass:"has-"+a},n="",i=1;s.length>i;i++){var o=s[i];switch(n){case"":"after"===o?n="after":e.warn("unknown keyword in '"+t+"'. '"+o+"' unknown.");break;case"after":if(o.match(/^[1-9][0-9]*m?s?/)){var c=parseFloat(o);-1!==o.indexOf("ms")?c*=1:-1!==o.indexOf("s")?c*=1e3:-1!==o.indexOf("m")&&(c*=6e4),r.delay=c}else r.after=Array.prototype.slice.call(s,i).join(" "),i=s.length}}return r}function n(t,s,a,r){r=r||t.length-1,a=a||0;for(var n=a;r+1>n;n++)if(e(t[n].element).is(s))return n}function i(t,s,a){e.each(s._on,function(e,s){t.push({substep:s.substep,delay:s.delay+a}),i(t,s.substep,s.delay+a)})}e.jmpress("defaults").customAnimationDataAttribute="jmpress",e.jmpress("afterInit",function(e,t){t.current.animationTimeouts=[],t.current.animationCleanupWaiting=[]}),e.jmpress("applyStep",function(t,s){function o(e,t){return t.substep._after?(u=t.substep._after,!1):a}var c={},l=[];if(e(t).find("[data-"+s.settings.customAnimationDataAttribute+"]").each(function(a,r){e(r).closest(s.settings.stepSelector).is(t)&&l.push({element:r})}),0!==l.length){e.each(l,function(t,a){a.info=r(e(a.element).data(s.settings.customAnimationDataAttribute)),e(a.element).addClass(a.info.willClass),a._on=[],a._after=null});var u={_after:a,_on:[],info:{}};if(e.each(l,function(e,t){var s=t.info.after;if(s)if("step"===s)s=u;else if("prev"===s)s=l[e-1];else{var r=n(l,s,0,e-1);r===a&&(r=n(l,s)),s=r===a||r===e?l[e-1]:l[r]}else s=l[e-1];if(s){if(!t.info.delay){if(!s._after)return s._after=t,a;s=s._after}s._on.push({substep:t,delay:t.info.delay||0})}}),u._after===a&&0===u._on.length){var p=n(l,s.stepData.startSubstep)||0;u._after=l[p]}var f=[];do{var d=[{substep:u,delay:0}];i(d,u,0),f.push(d),u=null,e.each(d,o)}while(u);c.list=f,e(t).data("substepsData",c)}}),e.jmpress("unapplyStep",function(t){var s=e(t).data("substepsData");s&&e.each(s.list,function(t,s){e.each(s,function(t,s){s.substep.info.willClass&&e(s.substep.element).removeClass(s.substep.info.willClass),s.substep.info.hasClass&&e(s.substep.element).removeClass(s.substep.info.hasClass),s.substep.info.doClass&&e(s.substep.element).removeClass(s.substep.info.doClass)})})}),e.jmpress("setActive",function(t,s){var r=e(t).data("substepsData");if(r){s.substep===a&&(s.substep="prev"===s.reason?r.list.length-1:0);var n=s.substep;e.each(s.current.animationTimeouts,function(e,t){clearTimeout(t)}),s.current.animationTimeouts=[],e.each(r.list,function(t,a){var r=n>t,i=n>=t;e.each(a,function(t,a){function n(){e(a.substep.element).addClass(a.substep.info.doClass)}a.substep.info.hasClass&&e(a.substep.element)[(r?"add":"remove")+"Class"](a.substep.info.hasClass),i&&!r&&a.delay&&"prev"!==s.reason?a.substep.info.doClass&&(e(a.substep.element).removeClass(a.substep.info.doClass),s.current.animationTimeouts.push(setTimeout(n,a.delay))):a.substep.info.doClass&&e(a.substep.element)[(i?"add":"remove")+"Class"](a.substep.info.doClass)})})}}),e.jmpress("setInactive",function(t,s){function a(t){e.each(t.list,function(t,s){e.each(s,function(t,s){s.substep.info.hasClass&&e(s.substep.element).removeClass(s.substep.info.hasClass),s.substep.info.doClass&&e(s.substep.element).removeClass(s.substep.info.doClass)})})}if(s.nextStep!==t){e.each(s.current.animationCleanupWaiting,function(e,t){a(t)}),s.current.animationCleanupWaiting=[];var r=e(t).data("substepsData");r&&s.current.animationCleanupWaiting.push(r)}}),e.jmpress("selectNext",function(t,s){if(s.substep!==a){var r=e(t).data("substepsData");if(r)return s.substep<r.list.length-1?{step:t,substep:s.substep+1}:a}}),e.jmpress("selectPrev",function(t,s){if(s.substep!==a){var r=e(t).data("substepsData");if(r)return s.substep>0?{step:t,substep:s.substep-1}:a}})}(jQuery,document,window),function(e,t){"use strict";e.jmpress("register","toggle",function(s,a,r){var n=this;e(t).bind("keydown",function(t){t.keyCode===s&&(e(n).jmpress("initialized")?e(n).jmpress("deinit"):e(n).jmpress(a))}),r&&e(n).jmpress(a)})}(jQuery,document,window),function(e){"use strict";function t(t,s,a){if(t.secondary&&-1!==t.secondary.split(" ").indexOf(s)){for(var r in t)if(r.length>9&&0===r.indexOf("secondary")){var n=t[r],i=r.substr(9);i=i.substr(0,1).toLowerCase()+i.substr(1),t[r]=t[i],t[i]=n}e(this).jmpress("reapply",e(a))}}e.jmpress("initStep",function(e,t){for(var s in t.data)0===s.indexOf("secondary")&&(t.stepData[s]=t.data[s])}),e.jmpress("beforeActive",function(s,a){t.call(a.jmpress,e(s).data("stepData"),"self",s);var r=e(s).parent();e(r).children(a.settings.stepSelector).each(function(s,r){var n=e(r).data("stepData");t.call(a.jmpress,n,"siblings",r)});for(var n=1;a.parents.length>n;n++)e(a.parents[n]).children(a.settings.stepSelector).each()}),e.jmpress("setInactive",function(s,a){function r(s,r){var n=e(r).data("stepData");t.call(a.jmpress,n,"grandchildren",r)}t.call(a.jmpress,e(s).data("stepData"),"self",s);var n=e(s).parent();e(n).children(a.settings.stepSelector).each(function(s,r){var n=e(r).data("stepData");t.call(a.jmpress,n,"siblings",r)});for(var i=1;a.parents.length>i;i++)e(a.parents[i]).children(a.settings.stepSelector).each(r)})}(jQuery,document,window),function(e,t,s,a){"use strict";e.jmpress("defaults").duration={defaultValue:-1,defaultAction:"next",barSelector:a,barProperty:"width",barPropertyStart:"0",barPropertyEnd:"100%"},e.jmpress("initStep",function(e,t){t.stepData.duration=t.data.duration&&parseInt(t.data.duration,10),t.stepData.durationAction=t.data.durationAction}),e.jmpress("setInactive",function(t,s){var a=s.settings,r=a.duration,n=s.current;if(s.stepData.duration||r.defaultValue,n.durationTimeout){if(r.barSelector){var i={transitionProperty:r.barProperty,transitionDuration:"0",transitionDelay:"0",transitionTimingFunction:"linear"};i[r.barProperty]=r.barPropertyStart;var o=e(r.barSelector);e.jmpress("css",o,i),o.each(function(t,s){var a=e(s).next(),r=e(s).parent();e(s).detach(),a.length?a.insertBefore(s):r.append(s)})}clearTimeout(n.durationTimeout),delete n.durationTimeout}}),e.jmpress("setActive",function(t,s){var r=s.settings,n=r.duration,i=s.current,o=s.stepData.duration||n.defaultValue;if(o&&o>0){if(n.barSelector){var c={transitionProperty:n.barProperty,transitionDuration:o-2*r.transitionDuration/3-100+"ms",transitionDelay:2*r.transitionDuration/3+"ms",transitionTimingFunction:"linear"};c[n.barProperty]=n.barPropertyEnd,e.jmpress("css",e(n.barSelector),c)}var l=this;i.durationTimeout&&(clearTimeout(i.durationTimeout),i.durationTimeout=a),i.durationTimeout=setTimeout(function(){var t=s.stepData.durationAction||n.defaultAction;e(l).jmpress(t)},o)}})}(jQuery,document,window),function(e,t,s){"use strict";var a=e.jmpress,r="jmpress-presentation-";a("defaults").presentationMode={use:!0,url:"presentation-screen.html",notesUrl:!1,transferredValues:["userZoom","userTranslateX","userTranslateY"]},a("defaults").keyboard.keys[80]="presentationPopup",a("afterInit",function(t,a){var n=a.current;if(n.selectMessageListeners=[],a.settings.presentationMode.use){s.addEventListener("message",function(t){try{if("string"!=typeof t.data||0!==t.data.indexOf(r))return;var i=JSON.parse(t.data.slice(r.length));switch(i.type){case"select":e.each(a.settings.presentationMode.transferredValues,function(e,t){a.current[t]=i[t]}),/[a-z0-9\-]+/i.test(i.targetId)&&typeof i.substep in{number:1,undefined:1}?e(a.jmpress).jmpress("select",{step:"#"+i.targetId,substep:i.substep},i.reason):e.error("For security reasons the targetId must match /[a-z0-9\\-]+/i and substep must be a number.");break;case"listen":n.selectMessageListeners.push(t.source);break;case"ok":clearTimeout(n.presentationPopupTimeout);break;case"read":try{t.source.postMessage(r+JSON.stringify({type:"url",url:s.location.href,notesUrl:a.settings.presentationMode.notesUrl}),"*")}catch(o){e.error("Cannot post message to source: "+o)}break;default:throw"Unknown message type: "+i.type}}catch(o){e.error("Received message is malformed: "+o)}});try{s.parent&&s.parent!==s&&s.parent.postMessage(r+JSON.stringify({type:"afterInit"}),"*")}catch(i){e.error("Cannot post message to parent: "+i)}}}),a("afterDeinit",function(t,a){if(a.settings.presentationMode.use)try{s.parent&&s.parent!==s&&s.parent.postMessage(r+JSON.stringify({type:"afterDeinit"}),"*")}catch(n){e.error("Cannot post message to parent: "+n)}}),a("setActive",function(t,s){var a=e(s.delegatedFrom).attr("id"),n=s.substep,i=s.reason;e.each(s.current.selectMessageListeners,function(t,o){try{var c={type:"select",targetId:a,substep:n,reason:i};e.each(s.settings.presentationMode.transferredValues,function(e,t){c[t]=s.current[t]}),o.postMessage(r+JSON.stringify(c),"*")}catch(l){e.error("Cannot post message to listener: "+l)}})}),a("register","presentationPopup",function(){function t(){n.jmpress("current").presentationPopupTimeout=setTimeout(t,100);try{a.postMessage(r+JSON.stringify({type:"url",url:s.location.href,notesUrl:n.jmpress("settings").presentationMode.notesUrl}),"*")}catch(e){}}var a,n=e(this);n.jmpress("settings").presentationMode.use&&(a=s.open(e(this).jmpress("settings").presentationMode.url),n.jmpress("current").presentationPopupTimeout=setTimeout(t,100))})}(jQuery,document,window);

} /* end modules/shortcodes/js/jmpress.min.js */

if ( jpconcat.files['modules/shortcodes/js/jquery.cycle.js'] ) {

/*!
 * jQuery Cycle Plugin (with Transition Definitions)
 * Examples and documentation at: http://jquery.malsup.com/cycle/
 * Copyright (c) 2007-2010 M. Alsup
 * Version: 2.9999.8 (26-OCT-2012)
 * Dual licensed under the MIT and GPL licenses.
 * http://jquery.malsup.com/license.html
 * Requires: jQuery v1.3.2 or later
 */;(function($,undefined){"use strict";var ver='2.9999.8';if($.support===undefined){$.support={opacity:!($.browser.msie)};}
function debug(s){if($.fn.cycle.debug)
log(s);}
function log(){if(window.console&&console.log)
console.log('[cycle] '+Array.prototype.join.call(arguments,' '));}
$.expr[':'].paused=function(el){return el.cyclePause;};$.fn.cycle=function(options,arg2){var o={s:this.selector,c:this.context};if(this.length===0&&options!='stop'){if(!$.isReady&&o.s){log('DOM not ready, queuing slideshow');$(function(){$(o.s,o.c).cycle(options,arg2);});return this;}
log('terminating; zero elements found by selector'+($.isReady?'':' (DOM not ready)'));return this;}
return this.each(function(){var opts=handleArguments(this,options,arg2);if(opts===false)
return;opts.updateActivePagerLink=opts.updateActivePagerLink||$.fn.cycle.updateActivePagerLink;if(this.cycleTimeout)
clearTimeout(this.cycleTimeout);this.cycleTimeout=this.cyclePause=0;this.cycleStop=0;var $cont=$(this);var $slides=opts.slideExpr?$(opts.slideExpr,this):$cont.children();var els=$slides.get();if(els.length<2){log('terminating; too few slides: '+els.length);return;}
var opts2=buildOptions($cont,$slides,els,opts,o);if(opts2===false)
return;var startTime=opts2.continuous?10:getTimeout(els[opts2.currSlide],els[opts2.nextSlide],opts2,!opts2.backwards);if(startTime){startTime+=(opts2.delay||0);if(startTime<10)
startTime=10;debug('first timeout: '+startTime);this.cycleTimeout=setTimeout(function(){go(els,opts2,0,!opts.backwards);},startTime);}});};function triggerPause(cont,byHover,onPager){var opts=$(cont).data('cycle.opts');if(!opts)
return;var paused=!!cont.cyclePause;if(paused&&opts.paused)
opts.paused(cont,opts,byHover,onPager);else if(!paused&&opts.resumed)
opts.resumed(cont,opts,byHover,onPager);}
function handleArguments(cont,options,arg2){if(cont.cycleStop===undefined)
cont.cycleStop=0;if(options===undefined||options===null)
options={};if(options.constructor==String){switch(options){case'destroy':case'stop':var opts=$(cont).data('cycle.opts');if(!opts)
return false;cont.cycleStop++;if(cont.cycleTimeout)
clearTimeout(cont.cycleTimeout);cont.cycleTimeout=0;if(opts.elements)
$(opts.elements).stop();$(cont).removeData('cycle.opts');if(options=='destroy')
destroy(cont,opts);return false;case'toggle':cont.cyclePause=(cont.cyclePause===1)?0:1;checkInstantResume(cont.cyclePause,arg2,cont);triggerPause(cont);return false;case'pause':cont.cyclePause=1;triggerPause(cont);return false;case'resume':cont.cyclePause=0;checkInstantResume(false,arg2,cont);triggerPause(cont);return false;case'prev':case'next':opts=$(cont).data('cycle.opts');if(!opts){log('options not found, "prev/next" ignored');return false;}
$.fn.cycle[options](opts);return false;default:options={fx:options};}
return options;}
else if(options.constructor==Number){var num=options;options=$(cont).data('cycle.opts');if(!options){log('options not found, can not advance slide');return false;}
if(num<0||num>=options.elements.length){log('invalid slide index: '+num);return false;}
options.nextSlide=num;if(cont.cycleTimeout){clearTimeout(cont.cycleTimeout);cont.cycleTimeout=0;}
if(typeof arg2=='string')
options.oneTimeFx=arg2;go(options.elements,options,1,num>=options.currSlide);return false;}
return options;function checkInstantResume(isPaused,arg2,cont){if(!isPaused&&arg2===true){var options=$(cont).data('cycle.opts');if(!options){log('options not found, can not resume');return false;}
if(cont.cycleTimeout){clearTimeout(cont.cycleTimeout);cont.cycleTimeout=0;}
go(options.elements,options,1,!options.backwards);}}}
function removeFilter(el,opts){if(!$.support.opacity&&opts.cleartype&&el.style.filter){try{el.style.removeAttribute('filter');}
catch(smother){}}}
function destroy(cont,opts){if(opts.next)
$(opts.next).unbind(opts.prevNextEvent);if(opts.prev)
$(opts.prev).unbind(opts.prevNextEvent);if(opts.pager||opts.pagerAnchorBuilder)
$.each(opts.pagerAnchors||[],function(){this.unbind().remove();});opts.pagerAnchors=null;$(cont).unbind('mouseenter.cycle mouseleave.cycle');if(opts.destroy)
opts.destroy(opts);}
function buildOptions($cont,$slides,els,options,o){var startingSlideSpecified;var opts=$.extend({},$.fn.cycle.defaults,options||{},$.metadata?$cont.metadata():$.meta?$cont.data():{});var meta=$.isFunction($cont.data)?$cont.data(opts.metaAttr):null;if(meta)
opts=$.extend(opts,meta);if(opts.autostop)
opts.countdown=opts.autostopCount||els.length;var cont=$cont[0];$cont.data('cycle.opts',opts);opts.$cont=$cont;opts.stopCount=cont.cycleStop;opts.elements=els;opts.before=opts.before?[opts.before]:[];opts.after=opts.after?[opts.after]:[];if(!$.support.opacity&&opts.cleartype)
opts.after.push(function(){removeFilter(this,opts);});if(opts.continuous)
opts.after.push(function(){go(els,opts,0,!opts.backwards);});saveOriginalOpts(opts);if(!$.support.opacity&&opts.cleartype&&!opts.cleartypeNoBg)
clearTypeFix($slides);if($cont.css('position')=='static')
$cont.css('position','relative');if(opts.width)
$cont.width(opts.width);if(opts.height&&opts.height!='auto')
$cont.height(opts.height);if(opts.startingSlide!==undefined){opts.startingSlide=parseInt(opts.startingSlide,10);if(opts.startingSlide>=els.length||opts.startSlide<0)
opts.startingSlide=0;else
startingSlideSpecified=true;}
else if(opts.backwards)
opts.startingSlide=els.length-1;else
opts.startingSlide=0;if(opts.random){opts.randomMap=[];for(var i=0;i<els.length;i++)
opts.randomMap.push(i);opts.randomMap.sort(function(a,b){return Math.random()-0.5;});if(startingSlideSpecified){for(var cnt=0;cnt<els.length;cnt++){if(opts.startingSlide==opts.randomMap[cnt]){opts.randomIndex=cnt;}}}
else{opts.randomIndex=1;opts.startingSlide=opts.randomMap[1];}}
else if(opts.startingSlide>=els.length)
opts.startingSlide=0;opts.currSlide=opts.startingSlide||0;var first=opts.startingSlide;$slides.css({position:'absolute',top:0,left:0}).hide().each(function(i){var z;if(opts.backwards)
z=first?i<=first?els.length+(i-first):first-i:els.length-i;else
z=first?i>=first?els.length-(i-first):first-i:els.length-i;$(this).css('z-index',z);});$(els[first]).css('opacity',1).show();removeFilter(els[first],opts);if(opts.fit){if(!opts.aspect){if(opts.width)
$slides.width(opts.width);if(opts.height&&opts.height!='auto')
$slides.height(opts.height);}else{$slides.each(function(){var $slide=$(this);var ratio=(opts.aspect===true)?$slide.width()/$slide.height():opts.aspect;if(opts.width&&$slide.width()!=opts.width){$slide.width(opts.width);$slide.height(opts.width / ratio);}
if(opts.height&&$slide.height()<opts.height){$slide.height(opts.height);$slide.width(opts.height*ratio);}});}}
if(opts.center&&((!opts.fit)||opts.aspect)){$slides.each(function(){var $slide=$(this);$slide.css({"margin-left":opts.width?((opts.width-$slide.width())/ 2)+"px":0,"margin-top":opts.height?((opts.height-$slide.height())/ 2)+"px":0});});}
if(opts.center&&!opts.fit&&!opts.slideResize){$slides.each(function(){var $slide=$(this);$slide.css({"margin-left":opts.width?((opts.width-$slide.width())/ 2)+"px":0,"margin-top":opts.height?((opts.height-$slide.height())/ 2)+"px":0});});}
var reshape=(opts.containerResize||opts.containerResizeHeight)&&!$cont.innerHeight();if(reshape){var maxw=0,maxh=0;for(var j=0;j<els.length;j++){var $e=$(els[j]),e=$e[0],w=$e.outerWidth(),h=$e.outerHeight();if(!w)w=e.offsetWidth||e.width||$e.attr('width');if(!h)h=e.offsetHeight||e.height||$e.attr('height');maxw=w>maxw?w:maxw;maxh=h>maxh?h:maxh;}
if(opts.containerResize&&maxw>0&&maxh>0)
$cont.css({width:maxw+'px',height:maxh+'px'});if(opts.containerResizeHeight&&maxh>0)
$cont.css({height:maxh+'px'});}
var pauseFlag=false;if(opts.pause)
$cont.bind('mouseenter.cycle',function(){pauseFlag=true;this.cyclePause++;triggerPause(cont,true);}).bind('mouseleave.cycle',function(){if(pauseFlag)
this.cyclePause--;triggerPause(cont,true);});if(supportMultiTransitions(opts)===false)
return false;var requeue=false;options.requeueAttempts=options.requeueAttempts||0;$slides.each(function(){var $el=$(this);this.cycleH=(opts.fit&&opts.height)?opts.height:($el.height()||this.offsetHeight||this.height||$el.attr('height')||0);this.cycleW=(opts.fit&&opts.width)?opts.width:($el.width()||this.offsetWidth||this.width||$el.attr('width')||0);if($el.is('img')){var loadingIE=($.browser.msie&&this.cycleW==28&&this.cycleH==30&&!this.complete);var loadingFF=($.browser.mozilla&&this.cycleW==34&&this.cycleH==19&&!this.complete);var loadingOp=($.browser.opera&&((this.cycleW==42&&this.cycleH==19)||(this.cycleW==37&&this.cycleH==17))&&!this.complete);var loadingOther=(this.cycleH===0&&this.cycleW===0&&!this.complete);if(loadingIE||loadingFF||loadingOp||loadingOther){if(o.s&&opts.requeueOnImageNotLoaded&&++options.requeueAttempts<100){log(options.requeueAttempts,' - img slide not loaded, requeuing slideshow: ',this.src,this.cycleW,this.cycleH);setTimeout(function(){$(o.s,o.c).cycle(options);},opts.requeueTimeout);requeue=true;return false;}
else{log('could not determine size of image: '+this.src,this.cycleW,this.cycleH);}}}
return true;});if(requeue)
return false;opts.cssBefore=opts.cssBefore||{};opts.cssAfter=opts.cssAfter||{};opts.cssFirst=opts.cssFirst||{};opts.animIn=opts.animIn||{};opts.animOut=opts.animOut||{};$slides.not(':eq('+first+')').css(opts.cssBefore);$($slides[first]).css(opts.cssFirst);if(opts.timeout){opts.timeout=parseInt(opts.timeout,10);if(opts.speed.constructor==String)
opts.speed=$.fx.speeds[opts.speed]||parseInt(opts.speed,10);if(!opts.sync)
opts.speed=opts.speed / 2;var buffer=opts.fx=='none'?0:opts.fx=='shuffle'?500:250;while((opts.timeout-opts.speed)<buffer)
opts.timeout+=opts.speed;}
if(opts.easing)
opts.easeIn=opts.easeOut=opts.easing;if(!opts.speedIn)
opts.speedIn=opts.speed;if(!opts.speedOut)
opts.speedOut=opts.speed;opts.slideCount=els.length;opts.currSlide=opts.lastSlide=first;if(opts.random){if(++opts.randomIndex==els.length)
opts.randomIndex=0;opts.nextSlide=opts.randomMap[opts.randomIndex];}
else if(opts.backwards)
opts.nextSlide=opts.startingSlide===0?(els.length-1):opts.startingSlide-1;else
opts.nextSlide=opts.startingSlide>=(els.length-1)?0:opts.startingSlide+1;if(!opts.multiFx){var init=$.fn.cycle.transitions[opts.fx];if($.isFunction(init))
init($cont,$slides,opts);else if(opts.fx!='custom'&&!opts.multiFx){log('unknown transition: '+opts.fx,'; slideshow terminating');return false;}}
var e0=$slides[first];if(!opts.skipInitializationCallbacks){if(opts.before.length)
opts.before[0].apply(e0,[e0,e0,opts,true]);if(opts.after.length)
opts.after[0].apply(e0,[e0,e0,opts,true]);}
if(opts.next)
$(opts.next).bind(opts.prevNextEvent,function(){return advance(opts,1);});if(opts.prev)
$(opts.prev).bind(opts.prevNextEvent,function(){return advance(opts,0);});if(opts.pager||opts.pagerAnchorBuilder)
buildPager(els,opts);exposeAddSlide(opts,els);return opts;}
function saveOriginalOpts(opts){opts.original={before:[],after:[]};opts.original.cssBefore=$.extend({},opts.cssBefore);opts.original.cssAfter=$.extend({},opts.cssAfter);opts.original.animIn=$.extend({},opts.animIn);opts.original.animOut=$.extend({},opts.animOut);$.each(opts.before,function(){opts.original.before.push(this);});$.each(opts.after,function(){opts.original.after.push(this);});}
function supportMultiTransitions(opts){var i,tx,txs=$.fn.cycle.transitions;if(opts.fx.indexOf(',')>0){opts.multiFx=true;opts.fxs=opts.fx.replace(/\s*/g,'').split(',');for(i=0;i<opts.fxs.length;i++){var fx=opts.fxs[i];tx=txs[fx];if(!tx||!txs.hasOwnProperty(fx)||!$.isFunction(tx)){log('discarding unknown transition: ',fx);opts.fxs.splice(i,1);i--;}}
if(!opts.fxs.length){log('No valid transitions named; slideshow terminating.');return false;}}
else if(opts.fx=='all'){opts.multiFx=true;opts.fxs=[];for(var p in txs){if(txs.hasOwnProperty(p)){tx=txs[p];if(txs.hasOwnProperty(p)&&$.isFunction(tx))
opts.fxs.push(p);}}}
if(opts.multiFx&&opts.randomizeEffects){var r1=Math.floor(Math.random()*20)+30;for(i=0;i<r1;i++){var r2=Math.floor(Math.random()*opts.fxs.length);opts.fxs.push(opts.fxs.splice(r2,1)[0]);}
debug('randomized fx sequence: ',opts.fxs);}
return true;}
function exposeAddSlide(opts,els){opts.addSlide=function(newSlide,prepend){var $s=$(newSlide),s=$s[0];if(!opts.autostopCount)
opts.countdown++;els[prepend?'unshift':'push'](s);if(opts.els)
opts.els[prepend?'unshift':'push'](s);opts.slideCount=els.length;if(opts.random){opts.randomMap.push(opts.slideCount-1);opts.randomMap.sort(function(a,b){return Math.random()-0.5;});}
$s.css('position','absolute');$s[prepend?'prependTo':'appendTo'](opts.$cont);if(prepend){opts.currSlide++;opts.nextSlide++;}
if(!$.support.opacity&&opts.cleartype&&!opts.cleartypeNoBg)
clearTypeFix($s);if(opts.fit&&opts.width)
$s.width(opts.width);if(opts.fit&&opts.height&&opts.height!='auto')
$s.height(opts.height);s.cycleH=(opts.fit&&opts.height)?opts.height:$s.height();s.cycleW=(opts.fit&&opts.width)?opts.width:$s.width();$s.css(opts.cssBefore);if(opts.pager||opts.pagerAnchorBuilder)
$.fn.cycle.createPagerAnchor(els.length-1,s,$(opts.pager),els,opts);if($.isFunction(opts.onAddSlide))
opts.onAddSlide($s);else
$s.hide();};}
$.fn.cycle.resetState=function(opts,fx){fx=fx||opts.fx;opts.before=[];opts.after=[];opts.cssBefore=$.extend({},opts.original.cssBefore);opts.cssAfter=$.extend({},opts.original.cssAfter);opts.animIn=$.extend({},opts.original.animIn);opts.animOut=$.extend({},opts.original.animOut);opts.fxFn=null;$.each(opts.original.before,function(){opts.before.push(this);});$.each(opts.original.after,function(){opts.after.push(this);});var init=$.fn.cycle.transitions[fx];if($.isFunction(init))
init(opts.$cont,$(opts.elements),opts);};function go(els,opts,manual,fwd){var p=opts.$cont[0],curr=els[opts.currSlide],next=els[opts.nextSlide];if(manual&&opts.busy&&opts.manualTrump){debug('manualTrump in go(), stopping active transition');$(els).stop(true,true);opts.busy=0;clearTimeout(p.cycleTimeout);}
if(opts.busy){debug('transition active, ignoring new tx request');return;}
if(p.cycleStop!=opts.stopCount||p.cycleTimeout===0&&!manual)
return;if(!manual&&!p.cyclePause&&!opts.bounce&&((opts.autostop&&(--opts.countdown<=0))||(opts.nowrap&&!opts.random&&opts.nextSlide<opts.currSlide))){if(opts.end)
opts.end(opts);return;}
var changed=false;if((manual||!p.cyclePause)&&(opts.nextSlide!=opts.currSlide)){changed=true;var fx=opts.fx;curr.cycleH=curr.cycleH||$(curr).height();curr.cycleW=curr.cycleW||$(curr).width();next.cycleH=next.cycleH||$(next).height();next.cycleW=next.cycleW||$(next).width();if(opts.multiFx){if(fwd&&(opts.lastFx===undefined||++opts.lastFx>=opts.fxs.length))
opts.lastFx=0;else if(!fwd&&(opts.lastFx===undefined||--opts.lastFx<0))
opts.lastFx=opts.fxs.length-1;fx=opts.fxs[opts.lastFx];}
if(opts.oneTimeFx){fx=opts.oneTimeFx;opts.oneTimeFx=null;}
$.fn.cycle.resetState(opts,fx);if(opts.before.length)
$.each(opts.before,function(i,o){if(p.cycleStop!=opts.stopCount)return;o.apply(next,[curr,next,opts,fwd]);});var after=function(){opts.busy=0;$.each(opts.after,function(i,o){if(p.cycleStop!=opts.stopCount)return;o.apply(next,[curr,next,opts,fwd]);});if(!p.cycleStop){queueNext();}};debug('tx firing('+fx+'); currSlide: '+opts.currSlide+'; nextSlide: '+opts.nextSlide);opts.busy=1;if(opts.fxFn)
opts.fxFn(curr,next,opts,after,fwd,manual&&opts.fastOnEvent);else if($.isFunction($.fn.cycle[opts.fx]))
$.fn.cycle[opts.fx](curr,next,opts,after,fwd,manual&&opts.fastOnEvent);else
$.fn.cycle.custom(curr,next,opts,after,fwd,manual&&opts.fastOnEvent);}
else{queueNext();}
if(changed||opts.nextSlide==opts.currSlide){var roll;opts.lastSlide=opts.currSlide;if(opts.random){opts.currSlide=opts.nextSlide;if(++opts.randomIndex==els.length){opts.randomIndex=0;opts.randomMap.sort(function(a,b){return Math.random()-0.5;});}
opts.nextSlide=opts.randomMap[opts.randomIndex];if(opts.nextSlide==opts.currSlide)
opts.nextSlide=(opts.currSlide==opts.slideCount-1)?0:opts.currSlide+1;}
else if(opts.backwards){roll=(opts.nextSlide-1)<0;if(roll&&opts.bounce){opts.backwards=!opts.backwards;opts.nextSlide=1;opts.currSlide=0;}
else{opts.nextSlide=roll?(els.length-1):opts.nextSlide-1;opts.currSlide=roll?0:opts.nextSlide+1;}}
else{roll=(opts.nextSlide+1)==els.length;if(roll&&opts.bounce){opts.backwards=!opts.backwards;opts.nextSlide=els.length-2;opts.currSlide=els.length-1;}
else{opts.nextSlide=roll?0:opts.nextSlide+1;opts.currSlide=roll?els.length-1:opts.nextSlide-1;}}}
if(changed&&opts.pager)
opts.updateActivePagerLink(opts.pager,opts.currSlide,opts.activePagerClass);function queueNext(){var ms=0,timeout=opts.timeout;if(opts.timeout&&!opts.continuous){ms=getTimeout(els[opts.currSlide],els[opts.nextSlide],opts,fwd);if(opts.fx=='shuffle')
ms-=opts.speedOut;}
else if(opts.continuous&&p.cyclePause)
ms=10;if(ms>0)
p.cycleTimeout=setTimeout(function(){go(els,opts,0,!opts.backwards);},ms);}}
$.fn.cycle.updateActivePagerLink=function(pager,currSlide,clsName){$(pager).each(function(){$(this).children().removeClass(clsName).eq(currSlide).addClass(clsName);});};function getTimeout(curr,next,opts,fwd){if(opts.timeoutFn){var t=opts.timeoutFn.call(curr,curr,next,opts,fwd);while(opts.fx!='none'&&(t-opts.speed)<250)
t+=opts.speed;debug('calculated timeout: '+t+'; speed: '+opts.speed);if(t!==false)
return t;}
return opts.timeout;}
$.fn.cycle.next=function(opts){advance(opts,1);};$.fn.cycle.prev=function(opts){advance(opts,0);};function advance(opts,moveForward){var val=moveForward?1:-1;var els=opts.elements;var p=opts.$cont[0],timeout=p.cycleTimeout;if(timeout){clearTimeout(timeout);p.cycleTimeout=0;}
if(opts.random&&val<0){opts.randomIndex--;if(--opts.randomIndex==-2)
opts.randomIndex=els.length-2;else if(opts.randomIndex==-1)
opts.randomIndex=els.length-1;opts.nextSlide=opts.randomMap[opts.randomIndex];}
else if(opts.random){opts.nextSlide=opts.randomMap[opts.randomIndex];}
else{opts.nextSlide=opts.currSlide+val;if(opts.nextSlide<0){if(opts.nowrap)return false;opts.nextSlide=els.length-1;}
else if(opts.nextSlide>=els.length){if(opts.nowrap)return false;opts.nextSlide=0;}}
var cb=opts.onPrevNextEvent||opts.prevNextClick;if($.isFunction(cb))
cb(val>0,opts.nextSlide,els[opts.nextSlide]);go(els,opts,1,moveForward);return false;}
function buildPager(els,opts){var $p=$(opts.pager);$.each(els,function(i,o){$.fn.cycle.createPagerAnchor(i,o,$p,els,opts);});opts.updateActivePagerLink(opts.pager,opts.startingSlide,opts.activePagerClass);}
$.fn.cycle.createPagerAnchor=function(i,el,$p,els,opts){var a;if($.isFunction(opts.pagerAnchorBuilder)){a=opts.pagerAnchorBuilder(i,el);debug('pagerAnchorBuilder('+i+', el) returned: '+a);}
else
a='<a href="#">'+(i+1)+'</a>';if(!a)
return;var $a=$(a);if($a.parents('body').length===0){var arr=[];if($p.length>1){$p.each(function(){var $clone=$a.clone(true);$(this).append($clone);arr.push($clone[0]);});$a=$(arr);}
else{$a.appendTo($p);}}
opts.pagerAnchors=opts.pagerAnchors||[];opts.pagerAnchors.push($a);var pagerFn=function(e){e.preventDefault();opts.nextSlide=i;var p=opts.$cont[0],timeout=p.cycleTimeout;if(timeout){clearTimeout(timeout);p.cycleTimeout=0;}
var cb=opts.onPagerEvent||opts.pagerClick;if($.isFunction(cb))
cb(opts.nextSlide,els[opts.nextSlide]);go(els,opts,1,opts.currSlide<i);};if(/mouseenter|mouseover/i.test(opts.pagerEvent)){$a.hover(pagerFn,function(){});}
else{$a.bind(opts.pagerEvent,pagerFn);}
if(!/^click/.test(opts.pagerEvent)&&!opts.allowPagerClickBubble)
$a.bind('click.cycle',function(){return false;});var cont=opts.$cont[0];var pauseFlag=false;if(opts.pauseOnPagerHover){$a.hover(function(){pauseFlag=true;cont.cyclePause++;triggerPause(cont,true,true);},function(){if(pauseFlag)
cont.cyclePause--;triggerPause(cont,true,true);});}};$.fn.cycle.hopsFromLast=function(opts,fwd){var hops,l=opts.lastSlide,c=opts.currSlide;if(fwd)
hops=c>l?c-l:opts.slideCount-l;else
hops=c<l?l-c:l+opts.slideCount-c;return hops;};function clearTypeFix($slides){debug('applying clearType background-color hack');function hex(s){s=parseInt(s,10).toString(16);return s.length<2?'0'+s:s;}
function getBg(e){for(;e&&e.nodeName.toLowerCase()!='html';e=e.parentNode){var v=$.css(e,'background-color');if(v&&v.indexOf('rgb')>=0){var rgb=v.match(/\d+/g);return'#'+hex(rgb[0])+hex(rgb[1])+hex(rgb[2]);}
if(v&&v!='transparent')
return v;}
return'#ffffff';}
$slides.each(function(){$(this).css('background-color',getBg(this));});}
$.fn.cycle.commonReset=function(curr,next,opts,w,h,rev){$(opts.elements).not(curr).hide();if(typeof opts.cssBefore.opacity=='undefined')
opts.cssBefore.opacity=1;opts.cssBefore.display='block';if(opts.slideResize&&w!==false&&next.cycleW>0)
opts.cssBefore.width=next.cycleW;if(opts.slideResize&&h!==false&&next.cycleH>0)
opts.cssBefore.height=next.cycleH;opts.cssAfter=opts.cssAfter||{};opts.cssAfter.display='none';$(curr).css('zIndex',opts.slideCount+(rev===true?1:0));$(next).css('zIndex',opts.slideCount+(rev===true?0:1));};$.fn.cycle.custom=function(curr,next,opts,cb,fwd,speedOverride){var $l=$(curr),$n=$(next);var speedIn=opts.speedIn,speedOut=opts.speedOut,easeIn=opts.easeIn,easeOut=opts.easeOut;$n.css(opts.cssBefore);if(speedOverride){if(typeof speedOverride=='number')
speedIn=speedOut=speedOverride;else
speedIn=speedOut=1;easeIn=easeOut=null;}
var fn=function(){$n.animate(opts.animIn,speedIn,easeIn,function(){cb();});};$l.animate(opts.animOut,speedOut,easeOut,function(){$l.css(opts.cssAfter);if(!opts.sync)
fn();});if(opts.sync)fn();};$.fn.cycle.transitions={fade:function($cont,$slides,opts){$slides.not(':eq('+opts.currSlide+')').css('opacity',0);opts.before.push(function(curr,next,opts){$.fn.cycle.commonReset(curr,next,opts);opts.cssBefore.opacity=0;});opts.animIn={opacity:1};opts.animOut={opacity:0};opts.cssBefore={top:0,left:0};}};$.fn.cycle.ver=function(){return ver;};$.fn.cycle.defaults={activePagerClass:'activeSlide',after:null,allowPagerClickBubble:false,animIn:null,animOut:null,aspect:false,autostop:0,autostopCount:0,backwards:false,before:null,center:null,cleartype:!$.support.opacity,cleartypeNoBg:false,containerResize:1,containerResizeHeight:0,continuous:0,cssAfter:null,cssBefore:null,delay:0,easeIn:null,easeOut:null,easing:null,end:null,fastOnEvent:0,fit:0,fx:'fade',fxFn:null,height:'auto',manualTrump:true,metaAttr:'cycle',next:null,nowrap:0,onPagerEvent:null,onPrevNextEvent:null,pager:null,pagerAnchorBuilder:null,pagerEvent:'click.cycle',pause:0,pauseOnPagerHover:0,prev:null,prevNextEvent:'click.cycle',random:0,randomizeEffects:1,requeueOnImageNotLoaded:true,requeueTimeout:250,rev:0,shuffle:null,skipInitializationCallbacks:false,slideExpr:null,slideResize:1,speed:1000,speedIn:null,speedOut:null,startingSlide:undefined,sync:1,timeout:4000,timeoutFn:null,updateActivePagerLink:null,width:null};})(jQuery);
/*!
 * jQuery Cycle Plugin Transition Definitions
 * This script is a plugin for the jQuery Cycle Plugin
 * Examples and documentation at: http://malsup.com/jquery/cycle/
 * Copyright (c) 2007-2010 M. Alsup
 * Version:	 2.73
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html
 */
(function($){"use strict";$.fn.cycle.transitions.none=function($cont,$slides,opts){opts.fxFn=function(curr,next,opts,after){$(next).show();$(curr).hide();after();};};$.fn.cycle.transitions.fadeout=function($cont,$slides,opts){$slides.not(':eq('+opts.currSlide+')').css({display:'block','opacity':1});opts.before.push(function(curr,next,opts,w,h,rev){$(curr).css('zIndex',opts.slideCount+(rev!==true?1:0));$(next).css('zIndex',opts.slideCount+(rev!==true?0:1));});opts.animIn.opacity=1;opts.animOut.opacity=0;opts.cssBefore.opacity=1;opts.cssBefore.display='block';opts.cssAfter.zIndex=0;};$.fn.cycle.transitions.scrollUp=function($cont,$slides,opts){$cont.css('overflow','hidden');opts.before.push($.fn.cycle.commonReset);var h=$cont.height();opts.cssBefore.top=h;opts.cssBefore.left=0;opts.cssFirst.top=0;opts.animIn.top=0;opts.animOut.top=-h;};$.fn.cycle.transitions.scrollDown=function($cont,$slides,opts){$cont.css('overflow','hidden');opts.before.push($.fn.cycle.commonReset);var h=$cont.height();opts.cssFirst.top=0;opts.cssBefore.top=-h;opts.cssBefore.left=0;opts.animIn.top=0;opts.animOut.top=h;};$.fn.cycle.transitions.scrollLeft=function($cont,$slides,opts){$cont.css('overflow','hidden');opts.before.push($.fn.cycle.commonReset);var w=$cont.width();opts.cssFirst.left=0;opts.cssBefore.left=w;opts.cssBefore.top=0;opts.animIn.left=0;opts.animOut.left=0-w;};$.fn.cycle.transitions.scrollRight=function($cont,$slides,opts){$cont.css('overflow','hidden');opts.before.push($.fn.cycle.commonReset);var w=$cont.width();opts.cssFirst.left=0;opts.cssBefore.left=-w;opts.cssBefore.top=0;opts.animIn.left=0;opts.animOut.left=w;};$.fn.cycle.transitions.scrollHorz=function($cont,$slides,opts){$cont.css('overflow','hidden').width();opts.before.push(function(curr,next,opts,fwd){if(opts.rev)
fwd=!fwd;$.fn.cycle.commonReset(curr,next,opts);opts.cssBefore.left=fwd?(next.cycleW-1):(1-next.cycleW);opts.animOut.left=fwd?-curr.cycleW:curr.cycleW;});opts.cssFirst.left=0;opts.cssBefore.top=0;opts.animIn.left=0;opts.animOut.top=0;};$.fn.cycle.transitions.scrollVert=function($cont,$slides,opts){$cont.css('overflow','hidden');opts.before.push(function(curr,next,opts,fwd){if(opts.rev)
fwd=!fwd;$.fn.cycle.commonReset(curr,next,opts);opts.cssBefore.top=fwd?(1-next.cycleH):(next.cycleH-1);opts.animOut.top=fwd?curr.cycleH:-curr.cycleH;});opts.cssFirst.top=0;opts.cssBefore.left=0;opts.animIn.top=0;opts.animOut.left=0;};$.fn.cycle.transitions.slideX=function($cont,$slides,opts){opts.before.push(function(curr,next,opts){$(opts.elements).not(curr).hide();$.fn.cycle.commonReset(curr,next,opts,false,true);opts.animIn.width=next.cycleW;});opts.cssBefore.left=0;opts.cssBefore.top=0;opts.cssBefore.width=0;opts.animIn.width='show';opts.animOut.width=0;};$.fn.cycle.transitions.slideY=function($cont,$slides,opts){opts.before.push(function(curr,next,opts){$(opts.elements).not(curr).hide();$.fn.cycle.commonReset(curr,next,opts,true,false);opts.animIn.height=next.cycleH;});opts.cssBefore.left=0;opts.cssBefore.top=0;opts.cssBefore.height=0;opts.animIn.height='show';opts.animOut.height=0;};$.fn.cycle.transitions.shuffle=function($cont,$slides,opts){var i,w=$cont.css('overflow','visible').width();$slides.css({left:0,top:0});opts.before.push(function(curr,next,opts){$.fn.cycle.commonReset(curr,next,opts,true,true,true);});if(!opts.speedAdjusted){opts.speed=opts.speed / 2;opts.speedAdjusted=true;}
opts.random=0;opts.shuffle=opts.shuffle||{left:-w,top:15};opts.els=[];for(i=0;i<$slides.length;i++)
opts.els.push($slides[i]);for(i=0;i<opts.currSlide;i++)
opts.els.push(opts.els.shift());opts.fxFn=function(curr,next,opts,cb,fwd){if(opts.rev)
fwd=!fwd;var $el=fwd?$(curr):$(next);$(next).css(opts.cssBefore);var count=opts.slideCount;$el.animate(opts.shuffle,opts.speedIn,opts.easeIn,function(){var hops=$.fn.cycle.hopsFromLast(opts,fwd);for(var k=0;k<hops;k++){if(fwd)
opts.els.push(opts.els.shift());else
opts.els.unshift(opts.els.pop());}
if(fwd){for(var i=0,len=opts.els.length;i<len;i++)
$(opts.els[i]).css('z-index',len-i+count);}
else{var z=$(curr).css('z-index');$el.css('z-index',parseInt(z,10)+1+count);}
$el.animate({left:0,top:0},opts.speedOut,opts.easeOut,function(){$(fwd?this:curr).hide();if(cb)cb();});});};$.extend(opts.cssBefore,{display:'block',opacity:1,top:0,left:0});};$.fn.cycle.transitions.turnUp=function($cont,$slides,opts){opts.before.push(function(curr,next,opts){$.fn.cycle.commonReset(curr,next,opts,true,false);opts.cssBefore.top=next.cycleH;opts.animIn.height=next.cycleH;opts.animOut.width=next.cycleW;});opts.cssFirst.top=0;opts.cssBefore.left=0;opts.cssBefore.height=0;opts.animIn.top=0;opts.animOut.height=0;};$.fn.cycle.transitions.turnDown=function($cont,$slides,opts){opts.before.push(function(curr,next,opts){$.fn.cycle.commonReset(curr,next,opts,true,false);opts.animIn.height=next.cycleH;opts.animOut.top=curr.cycleH;});opts.cssFirst.top=0;opts.cssBefore.left=0;opts.cssBefore.top=0;opts.cssBefore.height=0;opts.animOut.height=0;};$.fn.cycle.transitions.turnLeft=function($cont,$slides,opts){opts.before.push(function(curr,next,opts){$.fn.cycle.commonReset(curr,next,opts,false,true);opts.cssBefore.left=next.cycleW;opts.animIn.width=next.cycleW;});opts.cssBefore.top=0;opts.cssBefore.width=0;opts.animIn.left=0;opts.animOut.width=0;};$.fn.cycle.transitions.turnRight=function($cont,$slides,opts){opts.before.push(function(curr,next,opts){$.fn.cycle.commonReset(curr,next,opts,false,true);opts.animIn.width=next.cycleW;opts.animOut.left=curr.cycleW;});$.extend(opts.cssBefore,{top:0,left:0,width:0});opts.animIn.left=0;opts.animOut.width=0;};$.fn.cycle.transitions.zoom=function($cont,$slides,opts){opts.before.push(function(curr,next,opts){$.fn.cycle.commonReset(curr,next,opts,false,false,true);opts.cssBefore.top=next.cycleH/2;opts.cssBefore.left=next.cycleW/2;$.extend(opts.animIn,{top:0,left:0,width:next.cycleW,height:next.cycleH});$.extend(opts.animOut,{width:0,height:0,top:curr.cycleH/2,left:curr.cycleW/2});});opts.cssFirst.top=0;opts.cssFirst.left=0;opts.cssBefore.width=0;opts.cssBefore.height=0;};$.fn.cycle.transitions.fadeZoom=function($cont,$slides,opts){opts.before.push(function(curr,next,opts){$.fn.cycle.commonReset(curr,next,opts,false,false);opts.cssBefore.left=next.cycleW/2;opts.cssBefore.top=next.cycleH/2;$.extend(opts.animIn,{top:0,left:0,width:next.cycleW,height:next.cycleH});});opts.cssBefore.width=0;opts.cssBefore.height=0;opts.animOut.opacity=0;};$.fn.cycle.transitions.blindX=function($cont,$slides,opts){var w=$cont.css('overflow','hidden').width();opts.before.push(function(curr,next,opts){$.fn.cycle.commonReset(curr,next,opts);opts.animIn.width=next.cycleW;opts.animOut.left=curr.cycleW;});opts.cssBefore.left=w;opts.cssBefore.top=0;opts.animIn.left=0;opts.animOut.left=w;};$.fn.cycle.transitions.blindY=function($cont,$slides,opts){var h=$cont.css('overflow','hidden').height();opts.before.push(function(curr,next,opts){$.fn.cycle.commonReset(curr,next,opts);opts.animIn.height=next.cycleH;opts.animOut.top=curr.cycleH;});opts.cssBefore.top=h;opts.cssBefore.left=0;opts.animIn.top=0;opts.animOut.top=h;};$.fn.cycle.transitions.blindZ=function($cont,$slides,opts){var h=$cont.css('overflow','hidden').height();var w=$cont.width();opts.before.push(function(curr,next,opts){$.fn.cycle.commonReset(curr,next,opts);opts.animIn.height=next.cycleH;opts.animOut.top=curr.cycleH;});opts.cssBefore.top=h;opts.cssBefore.left=w;opts.animIn.top=0;opts.animIn.left=0;opts.animOut.top=h;opts.animOut.left=w;};$.fn.cycle.transitions.growX=function($cont,$slides,opts){opts.before.push(function(curr,next,opts){$.fn.cycle.commonReset(curr,next,opts,false,true);opts.cssBefore.left=this.cycleW/2;opts.animIn.left=0;opts.animIn.width=this.cycleW;opts.animOut.left=0;});opts.cssBefore.top=0;opts.cssBefore.width=0;};$.fn.cycle.transitions.growY=function($cont,$slides,opts){opts.before.push(function(curr,next,opts){$.fn.cycle.commonReset(curr,next,opts,true,false);opts.cssBefore.top=this.cycleH/2;opts.animIn.top=0;opts.animIn.height=this.cycleH;opts.animOut.top=0;});opts.cssBefore.height=0;opts.cssBefore.left=0;};$.fn.cycle.transitions.curtainX=function($cont,$slides,opts){opts.before.push(function(curr,next,opts){$.fn.cycle.commonReset(curr,next,opts,false,true,true);opts.cssBefore.left=next.cycleW/2;opts.animIn.left=0;opts.animIn.width=this.cycleW;opts.animOut.left=curr.cycleW/2;opts.animOut.width=0;});opts.cssBefore.top=0;opts.cssBefore.width=0;};$.fn.cycle.transitions.curtainY=function($cont,$slides,opts){opts.before.push(function(curr,next,opts){$.fn.cycle.commonReset(curr,next,opts,true,false,true);opts.cssBefore.top=next.cycleH/2;opts.animIn.top=0;opts.animIn.height=next.cycleH;opts.animOut.top=curr.cycleH/2;opts.animOut.height=0;});opts.cssBefore.height=0;opts.cssBefore.left=0;};$.fn.cycle.transitions.cover=function($cont,$slides,opts){var d=opts.direction||'left';var w=$cont.css('overflow','hidden').width();var h=$cont.height();opts.before.push(function(curr,next,opts){$.fn.cycle.commonReset(curr,next,opts);opts.cssAfter.display='';if(d=='right')
opts.cssBefore.left=-w;else if(d=='up')
opts.cssBefore.top=h;else if(d=='down')
opts.cssBefore.top=-h;else
opts.cssBefore.left=w;});opts.animIn.left=0;opts.animIn.top=0;opts.cssBefore.top=0;opts.cssBefore.left=0;};$.fn.cycle.transitions.uncover=function($cont,$slides,opts){var d=opts.direction||'left';var w=$cont.css('overflow','hidden').width();var h=$cont.height();opts.before.push(function(curr,next,opts){$.fn.cycle.commonReset(curr,next,opts,true,true,true);if(d=='right')
opts.animOut.left=w;else if(d=='up')
opts.animOut.top=-h;else if(d=='down')
opts.animOut.top=h;else
opts.animOut.left=-w;});opts.animIn.left=0;opts.animIn.top=0;opts.cssBefore.top=0;opts.cssBefore.left=0;};$.fn.cycle.transitions.toss=function($cont,$slides,opts){var w=$cont.css('overflow','visible').width();var h=$cont.height();opts.before.push(function(curr,next,opts){$.fn.cycle.commonReset(curr,next,opts,true,true,true);if(!opts.animOut.left&&!opts.animOut.top)
$.extend(opts.animOut,{left:w*2,top:-h/2,opacity:0});else
opts.animOut.opacity=0;});opts.cssBefore.left=0;opts.cssBefore.top=0;opts.animIn.left=0;};$.fn.cycle.transitions.wipe=function($cont,$slides,opts){var w=$cont.css('overflow','hidden').width();var h=$cont.height();opts.cssBefore=opts.cssBefore||{};var clip;if(opts.clip){if(/l2r/.test(opts.clip))
clip='rect(0px 0px '+h+'px 0px)';else if(/r2l/.test(opts.clip))
clip='rect(0px '+w+'px '+h+'px '+w+'px)';else if(/t2b/.test(opts.clip))
clip='rect(0px '+w+'px 0px 0px)';else if(/b2t/.test(opts.clip))
clip='rect('+h+'px '+w+'px '+h+'px 0px)';else if(/zoom/.test(opts.clip)){var top=parseInt(h/2,10);var left=parseInt(w/2,10);clip='rect('+top+'px '+left+'px '+top+'px '+left+'px)';}}
opts.cssBefore.clip=opts.cssBefore.clip||clip||'rect(0px 0px 0px 0px)';var d=opts.cssBefore.clip.match(/(\d+)/g);var t=parseInt(d[0],10),r=parseInt(d[1],10),b=parseInt(d[2],10),l=parseInt(d[3],10);opts.before.push(function(curr,next,opts){if(curr==next)return;var $curr=$(curr),$next=$(next);$.fn.cycle.commonReset(curr,next,opts,true,true,false);opts.cssAfter.display='block';var step=1,count=parseInt((opts.speedIn / 13),10)-1;(function f(){var tt=t?t-parseInt(step*(t/count),10):0;var ll=l?l-parseInt(step*(l/count),10):0;var bb=b<h?b+parseInt(step*((h-b)/count||1),10):h;var rr=r<w?r+parseInt(step*((w-r)/count||1),10):w;$next.css({clip:'rect('+tt+'px '+rr+'px '+bb+'px '+ll+'px)'});(step++<=count)?setTimeout(f,13):$curr.css('display','none');})();});$.extend(opts.cssBefore,{display:'block',opacity:1,top:0,left:0});opts.animIn={left:0};opts.animOut={left:0};};})(jQuery);

} /* end modules/shortcodes/js/jquery.cycle.js */

if ( jpconcat.files['modules/shortcodes/js/main.js'] ) {

(function($){var jmpressOpts={fullscreen:false,hash:{use:false},mouse:{clickSelects:false},keyboard:{use:true},animation:{transitionDuration:'1s'},presentationMode:false,stepSelector:'.step',duration:{defaultValue:0}};function Presentation(wrapper){var _self,duration,new_css,ie_regex,matches;_self=this;_self.wrapper=$(wrapper);_self.slideshow=$('.presentation',wrapper);_self.navLeft=$('.nav-arrow-left',wrapper);_self.navRight=$('.nav-arrow-right',wrapper);_self.expandButton=$('.nav-fullscreen-button',wrapper);_self.overlay=$('.autoplay-overlay',wrapper);_self.fullscreen=false;_self.autoPlaying=false;_self.autoplayTime=parseFloat(_self.slideshow.attr('data-autoplay'),10)||0;_self.wrapper.css({width:_self.slideshow.width(),height:_self.slideshow.height()});duration=_self.slideshow.attr('duration')||'1s';jmpressOpts.animation.transitionDuration=duration;if(_self.autoplayTime){_self.autoplayTime+=parseFloat(duration,10)*1000;}
duration='opacity '+duration;new_css={'width':_self.slideshow.width(),'height':_self.slideshow.height(),'-webkit-transition':duration,'-moz-transition':duration,'-ms-transition':duration,'-o-transition':duration,'transition':duration};$('.step',_self.slideshow).each(function(i,step){$(step).css(new_css);});$('.step.fadebullets li',_self.slideshow).each(function(i,step){$(step).attr('data-jmpress','fade');});$(window).resize(function(){if(_self.fullscreen){_self.resizePresentation();}});_self.navLeft.on('click',function(){_self.slideshow.jmpress('prev');_self.overlay.css('opacity',0);return false;});_self.navRight.on('click',function(){_self.slideshow.jmpress('next');_self.overlay.css('opacity',0);return false;});_self.slideshow.on('click',function(){_self.setAutoplay(true);return false;});_self.slideshow.on('focusout',function(){_self.setAutoplay(false);});ie_regex=/MSIE\s(\d+)\.\d+/;matches=ie_regex.exec(navigator.userAgent);if(matches&&parseInt(matches[1],10)<10){_self.expandButton.remove();_self.expandButton=null;}else{_self.expandButton.on('click',function(){_self.setFullscreen(!_self.fullscreen);return false;});}
$(window).on('keydown',function(event){if(event.which===27){_self.setFullscreen(false);}});_self.slideshow.jmpress(jmpressOpts);if(_self.slideshow.jmpress('initialized')){_self.slideshow.css('display','');_self.overlay.css('display','');$('.not-supported-msg',_self.wrapper).remove();}
_self.setFullscreen(false);}
$.extend(Presentation.prototype,{resizePresentation:function(){var scale,duration,settings,new_css,widthScale,heightScale;settings=this.slideshow.jmpress('settings');duration=settings.animation.transitionDuration;settings.animation.transitionDuration='0s';this.slideshow.jmpress('reselect');scale=1;new_css={top:0,left:0,zoom:1};if(this.fullscreen){widthScale=$(window).width()/ this.slideshow.width();heightScale=$(window).height()/ this.slideshow.height();scale=Math.min(widthScale,heightScale);new_css.top=($(window).height()-(scale*this.slideshow.height()))/ 2;new_css.left=($(window).width()-(scale*this.slideshow.width()))/ 2;}
if(this.slideshow.css('-moz-transform')||this.slideshow.css('-ms-transform')){new_css.top+=(scale-1)*this.slideshow.height()/ 2;new_css.left+=(scale-1)*this.slideshow.width()/ 2;scale='scale('+scale+')';$.extend(new_css,{'-moz-transform':scale,'-ms-transform':scale,'transform':scale});}else{new_css.top /=scale;new_css.left /=scale;new_css.zoom=scale;}
this.slideshow.css(new_css);settings.animation.transitionDuration=duration;this.slideshow.jmpress('reselect');},setFullscreen:function(on){this.fullscreen=on;this.setAutoplay(false);if(on){this.scrollVert=$(window).scrollTop();this.scrollHoriz=$(window).scrollLeft();$(window).scrollTop(0);$(window).scrollLeft(0);}
$('html').toggleClass('presentation-global-fullscreen',on);$('body').toggleClass('presentation-global-fullscreen',on);this.wrapper.toggleClass('presentation-wrapper-fullscreen',on);this.wrapper.parents().each(function(i,e){$(e).toggleClass('presentation-wrapper-fullscreen-parent',on);});this.resizePresentation();if(!on){$(window).scrollTop(this.scrollVert);$(window).scrollLeft(this.scrollHoriz);}},setAutoplay:function(on){var _self=this,newAutoplayTime;if(_self.autoPlaying===on){return;}
newAutoplayTime=(on&&_self.autoplayTime>0)?_self.autoplayTime:0;_self.slideshow.jmpress('settings').duration.defaultValue=newAutoplayTime;if(newAutoplayTime){_self.slideshow.jmpress('next');_self.overlay.css('opacity',0);}else{_self.slideshow.jmpress('reselect');}
_self.autoPlaying=on;}});$(document).ready(function(){$('.presentation-wrapper').map(function(){new Presentation(this);});});})(jQuery);

} /* end modules/shortcodes/js/main.js */

if ( jpconcat.files['modules/shortcodes/js/slideshow-shortcode.js'] ) {

function JetpackSlideshow(element,width,height,transition){this.element=element;this.images=[];this.controls={};this.transition=transition||'fade';var currentWidth=this.element.width();if(!width||width>currentWidth){width=currentWidth;}
this.width=width;this.height=height;this.element.css({'height':this.height+'px'});}
JetpackSlideshow.prototype.showLoadingImage=function(toggle){if(toggle){this.loadingImage_=document.createElement('div');this.loadingImage_.className='slideshow-loading';var img=document.createElement('img');img.src=jetpackSlideshowSettings.spinner;this.loadingImage_.appendChild(img);this.loadingImage_.appendChild(this.makeZeroWidthSpan());this.loadingImage_.style.lineHeight=this.height+'px';this.element.append(this.loadingImage_);}else if(this.loadingImage_){this.loadingImage_.parentNode.removeChild(this.loadingImage_);this.loadingImage_=null;}};JetpackSlideshow.prototype.init=function(){this.showLoadingImage(true);var self=this;for(var i=0;i<this.images.length;i++){var imageInfo=this.images[i];var img=document.createElement('img');img.src=imageInfo.src+'?w='+this.width;img.align='middle';var caption=document.createElement('div');caption.className='slideshow-slide-caption';caption.innerHTML=imageInfo.caption;var container=document.createElement('div');container.className='slideshow-slide';container.style.lineHeight=this.height+'px';if(i===0){if(img.complete){setTimeout(function(){self.finishInit_();},1);}else{jQuery(img).load(function(){self.finishInit_();});}}
container.appendChild(img);img.removeAttribute('width');img.removeAttribute('height');container.appendChild(this.makeZeroWidthSpan());container.appendChild(caption);this.element.append(container);}};JetpackSlideshow.prototype.makeZeroWidthSpan=function(){var emptySpan=document.createElement('span');emptySpan.className='slideshow-line-height-hack';if(jQuery.browser.msie){emptySpan.appendChild(document.createTextNode(' '));}else{emptySpan.innerHTML='&nbsp;';}
return emptySpan;};JetpackSlideshow.prototype.finishInit_=function(){this.showLoadingImage(false);this.renderControls_();var self=this;this.element.cycle({fx:this.transition,prev:this.controls.prev,next:this.controls.next,slideExpr:'.slideshow-slide',onPrevNextEvent:function(){return self.onCyclePrevNextClick_.apply(self,arguments);}});var slideshow=this.element;jQuery(this.controls.stop).click(function(){var button=jQuery(this);if(!button.hasClass('paused')){slideshow.cycle('pause');button.removeClass('running');button.addClass('paused');}else{button.addClass('running');button.removeClass('paused');slideshow.cycle('resume',true);}
return false;});var controls=jQuery(this.controlsDiv_);slideshow.mouseenter(function(){controls.fadeIn();});slideshow.mouseleave(function(){controls.fadeOut();});this.initialized_=true;};JetpackSlideshow.prototype.renderControls_=function(){if(this.controlsDiv_){return;}
var controlsDiv=document.createElement('div');controlsDiv.className='slideshow-controls';var controls=['prev','stop','next'];for(var i=0;i<controls.length;i++){var controlName=controls[i];var a=document.createElement('a');a.href='#';controlsDiv.appendChild(a);this.controls[controlName]=a;}
this.element.append(controlsDiv);this.controlsDiv_=controlsDiv;};JetpackSlideshow.prototype.onCyclePrevNextClick_=function(isNext,i){if(!jetpackSlideshowSettings.blog_id){return;}
var postid=this.images[i].id;var stats=new Image();stats.src=document.location.protocol+'//pixel.wp.com/g.gif?host='+
escape(document.location.host)+'&rand='+Math.random()+'&blog='+jetpackSlideshowSettings.blog_id+'&subd='+jetpackSlideshowSettings.blog_subdomain+'&user_id='+jetpackSlideshowSettings.user_id+'&post='+postid+'&ref='+escape(document.location);};(function($){function jetpack_slideshow_init(){$('.jetpack-slideshow-noscript').remove();$('.jetpack-slideshow').each(function(){var container=$(this);if(container.data('processed')){return;}
var slideshow=new JetpackSlideshow(container,container.data('width'),container.data('height'),container.data('trans'));slideshow.images=container.data('gallery');slideshow.init();container.data('processed',true);});}
$(document).ready(jetpack_slideshow_init);$('body').on('post-load',jetpack_slideshow_init);})(jQuery);

} /* end modules/shortcodes/js/slideshow-shortcode.js */

if ( jpconcat.files['modules/theme-tools/js/suggest.js'] ) {

jQuery(function($){$('#customize-control-featured-content-tag-name input').suggest(ajaxurl+'?action=ajax-tag-search&tax=post_tag',{delay:500,minchars:2});});

} /* end modules/theme-tools/js/suggest.js */

if ( jpconcat.files['modules/theme-tools/responsive-videos/responsive-videos.js'] ) {

(function($){var debounce=function(func,wait){var timeout,args,context,timestamp;return function(){context=this;args=[].slice.call(arguments,0);timestamp=new Date();var later=function(){var last=(new Date())-timestamp;if(last<wait){timeout=setTimeout(later,wait-last);}else{timeout=null;func.apply(context,args);}};if(!timeout){timeout=setTimeout(later,wait);}};};function responsive_videos(){$('.jetpack-video-wrapper').find('embed, iframe, object').each(function(){var video_element,video_width,video_height,video_ratio,video_wrapper,container_width;video_element=$(this);if(!video_element.attr('data-ratio')){video_element.attr('data-ratio',this.height / this.width).attr('data-width',this.width).attr('data-height',this.height).css({'display':'block','margin':0});}
video_width=video_element.attr('data-width');video_height=video_element.attr('data-height');video_ratio=video_element.attr('data-ratio');video_wrapper=video_element.parent();container_width=video_wrapper.width();if(video_ratio==='Infinity'){video_width='100%';}
video_element.removeAttr('height').removeAttr('width');if(video_width>container_width){video_element.width(container_width).height(container_width*video_ratio);}else{video_element.width(video_width).height(video_height);}});}
$(window).load(responsive_videos).resize(debounce(responsive_videos,100)).trigger('resize');$(document).on('post-load',responsive_videos);})(jQuery);

} /* end modules/theme-tools/responsive-videos/responsive-videos.js */

if ( jpconcat.files['modules/theme-tools/responsive-videos/responsive-videos.min.js'] ) {

!function(t){function a(){t(".jetpack-video-wrapper").find("embed, iframe, object").each(function(){var a=t(this);a.attr("data-ratio")||a.attr("data-ratio",this.height/this.width).attr("data-width",this.width).attr("data-height",this.height).css({display:"block",margin:0});var i=a.attr("data-width"),e=a.attr("data-height"),r=a.attr("data-ratio"),h=a.parent(),n=h.width();"Infinity"===r&&(i="100%"),a.removeAttr("height").removeAttr("width"),i>n?a.width(n).height(n*r):a.width(i).height(e)})}var i=function(t,a){var i,e,r,h;return function(){r=this,e=[].slice.call(arguments,0),h=new Date;var n=function(){var d=new Date-h;a>d?i=setTimeout(n,a-d):(i=null,t.apply(r,e))};i||(i=setTimeout(n,a))}};t(window).load(a).resize(i(a,100)).trigger("resize"),t(document).on("post-load",a)}(jQuery);

} /* end modules/theme-tools/responsive-videos/responsive-videos.min.js */

if ( jpconcat.files['modules/tiled-gallery/tiled-gallery/tiled-gallery.js'] ) {

(function($){function TiledGalleryCollection(){this.galleries=[];this.findAndSetupNewGalleries();}
TiledGalleryCollection.prototype.findAndSetupNewGalleries=function(){var self=this;$('.tiled-gallery.tiled-gallery-unresized').each(function(){self.galleries.push(new TiledGallery($(this)));});};TiledGalleryCollection.prototype.resizeAll=function(){$.each(this.galleries,function(i,gallery){gallery.resize();});};function TiledGallery(galleryElem){this.gallery=galleryElem;this.addCaptionEvents();this.resize();this.gallery.removeClass('tiled-gallery-unresized');}
TiledGallery.prototype.resizeableElementsSelector='.gallery-row, .gallery-group, .tiled-gallery-item img';TiledGallery.prototype.addCaptionEvents=function(){this.gallery.find('.tiled-gallery-caption').hide();this.gallery.find('.tiled-gallery-item').hover(function(){$(this).find('.tiled-gallery-caption').stop(true,true).slideDown('fast');},function(){$(this).find('.tiled-gallery-caption').stop(true,true).slideUp('fast');});};TiledGallery.prototype.getExtraDimension=function(el,attribute,mode){if(mode==='horizontal'){var left=(attribute==='border')?'borderLeftWidth':attribute+'Left';var right=(attribute==='border')?'borderRightWidth':attribute+'Right';return(parseInt(el.css(left),10)||0)+(parseInt(el.css(right),10)||0);}else if(mode==='vertical'){var top=(attribute==='border')?'borderTopWidth':attribute+'Top';var bottom=(attribute==='border')?'borderBottomWidth':attribute+'Bottom';return(parseInt(el.css(top),10)||0)+(parseInt(el.css(bottom),10)||0);}else{return 0;}};TiledGallery.prototype.resize=function(){var originalWidth=this.gallery.data('original-width');var currentWidth=this.gallery.parent().width();var resizeRatio=Math.min(1,currentWidth / originalWidth);var self=this;this.gallery.find(this.resizeableElementsSelector).each(function(){var thisGalleryElement=$(this);var marginWidth=self.getExtraDimension(thisGalleryElement,'margin','horizontal');var marginHeight=self.getExtraDimension(thisGalleryElement,'margin','vertical');var paddingWidth=self.getExtraDimension(thisGalleryElement,'padding','horizontal');var paddingHeight=self.getExtraDimension(thisGalleryElement,'padding','vertical');var borderWidth=self.getExtraDimension(thisGalleryElement,'border','horizontal');var borderHeight=self.getExtraDimension(thisGalleryElement,'border','vertical');var outerWidth=thisGalleryElement.data('original-width')+paddingWidth+borderWidth+marginWidth;var outerHeight=thisGalleryElement.data('original-height')+paddingHeight+borderHeight+marginHeight;thisGalleryElement.width(Math.floor(resizeRatio*outerWidth)-marginWidth).height(Math.floor(resizeRatio*outerHeight)-marginHeight);});};var requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;function attachResizeInAnimationFrames(tiledGalleries){var resizing=false;var resizeTimeout=null;function handleFrame(){tiledGalleries.resizeAll();if(resizing){requestAnimationFrame(handleFrame);}}
$(window).resize(function(){clearTimeout(resizeTimeout);if(!resizing){requestAnimationFrame(handleFrame);}
resizing=true;resizeTimeout=setTimeout(function(){resizing=false;},15);});}
function attachPlainResize(tiledGalleries){$(window).resize(function(){tiledGalleries.resizeAll();});}
$(document).ready(function(){var tiledGalleries=new TiledGalleryCollection();$('body').on('post-load',function(){tiledGalleries.findAndSetupNewGalleries();});$(document).on('page-rendered.wpcom-newdash',function(){tiledGalleries.findAndSetupNewGalleries();});if(window.chrome&&requestAnimationFrame){attachResizeInAnimationFrames(tiledGalleries);}else{attachPlainResize(tiledGalleries);}});})(jQuery);

} /* end modules/tiled-gallery/tiled-gallery/tiled-gallery.js */

if ( jpconcat.files['modules/videopress/videopress-admin.js'] ) {

(function($){var media=wp.media;var VideoPress=VideoPress||{};VideoPress.caps=VideoPressAdminSettings.caps;VideoPress.l10n=VideoPressAdminSettings.l10n;media.controller.VideoPress=media.controller.Library.extend({defaults:_.defaults({id:'videopress',router:'videopress',toolbar:'videopress-toolbar',title:'VideoPress',priority:200,searchable:true,sortable:false},media.controller.Library.prototype.defaults),initialize:function(){if(!this.get('library')){this.set('library',media.query({videopress:true}));}
media.controller.Library.prototype.initialize.apply(this,arguments);},saveContentMode:function(){if('videopress'!==this.get('router')){return;}
var mode=this.frame.content.mode(),view=this.frame.router.get();if(view&&view.get(mode)){if('upload_videopress'===mode){mode='upload';}
setUserSetting('libraryContent',mode);}}});media.view.VideoPressUploader=media.View.extend({tagName:'div',className:'uploader-videopress',template:media.template('videopress-uploader'),events:{'submit .videopress-upload-form':'submitForm'},initialize:function(){var that=this;if(!window.addEventListener){window.attachEvent('onmessage',function(){return that.messageHandler.apply(that,arguments);});}else{window.addEventListener('message',function(){return that.messageHandler.apply(that,arguments);},false);}
return media.View.prototype.initialize.apply(this,arguments);},submitForm:function(){var data=false;this.clearErrors();if(this.$('input[name="videopress_file"]').val().length<1){this.error(VideoPress.l10n.selectVideoFile);return false;}
this.$('.videopress-upload-form .button').prop('disabled',true);media.ajax('videopress-get-upload-token',{async:false}).done(function(response){data=response;data.success=true;}).fail(function(response){data=response;data.success=false;});if(!data.success){this.$('.videopress-upload-form .button').prop('disabled',false);this.error(data.message);return false;}
this.error(VideoPress.l10n.videoUploading,'updated');this.$('input[name="videopress_blog_id"]').val(data.videopress_blog_id);this.$('input[name="videopress_token"]').val(data.videopress_token);this.$('.videopress-upload-form').attr('action',data.videopress_action_url);return true;},error:function(message,type){type=type||'error';var div=$('<div />').html($('<p />').text(message)).addClass(type);this.$('.videopress-errors').html(div);return this;},success:function(message){return this.error(message,'updated');},clearErrors:function(){this.$('.videopress-errors').html('');return this;},messageHandler:function(event){if(!event.origin.match(/\.wordpress\.com$/)){return;}
if(event.data.indexOf&&event.data.indexOf('vpUploadResult::')===0){var result=JSON.parse(event.data.substr(16));if(!result||!result.code){this.error(VideoPress.l10n.unknownError);this.$('.videopress-upload-form .button').prop('disabled',false);return;}
if('success'===result.code&&result.data){var that=this,controller=this.controller,state=controller.states.get('videopress');state.set('library',media.query({videopress:true,vp_random:Math.random()}));state.get('library').more().done(function(){var model=state.get('library').get(result.data.attachment_id);that.clearErrors();state.get('selection').reset([model]);controller.content.mode('browse');});}else{this.error(result.code);this.$('.videopress-upload-form .button').prop('disabled',false);}}}});var attachmentSync=media.model.Attachment.prototype.sync;media.model.Attachment.prototype.sync=function(method,model,options){if(model.get('vp_isVideoPress')){console.log('syncing '+model.get('vp_guid'));options.data=_.extend(options.data||{},{is_videopress:true,vp_nonces:model.get('vp_nonces')});}
return attachmentSync.apply(this,arguments);};var AttachmentDetails=media.view.Attachment.Details;media.view.Attachment.Details=AttachmentDetails.extend({initialize:function(){if(this.model.get('vp_isVideoPress')){_.extend(this.events,{'click a.videopress-preview':'vpPreview','change .vp-radio':'vpRadioChange','change .vp-checkbox':'vpCheckboxChange'});}
return AttachmentDetails.prototype.initialize.apply(this,arguments);},render:function(){var r=AttachmentDetails.prototype.render.apply(this,arguments);if(this.model.get('vp_isVideoPress')){var template=media.template('videopress-attachment');var options=this.model.toJSON();options.can={};options.can.save=!!options.nonces.update;this.$el.append(template(options));}
return r;},vpRadioChange:function(e){$(e.target).parents('.vp-setting').find('.vp-radio-text').val(e.target.value).change();},vpCheckboxChange:function(e){$(e.target).parents('.vp-setting').find('.vp-checkbox-text').val(Number(e.target.checked)).change();},vpPreview:function(){VideoPressModal.render(this);return this;}});var UploaderWindow=media.view.UploaderWindow;media.view.UploaderWindow=UploaderWindow.extend({show:function(){if('videopress'!==this.controller.state().get('id')){UploaderWindow.prototype.show.apply(this,arguments);}
return this;}});var AttachmentsBrowser=media.view.AttachmentsBrowser;media.view.AttachmentsBrowser=AttachmentsBrowser.extend({createUploader:function(){if('videopress'!==this.controller.state().get('id')){return AttachmentsBrowser.prototype.createUploader.apply(this,arguments);}}});_.extend(media.view.MediaFrame.prototype,{VideoPress:{activate:function(){var view=_.first(this.views.get('.media-frame-router')),viewSettings={};if(VideoPress.caps.read_videos){viewSettings.browse={text:VideoPress.l10n.VideoPressLibraryRouter,priority:40};}
if(VideoPress.caps.upload_videos){viewSettings.upload_videopress={text:VideoPress.l10n.uploadVideoRouter,priority:20};}
view.set(viewSettings);wp.Uploader.queue.on('add',this.VideoPress.disableUpload,this);if('upload'===this.content.mode()&&VideoPress.caps.upload_videos){this.content.mode('upload_videopress');}else{this.content.mode('browse');}},deactivate:function(){wp.Uploader.queue.off('add',this.VideoPress.disableUpload);},disableUpload:function(attachment){var uploader=this.uploader.uploader.uploader;uploader.stop();uploader.splice();attachment.destroy();},insert:function(selection){var guid=selection.models[0].get('vp_guid').replace(/[^a-zA-Z0-9]+/,'');media.editor.insert('[wpvideo '+guid+']');return this;},uploadVideo:function(){this.content.set(new media.view.VideoPressUploader({controller:this}));return this;},createToolbar:function(){if(this.options.VideoPress&&this.options.VideoPress.hideToolbar){return this;}
var controller=this;this.toolbar.set(new media.view.Toolbar({controller:this,items:{insert:{style:'primary',text:VideoPress.l10n.insertVideoButton,priority:80,requires:{library:true,selection:true},click:function(){var state=controller.state(),selection=state.get('selection');controller.close();state.trigger('videopress:insert',selection).reset();}}}}));}}});var MediaFrame={};MediaFrame.Select=media.view.MediaFrame.Select;media.view.MediaFrame.Select=MediaFrame.Select.extend({bindHandlers:function(){MediaFrame.Select.prototype.bindHandlers.apply(this,arguments);this.on('router:create:videopress',this.createRouter,this);this.on('router:activate:videopress',this.VideoPress.activate,this);this.on('router:deactivate:videopress',this.VideoPress.deactivate,this);this.on('content:render:upload_videopress',this.VideoPress.uploadVideo,this);this.on('toolbar:create:videopress-toolbar',this.VideoPress.createToolbar,this);this.on('videopress:insert',this.VideoPress.insert,this);}});MediaFrame.Post=media.view.MediaFrame.Post;media.view.MediaFrame.Post=MediaFrame.Post.extend({createStates:function(){MediaFrame.Post.prototype.createStates.apply(this,arguments);this.states.add([new media.controller.VideoPress()]);}});var VideoPressModalView=Backbone.View.extend({'className':'videopress-modal-container','template':wp.media.template('videopress-media-modal'),render:function(controller){this.delegateEvents({'click .videopress-modal-close':'closeModal','click .videopress-modal-backdrop':'closeModal'});this.model=controller.model;this.guid=this.model.get('vp_guid');if(!this.$frame){this.$frame=$('.media-frame-content');}
this.$el.html(this.template({'video':this.model.get('vp_embed')}));this.$modal=this.$('.videopress-modal');this.$modal.hide();this.$frame.append(this.$el);this.$modal.slideDown('fast');return this;},closeModal:function(){var view=this;this.$modal.slideUp('fast',function(){view.remove();});return this;}});var VideoPressModal=new VideoPressModalView();$(document).on('ready',function(){var $form=$('#videopress-settings');if(!$form.length){return;}
var $access=$form.find('input[name="videopress-access"]'),$upload=$form.find('input[name="videopress-upload"]');$access.on('change',function(){var access=$access.filter(':checked').val();$upload.attr('disabled',!access);if(!access){$upload.attr('checked',false);}});$access.trigger('change');});$(document).on('click','#videopress-browse',function(){wp.media({state:'videopress',states:[new media.controller.VideoPress()],VideoPress:{hideToolbar:true}}).open();return false;});})(jQuery);

} /* end modules/videopress/videopress-admin.js */

if ( jpconcat.files['modules/widget-visibility/widget-conditions/widget-conditions.js'] ) {

jQuery(function($){var widgets_shell=$('div#widgets-right');if(!widgets_shell.length||!$(widgets_shell).find('.widget-control-actions').length){widgets_shell=$('form#customize-controls');}
function setWidgetMargin($widget){if($('body').hasClass('wp-customizer')){$widget.find('.widget-inside').css('top',0);return;}
if($widget.hasClass('expanded')){if($widget.attr('style')){$widget.data('original-style',$widget.attr('style'));}
var currentWidth=$widget.width();if(currentWidth<400){var extra=400-currentWidth;if(isRtl){$widget.css('position','relative').css('right','-'+extra+'px').css('width','400px');}else{$widget.css('position','relative').css('left','-'+extra+'px').css('width','400px');}}}
else if($widget.data('original-style')){$widget.attr('style',$widget.data('original-style')).data('original-style',null);}
else{$widget.removeAttr('style');}}
$('a.display-options').each(function(){var $displayOptionsButton=$(this),$widget=$displayOptionsButton.closest('div.widget');$displayOptionsButton.insertBefore($widget.find('input.widget-control-save'));$displayOptionsButton.parent().removeClass('widget-control-noform').find('.spinner').remove().css('float','left').prependTo($displayOptionsButton.parent());});widgets_shell.on('click.widgetconditions','a.add-condition',function(e){e.preventDefault();var $condition=$(this).closest('div.condition'),$conditionClone=$condition.clone().insertAfter($condition);$conditionClone.find('select.conditions-rule-major').val('');$conditionClone.find('select.conditions-rule-minor').html('').attr('disabled');});widgets_shell.on('click.widgetconditions','a.display-options',function(e){e.preventDefault();var $displayOptionsButton=$(this),$widget=$displayOptionsButton.closest('div.widget');$widget.find('div.widget-conditional').toggleClass('widget-conditional-hide');$(this).toggleClass('active');$widget.toggleClass('expanded');setWidgetMargin($widget);if($(this).hasClass('active')){$widget.find('input[name=widget-conditions-visible]').val('1');}else{$widget.find('input[name=widget-conditions-visible]').val('0');}});widgets_shell.on('click.widgetconditions','a.delete-condition',function(e){e.preventDefault();var $condition=$(this).closest('div.condition');if($condition.is(':first-child')&&$condition.is(':last-child')){$(this).closest('div.widget').find('a.display-options').click();$condition.find('select.conditions-rule-major').val('').change();}else{$condition.detach();}});widgets_shell.on('click.widgetconditions','div.widget-top',function(){var $widget=$(this).closest('div.widget'),$displayOptionsButton=$widget.find('a.display-options');if($displayOptionsButton.hasClass('active')){$displayOptionsButton.attr('opened','true');}
if($displayOptionsButton.attr('opened')){$displayOptionsButton.removeAttr('opened');$widget.toggleClass('expanded');setWidgetMargin($widget);}});$(document).on('change.widgetconditions','select.conditions-rule-major',function(){var $conditionsRuleMajor=$(this);var $conditionsRuleMinor=$conditionsRuleMajor.siblings('select.conditions-rule-minor:first');if($conditionsRuleMajor.val()){$conditionsRuleMinor.html('').append($('<option/>').text($conditionsRuleMinor.data('loading-text')));var data={action:'widget_conditions_options',major:$conditionsRuleMajor.val()};jQuery.post(ajaxurl,data,function(html){$conditionsRuleMinor.html(html).removeAttr('disabled');});}else{$conditionsRuleMajor.siblings('select.conditions-rule-minor').attr('disabled','disabled').html('');}});});

} /* end modules/widget-visibility/widget-conditions/widget-conditions.js */

if ( jpconcat.files['modules/widgets/gallery/js/admin.js'] ) {

(function($){var $ids;var $thumbs;$(function(){$('.widgets-holder-wrap, .editwidget').on('click','.gallery-widget-choose-images',function(event){event.preventDefault();var widget_form=$(this).closest('form');$ids=widget_form.find('.gallery-widget-ids');$thumbs=widget_form.find('.gallery-widget-thumbs');var idsString=$ids.val();var attachments=getAttachments(idsString);var selection=null;var editing=false;if(attachments){selection=getSelection(attachments);editing=true;}
var options={state:'gallery-edit',title:wp.media.view.l10n.addMedia,multiple:true,editing:editing,selection:selection};var workflow=getWorkflow(options);workflow.open();});$('.widget-inside').on('change','.gallery-widget-style',setupStyleOptions);setupStyleOptions();});var media=wp.media,l10n;l10n=media.view.l10n=typeof _wpMediaViewsL10n==='undefined'?{}:_wpMediaViewsL10n;media.view.MediaFrame.GalleryWidget=media.view.MediaFrame.Post.extend({createStates:function(){var options=this.options;if('CollectionEdit'in media.controller){this.states.add([new media.controller.CollectionEdit({type:'image',collectionType:'gallery',title:l10n.editGalleryTitle,SettingsView:media.view.Settings.Gallery,library:options.selection,editing:options.editing,menu:'gallery'}),new media.controller.CollectionAdd({type:'image',collectionType:'gallery',title:l10n.addToGalleryTitle})]);}else{if(!('WidgetGalleryEdit'in media.controller)){media.controller.WidgetGalleryEdit=media.controller.GalleryEdit.extend({gallerySettings:function(){return;}});}
this.states.add([new media.controller.WidgetGalleryEdit({library:options.selection,editing:options.editing,menu:'gallery'}),new media.controller.GalleryAdd({})]);}}});function setupStyleOptions(){$('.widget-inside .gallery-widget-style').each(function(){var style=$(this).val();var form=$(this).parents('form');switch(style){case'slideshow':form.find('.gallery-widget-link-wrapper').hide();form.find('.gallery-widget-columns-wrapper').hide();break;default:form.find('.gallery-widget-link-wrapper').show();form.find('.gallery-widget-columns-wrapper').show();}});}
function setupThumbs(selection,wrapper){wrapper.empty();var imageSize=_wpGalleryWidgetAdminSettings.thumbSize;selection.each(function(model){var sizedUrl=model.get('url')+'?w='+imageSize+'&h='+imageSize+'&crop=true';var thumb='<img src="'+sizedUrl+'" alt="'+model.get('title')+'"     title="'+model.get('title')+'" width="'+imageSize+'" height="'+imageSize+'" class="thumb" />';wrapper.append(thumb);});}
function getAttachments(idsString){if(!idsString){return null;}
var shortcode=wp.shortcode.next('gallery','[gallery ids="'+idsString+'"]');shortcode=shortcode.shortcode;var attachments=wp.media.gallery.attachments(shortcode);return attachments;}
function getSelection(attachments){var selection=new wp.media.model.Selection(attachments.models,{props:attachments.props.toJSON(),multiple:true});selection.gallery=attachments.gallery;selection.more().done(function(){selection.props.set({query:false});selection.unmirror();selection.props.unset('orderby');});return selection;}
function getWorkflow(options){var workflow=new wp.media.view.MediaFrame.GalleryWidget(options);workflow.on('update',function(selection){var state=workflow.state();selection=selection||state.get('selection');if(!selection){return;}
var ids=selection.map(function(model){return model.get('id');});var id_string=ids.join(',');$ids.val(id_string);setupThumbs(selection,$thumbs);},this);workflow.setState(workflow.options.state);return workflow;}})(jQuery);

} /* end modules/widgets/gallery/js/admin.js */

if ( jpconcat.files['modules/widgets/gallery/js/gallery.js'] ) {

(function($){$(function(){$('.widget-gallery .no-carousel .tiled-gallery-item a').on('click',function(event){event.stopPropagation();return true;});});})(jQuery);

} /* end modules/widgets/gallery/js/gallery.js */

if ( jpconcat.files['modules/wpgroho.js'] ) {

WPGroHo=jQuery.extend({my_hash:'',data:{},renderers:{},syncProfileData:function(hash,id){if(!WPGroHo.data[hash]){WPGroHo.data[hash]={};jQuery('div.grofile-hash-map-'+hash+' span').each(function(){WPGroHo.data[hash][this.className]=jQuery(this).text();});}
WPGroHo.appendProfileData(WPGroHo.data[hash],hash,id);},appendProfileData:function(data,hash,id){for(var key in data){if(jQuery.isFunction(WPGroHo.renderers[key])){return WPGroHo.renderers[key](data[key],hash,id,key);}
jQuery('#'+id).find('h4').after(jQuery('<p class="grav-extra '+key+'" />').html(data[key]));}}},WPGroHo);jQuery(document).ready(function(){Gravatar.profile_cb=function(h,d){WPGroHo.syncProfileData(h,d);};Gravatar.my_hash=WPGroHo.my_hash;Gravatar.init('body','#wpadminbar');});

} /* end modules/wpgroho.js */
