function JetpackSlideshow(a,b,c,d){this.element=a,this.images=[],this.controls={},this.transition=d||"fade";var e=this.element.width();(!b||b>e)&&(b=e),this.width=b,this.height=c,this.element.css({height:this.height+"px"})}JetpackSlideshow.prototype.showLoadingImage=function(a){if(a){this.loadingImage_=document.createElement("div"),this.loadingImage_.className="slideshow-loading";var b=document.createElement("img");b.src=jetpackSlideshowSettings.spinner,this.loadingImage_.appendChild(b),this.loadingImage_.appendChild(this.makeZeroWidthSpan()),this.loadingImage_.style.lineHeight=this.height+"px",this.element.append(this.loadingImage_)}else this.loadingImage_&&(this.loadingImage_.parentNode.removeChild(this.loadingImage_),this.loadingImage_=null)},JetpackSlideshow.prototype.init=function(){this.showLoadingImage(!0);for(var a=this,b=0;b<this.images.length;b++){var c=this.images[b],d=document.createElement("img");d.src=c.src+"?w="+this.width,d.align="middle";var e=document.createElement("div");e.className="slideshow-slide-caption",e.innerHTML=c.caption;var f=document.createElement("div");f.className="slideshow-slide",f.style.lineHeight=this.height+"px",0==b&&(d.complete?setTimeout(function(){a.finishInit_()},1):jQuery(d).load(function(){a.finishInit_()})),f.appendChild(d),d.removeAttribute("width"),d.removeAttribute("height"),f.appendChild(this.makeZeroWidthSpan()),f.appendChild(e),this.element.append(f)}},JetpackSlideshow.prototype.makeZeroWidthSpan=function(){var a=document.createElement("span");return a.className="slideshow-line-height-hack",jQuery.browser.msie?a.appendChild(document.createTextNode(" ")):a.innerHTML="&nbsp;",a},JetpackSlideshow.prototype.finishInit_=function(){this.showLoadingImage(!1),this.renderControls_();var a=this;this.element.cycle({fx:this.transition,prev:this.controls.prev,next:this.controls.next,slideExpr:".slideshow-slide",onPrevNextEvent:function(){return a.onCyclePrevNextClick_.apply(a,arguments)}});var b=this.element;jQuery(this.controls.stop).click(function(){var a=jQuery(this);return a.hasClass("paused")?(a.addClass("running"),a.removeClass("paused"),b.cycle("resume",!0)):(b.cycle("pause"),a.removeClass("running"),a.addClass("paused")),!1});var c=jQuery(this.controlsDiv_);b.mouseenter(function(){c.fadeIn()}),b.mouseleave(function(){c.fadeOut()}),this.initialized_=!0},JetpackSlideshow.prototype.renderControls_=function(){if(!this.controlsDiv_){var a=document.createElement("div");a.className="slideshow-controls",controls=["prev","stop","next"];for(var b=0;b<controls.length;b++){var c=controls[b],d=document.createElement("a");d.href="#",a.appendChild(d),this.controls[c]=d}this.element.append(a),this.controlsDiv_=a}},JetpackSlideshow.prototype.onCyclePrevNextClick_=function(a,b){if(jetpackSlideshowSettings.blog_id){var c=this.images[b].id,d=new Image;d.src=document.location.protocol+"//stats.wordpress.com/g.gif?host="+escape(document.location.host)+"&rand="+Math.random()+"&blog="+jetpackSlideshowSettings.blog_id+"&subd="+jetpackSlideshowSettings.blog_subdomain+"&user_id="+jetpackSlideshowSettings.user_id+"&post="+c+"&ref="+escape(document.location)}},function(a){function b(){a(".jetpack-slideshow-noscript").remove(),a(".jetpack-slideshow").each(function(){var b=a(this);if(!b.data("processed")){var c=new JetpackSlideshow(b,b.data("width"),b.data("height"),b.data("trans"));c.images=b.data("gallery"),c.init(),b.data("processed",!0)}})}a(document).ready(b),a("body").on("post-load",b)}(jQuery);